{"ast":null,"code":"'use strict';\n\nvar _classCallCheck = require(\"D:/web/silly/silly/node_modules/@babel/runtime/helpers/classCallCheck.js\").default;\n\nvar _createClass = require(\"D:/web/silly/silly/node_modules/@babel/runtime/helpers/createClass.js\").default;\n\nvar _defineProperty = require(\"D:/web/silly/silly/node_modules/@babel/runtime/helpers/defineProperty.js\").default;\n\nvar _INSERTION_MODE_RESET, _TEMPLATE_INSERTION_M, _INITIAL_MODE, _BEFORE_HTML_MODE, _BEFORE_HEAD_MODE, _IN_HEAD_MODE, _IN_HEAD_NO_SCRIPT_MO, _AFTER_HEAD_MODE, _IN_BODY_MODE, _TEXT_MODE, _IN_TABLE_MODE, _IN_TABLE_TEXT_MODE, _IN_CAPTION_MODE, _IN_COLUMN_GROUP_MODE, _IN_TABLE_BODY_MODE, _IN_ROW_MODE, _IN_CELL_MODE, _IN_SELECT_MODE, _IN_SELECT_IN_TABLE_M, _IN_TEMPLATE_MODE, _AFTER_BODY_MODE, _IN_FRAMESET_MODE, _AFTER_FRAMESET_MODE, _AFTER_AFTER_BODY_MOD, _AFTER_AFTER_FRAMESET, _TOKEN_HANDLERS;\n\nvar Tokenizer = require('../tokenizer');\n\nvar OpenElementStack = require('./open-element-stack');\n\nvar FormattingElementList = require('./formatting-element-list');\n\nvar LocationInfoParserMixin = require('../extensions/location-info/parser-mixin');\n\nvar ErrorReportingParserMixin = require('../extensions/error-reporting/parser-mixin');\n\nvar Mixin = require('../utils/mixin');\n\nvar defaultTreeAdapter = require('../tree-adapters/default');\n\nvar mergeOptions = require('../utils/merge-options');\n\nvar doctype = require('../common/doctype');\n\nvar foreignContent = require('../common/foreign-content');\n\nvar ERR = require('../common/error-codes');\n\nvar unicode = require('../common/unicode');\n\nvar HTML = require('../common/html'); //Aliases\n\n\nvar $ = HTML.TAG_NAMES;\nvar NS = HTML.NAMESPACES;\nvar ATTRS = HTML.ATTRS;\nvar DEFAULT_OPTIONS = {\n  scriptingEnabled: true,\n  sourceCodeLocationInfo: false,\n  onParseError: null,\n  treeAdapter: defaultTreeAdapter\n}; //Misc constants\n\nvar HIDDEN_INPUT_TYPE = 'hidden'; //Adoption agency loops iteration count\n\nvar AA_OUTER_LOOP_ITER = 8;\nvar AA_INNER_LOOP_ITER = 3; //Insertion modes\n\nvar INITIAL_MODE = 'INITIAL_MODE';\nvar BEFORE_HTML_MODE = 'BEFORE_HTML_MODE';\nvar BEFORE_HEAD_MODE = 'BEFORE_HEAD_MODE';\nvar IN_HEAD_MODE = 'IN_HEAD_MODE';\nvar IN_HEAD_NO_SCRIPT_MODE = 'IN_HEAD_NO_SCRIPT_MODE';\nvar AFTER_HEAD_MODE = 'AFTER_HEAD_MODE';\nvar IN_BODY_MODE = 'IN_BODY_MODE';\nvar TEXT_MODE = 'TEXT_MODE';\nvar IN_TABLE_MODE = 'IN_TABLE_MODE';\nvar IN_TABLE_TEXT_MODE = 'IN_TABLE_TEXT_MODE';\nvar IN_CAPTION_MODE = 'IN_CAPTION_MODE';\nvar IN_COLUMN_GROUP_MODE = 'IN_COLUMN_GROUP_MODE';\nvar IN_TABLE_BODY_MODE = 'IN_TABLE_BODY_MODE';\nvar IN_ROW_MODE = 'IN_ROW_MODE';\nvar IN_CELL_MODE = 'IN_CELL_MODE';\nvar IN_SELECT_MODE = 'IN_SELECT_MODE';\nvar IN_SELECT_IN_TABLE_MODE = 'IN_SELECT_IN_TABLE_MODE';\nvar IN_TEMPLATE_MODE = 'IN_TEMPLATE_MODE';\nvar AFTER_BODY_MODE = 'AFTER_BODY_MODE';\nvar IN_FRAMESET_MODE = 'IN_FRAMESET_MODE';\nvar AFTER_FRAMESET_MODE = 'AFTER_FRAMESET_MODE';\nvar AFTER_AFTER_BODY_MODE = 'AFTER_AFTER_BODY_MODE';\nvar AFTER_AFTER_FRAMESET_MODE = 'AFTER_AFTER_FRAMESET_MODE'; //Insertion mode reset map\n\nvar INSERTION_MODE_RESET_MAP = (_INSERTION_MODE_RESET = {}, _defineProperty(_INSERTION_MODE_RESET, $.TR, IN_ROW_MODE), _defineProperty(_INSERTION_MODE_RESET, $.TBODY, IN_TABLE_BODY_MODE), _defineProperty(_INSERTION_MODE_RESET, $.THEAD, IN_TABLE_BODY_MODE), _defineProperty(_INSERTION_MODE_RESET, $.TFOOT, IN_TABLE_BODY_MODE), _defineProperty(_INSERTION_MODE_RESET, $.CAPTION, IN_CAPTION_MODE), _defineProperty(_INSERTION_MODE_RESET, $.COLGROUP, IN_COLUMN_GROUP_MODE), _defineProperty(_INSERTION_MODE_RESET, $.TABLE, IN_TABLE_MODE), _defineProperty(_INSERTION_MODE_RESET, $.BODY, IN_BODY_MODE), _defineProperty(_INSERTION_MODE_RESET, $.FRAMESET, IN_FRAMESET_MODE), _INSERTION_MODE_RESET); //Template insertion mode switch map\n\nvar TEMPLATE_INSERTION_MODE_SWITCH_MAP = (_TEMPLATE_INSERTION_M = {}, _defineProperty(_TEMPLATE_INSERTION_M, $.CAPTION, IN_TABLE_MODE), _defineProperty(_TEMPLATE_INSERTION_M, $.COLGROUP, IN_TABLE_MODE), _defineProperty(_TEMPLATE_INSERTION_M, $.TBODY, IN_TABLE_MODE), _defineProperty(_TEMPLATE_INSERTION_M, $.TFOOT, IN_TABLE_MODE), _defineProperty(_TEMPLATE_INSERTION_M, $.THEAD, IN_TABLE_MODE), _defineProperty(_TEMPLATE_INSERTION_M, $.COL, IN_COLUMN_GROUP_MODE), _defineProperty(_TEMPLATE_INSERTION_M, $.TR, IN_TABLE_BODY_MODE), _defineProperty(_TEMPLATE_INSERTION_M, $.TD, IN_ROW_MODE), _defineProperty(_TEMPLATE_INSERTION_M, $.TH, IN_ROW_MODE), _TEMPLATE_INSERTION_M); //Token handlers map for insertion modes\n\nvar TOKEN_HANDLERS = (_TOKEN_HANDLERS = {}, _defineProperty(_TOKEN_HANDLERS, INITIAL_MODE, (_INITIAL_MODE = {}, _defineProperty(_INITIAL_MODE, Tokenizer.CHARACTER_TOKEN, tokenInInitialMode), _defineProperty(_INITIAL_MODE, Tokenizer.NULL_CHARACTER_TOKEN, tokenInInitialMode), _defineProperty(_INITIAL_MODE, Tokenizer.WHITESPACE_CHARACTER_TOKEN, ignoreToken), _defineProperty(_INITIAL_MODE, Tokenizer.COMMENT_TOKEN, appendComment), _defineProperty(_INITIAL_MODE, Tokenizer.DOCTYPE_TOKEN, doctypeInInitialMode), _defineProperty(_INITIAL_MODE, Tokenizer.START_TAG_TOKEN, tokenInInitialMode), _defineProperty(_INITIAL_MODE, Tokenizer.END_TAG_TOKEN, tokenInInitialMode), _defineProperty(_INITIAL_MODE, Tokenizer.EOF_TOKEN, tokenInInitialMode), _INITIAL_MODE)), _defineProperty(_TOKEN_HANDLERS, BEFORE_HTML_MODE, (_BEFORE_HTML_MODE = {}, _defineProperty(_BEFORE_HTML_MODE, Tokenizer.CHARACTER_TOKEN, tokenBeforeHtml), _defineProperty(_BEFORE_HTML_MODE, Tokenizer.NULL_CHARACTER_TOKEN, tokenBeforeHtml), _defineProperty(_BEFORE_HTML_MODE, Tokenizer.WHITESPACE_CHARACTER_TOKEN, ignoreToken), _defineProperty(_BEFORE_HTML_MODE, Tokenizer.COMMENT_TOKEN, appendComment), _defineProperty(_BEFORE_HTML_MODE, Tokenizer.DOCTYPE_TOKEN, ignoreToken), _defineProperty(_BEFORE_HTML_MODE, Tokenizer.START_TAG_TOKEN, startTagBeforeHtml), _defineProperty(_BEFORE_HTML_MODE, Tokenizer.END_TAG_TOKEN, endTagBeforeHtml), _defineProperty(_BEFORE_HTML_MODE, Tokenizer.EOF_TOKEN, tokenBeforeHtml), _BEFORE_HTML_MODE)), _defineProperty(_TOKEN_HANDLERS, BEFORE_HEAD_MODE, (_BEFORE_HEAD_MODE = {}, _defineProperty(_BEFORE_HEAD_MODE, Tokenizer.CHARACTER_TOKEN, tokenBeforeHead), _defineProperty(_BEFORE_HEAD_MODE, Tokenizer.NULL_CHARACTER_TOKEN, tokenBeforeHead), _defineProperty(_BEFORE_HEAD_MODE, Tokenizer.WHITESPACE_CHARACTER_TOKEN, ignoreToken), _defineProperty(_BEFORE_HEAD_MODE, Tokenizer.COMMENT_TOKEN, appendComment), _defineProperty(_BEFORE_HEAD_MODE, Tokenizer.DOCTYPE_TOKEN, misplacedDoctype), _defineProperty(_BEFORE_HEAD_MODE, Tokenizer.START_TAG_TOKEN, startTagBeforeHead), _defineProperty(_BEFORE_HEAD_MODE, Tokenizer.END_TAG_TOKEN, endTagBeforeHead), _defineProperty(_BEFORE_HEAD_MODE, Tokenizer.EOF_TOKEN, tokenBeforeHead), _BEFORE_HEAD_MODE)), _defineProperty(_TOKEN_HANDLERS, IN_HEAD_MODE, (_IN_HEAD_MODE = {}, _defineProperty(_IN_HEAD_MODE, Tokenizer.CHARACTER_TOKEN, tokenInHead), _defineProperty(_IN_HEAD_MODE, Tokenizer.NULL_CHARACTER_TOKEN, tokenInHead), _defineProperty(_IN_HEAD_MODE, Tokenizer.WHITESPACE_CHARACTER_TOKEN, insertCharacters), _defineProperty(_IN_HEAD_MODE, Tokenizer.COMMENT_TOKEN, appendComment), _defineProperty(_IN_HEAD_MODE, Tokenizer.DOCTYPE_TOKEN, misplacedDoctype), _defineProperty(_IN_HEAD_MODE, Tokenizer.START_TAG_TOKEN, startTagInHead), _defineProperty(_IN_HEAD_MODE, Tokenizer.END_TAG_TOKEN, endTagInHead), _defineProperty(_IN_HEAD_MODE, Tokenizer.EOF_TOKEN, tokenInHead), _IN_HEAD_MODE)), _defineProperty(_TOKEN_HANDLERS, IN_HEAD_NO_SCRIPT_MODE, (_IN_HEAD_NO_SCRIPT_MO = {}, _defineProperty(_IN_HEAD_NO_SCRIPT_MO, Tokenizer.CHARACTER_TOKEN, tokenInHeadNoScript), _defineProperty(_IN_HEAD_NO_SCRIPT_MO, Tokenizer.NULL_CHARACTER_TOKEN, tokenInHeadNoScript), _defineProperty(_IN_HEAD_NO_SCRIPT_MO, Tokenizer.WHITESPACE_CHARACTER_TOKEN, insertCharacters), _defineProperty(_IN_HEAD_NO_SCRIPT_MO, Tokenizer.COMMENT_TOKEN, appendComment), _defineProperty(_IN_HEAD_NO_SCRIPT_MO, Tokenizer.DOCTYPE_TOKEN, misplacedDoctype), _defineProperty(_IN_HEAD_NO_SCRIPT_MO, Tokenizer.START_TAG_TOKEN, startTagInHeadNoScript), _defineProperty(_IN_HEAD_NO_SCRIPT_MO, Tokenizer.END_TAG_TOKEN, endTagInHeadNoScript), _defineProperty(_IN_HEAD_NO_SCRIPT_MO, Tokenizer.EOF_TOKEN, tokenInHeadNoScript), _IN_HEAD_NO_SCRIPT_MO)), _defineProperty(_TOKEN_HANDLERS, AFTER_HEAD_MODE, (_AFTER_HEAD_MODE = {}, _defineProperty(_AFTER_HEAD_MODE, Tokenizer.CHARACTER_TOKEN, tokenAfterHead), _defineProperty(_AFTER_HEAD_MODE, Tokenizer.NULL_CHARACTER_TOKEN, tokenAfterHead), _defineProperty(_AFTER_HEAD_MODE, Tokenizer.WHITESPACE_CHARACTER_TOKEN, insertCharacters), _defineProperty(_AFTER_HEAD_MODE, Tokenizer.COMMENT_TOKEN, appendComment), _defineProperty(_AFTER_HEAD_MODE, Tokenizer.DOCTYPE_TOKEN, misplacedDoctype), _defineProperty(_AFTER_HEAD_MODE, Tokenizer.START_TAG_TOKEN, startTagAfterHead), _defineProperty(_AFTER_HEAD_MODE, Tokenizer.END_TAG_TOKEN, endTagAfterHead), _defineProperty(_AFTER_HEAD_MODE, Tokenizer.EOF_TOKEN, tokenAfterHead), _AFTER_HEAD_MODE)), _defineProperty(_TOKEN_HANDLERS, IN_BODY_MODE, (_IN_BODY_MODE = {}, _defineProperty(_IN_BODY_MODE, Tokenizer.CHARACTER_TOKEN, characterInBody), _defineProperty(_IN_BODY_MODE, Tokenizer.NULL_CHARACTER_TOKEN, ignoreToken), _defineProperty(_IN_BODY_MODE, Tokenizer.WHITESPACE_CHARACTER_TOKEN, whitespaceCharacterInBody), _defineProperty(_IN_BODY_MODE, Tokenizer.COMMENT_TOKEN, appendComment), _defineProperty(_IN_BODY_MODE, Tokenizer.DOCTYPE_TOKEN, ignoreToken), _defineProperty(_IN_BODY_MODE, Tokenizer.START_TAG_TOKEN, startTagInBody), _defineProperty(_IN_BODY_MODE, Tokenizer.END_TAG_TOKEN, endTagInBody), _defineProperty(_IN_BODY_MODE, Tokenizer.EOF_TOKEN, eofInBody), _IN_BODY_MODE)), _defineProperty(_TOKEN_HANDLERS, TEXT_MODE, (_TEXT_MODE = {}, _defineProperty(_TEXT_MODE, Tokenizer.CHARACTER_TOKEN, insertCharacters), _defineProperty(_TEXT_MODE, Tokenizer.NULL_CHARACTER_TOKEN, insertCharacters), _defineProperty(_TEXT_MODE, Tokenizer.WHITESPACE_CHARACTER_TOKEN, insertCharacters), _defineProperty(_TEXT_MODE, Tokenizer.COMMENT_TOKEN, ignoreToken), _defineProperty(_TEXT_MODE, Tokenizer.DOCTYPE_TOKEN, ignoreToken), _defineProperty(_TEXT_MODE, Tokenizer.START_TAG_TOKEN, ignoreToken), _defineProperty(_TEXT_MODE, Tokenizer.END_TAG_TOKEN, endTagInText), _defineProperty(_TEXT_MODE, Tokenizer.EOF_TOKEN, eofInText), _TEXT_MODE)), _defineProperty(_TOKEN_HANDLERS, IN_TABLE_MODE, (_IN_TABLE_MODE = {}, _defineProperty(_IN_TABLE_MODE, Tokenizer.CHARACTER_TOKEN, characterInTable), _defineProperty(_IN_TABLE_MODE, Tokenizer.NULL_CHARACTER_TOKEN, characterInTable), _defineProperty(_IN_TABLE_MODE, Tokenizer.WHITESPACE_CHARACTER_TOKEN, characterInTable), _defineProperty(_IN_TABLE_MODE, Tokenizer.COMMENT_TOKEN, appendComment), _defineProperty(_IN_TABLE_MODE, Tokenizer.DOCTYPE_TOKEN, ignoreToken), _defineProperty(_IN_TABLE_MODE, Tokenizer.START_TAG_TOKEN, startTagInTable), _defineProperty(_IN_TABLE_MODE, Tokenizer.END_TAG_TOKEN, endTagInTable), _defineProperty(_IN_TABLE_MODE, Tokenizer.EOF_TOKEN, eofInBody), _IN_TABLE_MODE)), _defineProperty(_TOKEN_HANDLERS, IN_TABLE_TEXT_MODE, (_IN_TABLE_TEXT_MODE = {}, _defineProperty(_IN_TABLE_TEXT_MODE, Tokenizer.CHARACTER_TOKEN, characterInTableText), _defineProperty(_IN_TABLE_TEXT_MODE, Tokenizer.NULL_CHARACTER_TOKEN, ignoreToken), _defineProperty(_IN_TABLE_TEXT_MODE, Tokenizer.WHITESPACE_CHARACTER_TOKEN, whitespaceCharacterInTableText), _defineProperty(_IN_TABLE_TEXT_MODE, Tokenizer.COMMENT_TOKEN, tokenInTableText), _defineProperty(_IN_TABLE_TEXT_MODE, Tokenizer.DOCTYPE_TOKEN, tokenInTableText), _defineProperty(_IN_TABLE_TEXT_MODE, Tokenizer.START_TAG_TOKEN, tokenInTableText), _defineProperty(_IN_TABLE_TEXT_MODE, Tokenizer.END_TAG_TOKEN, tokenInTableText), _defineProperty(_IN_TABLE_TEXT_MODE, Tokenizer.EOF_TOKEN, tokenInTableText), _IN_TABLE_TEXT_MODE)), _defineProperty(_TOKEN_HANDLERS, IN_CAPTION_MODE, (_IN_CAPTION_MODE = {}, _defineProperty(_IN_CAPTION_MODE, Tokenizer.CHARACTER_TOKEN, characterInBody), _defineProperty(_IN_CAPTION_MODE, Tokenizer.NULL_CHARACTER_TOKEN, ignoreToken), _defineProperty(_IN_CAPTION_MODE, Tokenizer.WHITESPACE_CHARACTER_TOKEN, whitespaceCharacterInBody), _defineProperty(_IN_CAPTION_MODE, Tokenizer.COMMENT_TOKEN, appendComment), _defineProperty(_IN_CAPTION_MODE, Tokenizer.DOCTYPE_TOKEN, ignoreToken), _defineProperty(_IN_CAPTION_MODE, Tokenizer.START_TAG_TOKEN, startTagInCaption), _defineProperty(_IN_CAPTION_MODE, Tokenizer.END_TAG_TOKEN, endTagInCaption), _defineProperty(_IN_CAPTION_MODE, Tokenizer.EOF_TOKEN, eofInBody), _IN_CAPTION_MODE)), _defineProperty(_TOKEN_HANDLERS, IN_COLUMN_GROUP_MODE, (_IN_COLUMN_GROUP_MODE = {}, _defineProperty(_IN_COLUMN_GROUP_MODE, Tokenizer.CHARACTER_TOKEN, tokenInColumnGroup), _defineProperty(_IN_COLUMN_GROUP_MODE, Tokenizer.NULL_CHARACTER_TOKEN, tokenInColumnGroup), _defineProperty(_IN_COLUMN_GROUP_MODE, Tokenizer.WHITESPACE_CHARACTER_TOKEN, insertCharacters), _defineProperty(_IN_COLUMN_GROUP_MODE, Tokenizer.COMMENT_TOKEN, appendComment), _defineProperty(_IN_COLUMN_GROUP_MODE, Tokenizer.DOCTYPE_TOKEN, ignoreToken), _defineProperty(_IN_COLUMN_GROUP_MODE, Tokenizer.START_TAG_TOKEN, startTagInColumnGroup), _defineProperty(_IN_COLUMN_GROUP_MODE, Tokenizer.END_TAG_TOKEN, endTagInColumnGroup), _defineProperty(_IN_COLUMN_GROUP_MODE, Tokenizer.EOF_TOKEN, eofInBody), _IN_COLUMN_GROUP_MODE)), _defineProperty(_TOKEN_HANDLERS, IN_TABLE_BODY_MODE, (_IN_TABLE_BODY_MODE = {}, _defineProperty(_IN_TABLE_BODY_MODE, Tokenizer.CHARACTER_TOKEN, characterInTable), _defineProperty(_IN_TABLE_BODY_MODE, Tokenizer.NULL_CHARACTER_TOKEN, characterInTable), _defineProperty(_IN_TABLE_BODY_MODE, Tokenizer.WHITESPACE_CHARACTER_TOKEN, characterInTable), _defineProperty(_IN_TABLE_BODY_MODE, Tokenizer.COMMENT_TOKEN, appendComment), _defineProperty(_IN_TABLE_BODY_MODE, Tokenizer.DOCTYPE_TOKEN, ignoreToken), _defineProperty(_IN_TABLE_BODY_MODE, Tokenizer.START_TAG_TOKEN, startTagInTableBody), _defineProperty(_IN_TABLE_BODY_MODE, Tokenizer.END_TAG_TOKEN, endTagInTableBody), _defineProperty(_IN_TABLE_BODY_MODE, Tokenizer.EOF_TOKEN, eofInBody), _IN_TABLE_BODY_MODE)), _defineProperty(_TOKEN_HANDLERS, IN_ROW_MODE, (_IN_ROW_MODE = {}, _defineProperty(_IN_ROW_MODE, Tokenizer.CHARACTER_TOKEN, characterInTable), _defineProperty(_IN_ROW_MODE, Tokenizer.NULL_CHARACTER_TOKEN, characterInTable), _defineProperty(_IN_ROW_MODE, Tokenizer.WHITESPACE_CHARACTER_TOKEN, characterInTable), _defineProperty(_IN_ROW_MODE, Tokenizer.COMMENT_TOKEN, appendComment), _defineProperty(_IN_ROW_MODE, Tokenizer.DOCTYPE_TOKEN, ignoreToken), _defineProperty(_IN_ROW_MODE, Tokenizer.START_TAG_TOKEN, startTagInRow), _defineProperty(_IN_ROW_MODE, Tokenizer.END_TAG_TOKEN, endTagInRow), _defineProperty(_IN_ROW_MODE, Tokenizer.EOF_TOKEN, eofInBody), _IN_ROW_MODE)), _defineProperty(_TOKEN_HANDLERS, IN_CELL_MODE, (_IN_CELL_MODE = {}, _defineProperty(_IN_CELL_MODE, Tokenizer.CHARACTER_TOKEN, characterInBody), _defineProperty(_IN_CELL_MODE, Tokenizer.NULL_CHARACTER_TOKEN, ignoreToken), _defineProperty(_IN_CELL_MODE, Tokenizer.WHITESPACE_CHARACTER_TOKEN, whitespaceCharacterInBody), _defineProperty(_IN_CELL_MODE, Tokenizer.COMMENT_TOKEN, appendComment), _defineProperty(_IN_CELL_MODE, Tokenizer.DOCTYPE_TOKEN, ignoreToken), _defineProperty(_IN_CELL_MODE, Tokenizer.START_TAG_TOKEN, startTagInCell), _defineProperty(_IN_CELL_MODE, Tokenizer.END_TAG_TOKEN, endTagInCell), _defineProperty(_IN_CELL_MODE, Tokenizer.EOF_TOKEN, eofInBody), _IN_CELL_MODE)), _defineProperty(_TOKEN_HANDLERS, IN_SELECT_MODE, (_IN_SELECT_MODE = {}, _defineProperty(_IN_SELECT_MODE, Tokenizer.CHARACTER_TOKEN, insertCharacters), _defineProperty(_IN_SELECT_MODE, Tokenizer.NULL_CHARACTER_TOKEN, ignoreToken), _defineProperty(_IN_SELECT_MODE, Tokenizer.WHITESPACE_CHARACTER_TOKEN, insertCharacters), _defineProperty(_IN_SELECT_MODE, Tokenizer.COMMENT_TOKEN, appendComment), _defineProperty(_IN_SELECT_MODE, Tokenizer.DOCTYPE_TOKEN, ignoreToken), _defineProperty(_IN_SELECT_MODE, Tokenizer.START_TAG_TOKEN, startTagInSelect), _defineProperty(_IN_SELECT_MODE, Tokenizer.END_TAG_TOKEN, endTagInSelect), _defineProperty(_IN_SELECT_MODE, Tokenizer.EOF_TOKEN, eofInBody), _IN_SELECT_MODE)), _defineProperty(_TOKEN_HANDLERS, IN_SELECT_IN_TABLE_MODE, (_IN_SELECT_IN_TABLE_M = {}, _defineProperty(_IN_SELECT_IN_TABLE_M, Tokenizer.CHARACTER_TOKEN, insertCharacters), _defineProperty(_IN_SELECT_IN_TABLE_M, Tokenizer.NULL_CHARACTER_TOKEN, ignoreToken), _defineProperty(_IN_SELECT_IN_TABLE_M, Tokenizer.WHITESPACE_CHARACTER_TOKEN, insertCharacters), _defineProperty(_IN_SELECT_IN_TABLE_M, Tokenizer.COMMENT_TOKEN, appendComment), _defineProperty(_IN_SELECT_IN_TABLE_M, Tokenizer.DOCTYPE_TOKEN, ignoreToken), _defineProperty(_IN_SELECT_IN_TABLE_M, Tokenizer.START_TAG_TOKEN, startTagInSelectInTable), _defineProperty(_IN_SELECT_IN_TABLE_M, Tokenizer.END_TAG_TOKEN, endTagInSelectInTable), _defineProperty(_IN_SELECT_IN_TABLE_M, Tokenizer.EOF_TOKEN, eofInBody), _IN_SELECT_IN_TABLE_M)), _defineProperty(_TOKEN_HANDLERS, IN_TEMPLATE_MODE, (_IN_TEMPLATE_MODE = {}, _defineProperty(_IN_TEMPLATE_MODE, Tokenizer.CHARACTER_TOKEN, characterInBody), _defineProperty(_IN_TEMPLATE_MODE, Tokenizer.NULL_CHARACTER_TOKEN, ignoreToken), _defineProperty(_IN_TEMPLATE_MODE, Tokenizer.WHITESPACE_CHARACTER_TOKEN, whitespaceCharacterInBody), _defineProperty(_IN_TEMPLATE_MODE, Tokenizer.COMMENT_TOKEN, appendComment), _defineProperty(_IN_TEMPLATE_MODE, Tokenizer.DOCTYPE_TOKEN, ignoreToken), _defineProperty(_IN_TEMPLATE_MODE, Tokenizer.START_TAG_TOKEN, startTagInTemplate), _defineProperty(_IN_TEMPLATE_MODE, Tokenizer.END_TAG_TOKEN, endTagInTemplate), _defineProperty(_IN_TEMPLATE_MODE, Tokenizer.EOF_TOKEN, eofInTemplate), _IN_TEMPLATE_MODE)), _defineProperty(_TOKEN_HANDLERS, AFTER_BODY_MODE, (_AFTER_BODY_MODE = {}, _defineProperty(_AFTER_BODY_MODE, Tokenizer.CHARACTER_TOKEN, tokenAfterBody), _defineProperty(_AFTER_BODY_MODE, Tokenizer.NULL_CHARACTER_TOKEN, tokenAfterBody), _defineProperty(_AFTER_BODY_MODE, Tokenizer.WHITESPACE_CHARACTER_TOKEN, whitespaceCharacterInBody), _defineProperty(_AFTER_BODY_MODE, Tokenizer.COMMENT_TOKEN, appendCommentToRootHtmlElement), _defineProperty(_AFTER_BODY_MODE, Tokenizer.DOCTYPE_TOKEN, ignoreToken), _defineProperty(_AFTER_BODY_MODE, Tokenizer.START_TAG_TOKEN, startTagAfterBody), _defineProperty(_AFTER_BODY_MODE, Tokenizer.END_TAG_TOKEN, endTagAfterBody), _defineProperty(_AFTER_BODY_MODE, Tokenizer.EOF_TOKEN, stopParsing), _AFTER_BODY_MODE)), _defineProperty(_TOKEN_HANDLERS, IN_FRAMESET_MODE, (_IN_FRAMESET_MODE = {}, _defineProperty(_IN_FRAMESET_MODE, Tokenizer.CHARACTER_TOKEN, ignoreToken), _defineProperty(_IN_FRAMESET_MODE, Tokenizer.NULL_CHARACTER_TOKEN, ignoreToken), _defineProperty(_IN_FRAMESET_MODE, Tokenizer.WHITESPACE_CHARACTER_TOKEN, insertCharacters), _defineProperty(_IN_FRAMESET_MODE, Tokenizer.COMMENT_TOKEN, appendComment), _defineProperty(_IN_FRAMESET_MODE, Tokenizer.DOCTYPE_TOKEN, ignoreToken), _defineProperty(_IN_FRAMESET_MODE, Tokenizer.START_TAG_TOKEN, startTagInFrameset), _defineProperty(_IN_FRAMESET_MODE, Tokenizer.END_TAG_TOKEN, endTagInFrameset), _defineProperty(_IN_FRAMESET_MODE, Tokenizer.EOF_TOKEN, stopParsing), _IN_FRAMESET_MODE)), _defineProperty(_TOKEN_HANDLERS, AFTER_FRAMESET_MODE, (_AFTER_FRAMESET_MODE = {}, _defineProperty(_AFTER_FRAMESET_MODE, Tokenizer.CHARACTER_TOKEN, ignoreToken), _defineProperty(_AFTER_FRAMESET_MODE, Tokenizer.NULL_CHARACTER_TOKEN, ignoreToken), _defineProperty(_AFTER_FRAMESET_MODE, Tokenizer.WHITESPACE_CHARACTER_TOKEN, insertCharacters), _defineProperty(_AFTER_FRAMESET_MODE, Tokenizer.COMMENT_TOKEN, appendComment), _defineProperty(_AFTER_FRAMESET_MODE, Tokenizer.DOCTYPE_TOKEN, ignoreToken), _defineProperty(_AFTER_FRAMESET_MODE, Tokenizer.START_TAG_TOKEN, startTagAfterFrameset), _defineProperty(_AFTER_FRAMESET_MODE, Tokenizer.END_TAG_TOKEN, endTagAfterFrameset), _defineProperty(_AFTER_FRAMESET_MODE, Tokenizer.EOF_TOKEN, stopParsing), _AFTER_FRAMESET_MODE)), _defineProperty(_TOKEN_HANDLERS, AFTER_AFTER_BODY_MODE, (_AFTER_AFTER_BODY_MOD = {}, _defineProperty(_AFTER_AFTER_BODY_MOD, Tokenizer.CHARACTER_TOKEN, tokenAfterAfterBody), _defineProperty(_AFTER_AFTER_BODY_MOD, Tokenizer.NULL_CHARACTER_TOKEN, tokenAfterAfterBody), _defineProperty(_AFTER_AFTER_BODY_MOD, Tokenizer.WHITESPACE_CHARACTER_TOKEN, whitespaceCharacterInBody), _defineProperty(_AFTER_AFTER_BODY_MOD, Tokenizer.COMMENT_TOKEN, appendCommentToDocument), _defineProperty(_AFTER_AFTER_BODY_MOD, Tokenizer.DOCTYPE_TOKEN, ignoreToken), _defineProperty(_AFTER_AFTER_BODY_MOD, Tokenizer.START_TAG_TOKEN, startTagAfterAfterBody), _defineProperty(_AFTER_AFTER_BODY_MOD, Tokenizer.END_TAG_TOKEN, tokenAfterAfterBody), _defineProperty(_AFTER_AFTER_BODY_MOD, Tokenizer.EOF_TOKEN, stopParsing), _AFTER_AFTER_BODY_MOD)), _defineProperty(_TOKEN_HANDLERS, AFTER_AFTER_FRAMESET_MODE, (_AFTER_AFTER_FRAMESET = {}, _defineProperty(_AFTER_AFTER_FRAMESET, Tokenizer.CHARACTER_TOKEN, ignoreToken), _defineProperty(_AFTER_AFTER_FRAMESET, Tokenizer.NULL_CHARACTER_TOKEN, ignoreToken), _defineProperty(_AFTER_AFTER_FRAMESET, Tokenizer.WHITESPACE_CHARACTER_TOKEN, whitespaceCharacterInBody), _defineProperty(_AFTER_AFTER_FRAMESET, Tokenizer.COMMENT_TOKEN, appendCommentToDocument), _defineProperty(_AFTER_AFTER_FRAMESET, Tokenizer.DOCTYPE_TOKEN, ignoreToken), _defineProperty(_AFTER_AFTER_FRAMESET, Tokenizer.START_TAG_TOKEN, startTagAfterAfterFrameset), _defineProperty(_AFTER_AFTER_FRAMESET, Tokenizer.END_TAG_TOKEN, ignoreToken), _defineProperty(_AFTER_AFTER_FRAMESET, Tokenizer.EOF_TOKEN, stopParsing), _AFTER_AFTER_FRAMESET)), _TOKEN_HANDLERS); //Parser\n\nvar Parser = /*#__PURE__*/function () {\n  function Parser(options) {\n    _classCallCheck(this, Parser);\n\n    this.options = mergeOptions(DEFAULT_OPTIONS, options);\n    this.treeAdapter = this.options.treeAdapter;\n    this.pendingScript = null;\n\n    if (this.options.sourceCodeLocationInfo) {\n      Mixin.install(this, LocationInfoParserMixin);\n    }\n\n    if (this.options.onParseError) {\n      Mixin.install(this, ErrorReportingParserMixin, {\n        onParseError: this.options.onParseError\n      });\n    }\n  } // API\n\n\n  _createClass(Parser, [{\n    key: \"parse\",\n    value: function parse(html) {\n      var document = this.treeAdapter.createDocument();\n\n      this._bootstrap(document, null);\n\n      this.tokenizer.write(html, true);\n\n      this._runParsingLoop(null);\n\n      return document;\n    }\n  }, {\n    key: \"parseFragment\",\n    value: function parseFragment(html, fragmentContext) {\n      //NOTE: use <template> element as a fragment context if context element was not provided,\n      //so we will parse in \"forgiving\" manner\n      if (!fragmentContext) {\n        fragmentContext = this.treeAdapter.createElement($.TEMPLATE, NS.HTML, []);\n      } //NOTE: create fake element which will be used as 'document' for fragment parsing.\n      //This is important for jsdom there 'document' can't be recreated, therefore\n      //fragment parsing causes messing of the main `document`.\n\n\n      var documentMock = this.treeAdapter.createElement('documentmock', NS.HTML, []);\n\n      this._bootstrap(documentMock, fragmentContext);\n\n      if (this.treeAdapter.getTagName(fragmentContext) === $.TEMPLATE) {\n        this._pushTmplInsertionMode(IN_TEMPLATE_MODE);\n      }\n\n      this._initTokenizerForFragmentParsing();\n\n      this._insertFakeRootElement();\n\n      this._resetInsertionMode();\n\n      this._findFormInFragmentContext();\n\n      this.tokenizer.write(html, true);\n\n      this._runParsingLoop(null);\n\n      var rootElement = this.treeAdapter.getFirstChild(documentMock);\n      var fragment = this.treeAdapter.createDocumentFragment();\n\n      this._adoptNodes(rootElement, fragment);\n\n      return fragment;\n    } //Bootstrap parser\n\n  }, {\n    key: \"_bootstrap\",\n    value: function _bootstrap(document, fragmentContext) {\n      this.tokenizer = new Tokenizer(this.options);\n      this.stopped = false;\n      this.insertionMode = INITIAL_MODE;\n      this.originalInsertionMode = '';\n      this.document = document;\n      this.fragmentContext = fragmentContext;\n      this.headElement = null;\n      this.formElement = null;\n      this.openElements = new OpenElementStack(this.document, this.treeAdapter);\n      this.activeFormattingElements = new FormattingElementList(this.treeAdapter);\n      this.tmplInsertionModeStack = [];\n      this.tmplInsertionModeStackTop = -1;\n      this.currentTmplInsertionMode = null;\n      this.pendingCharacterTokens = [];\n      this.hasNonWhitespacePendingCharacterToken = false;\n      this.framesetOk = true;\n      this.skipNextNewLine = false;\n      this.fosterParentingEnabled = false;\n    } //Errors\n\n  }, {\n    key: \"_err\",\n    value: function _err() {// NOTE: err reporting is noop by default. Enabled by mixin.\n    } //Parsing loop\n\n  }, {\n    key: \"_runParsingLoop\",\n    value: function _runParsingLoop(scriptHandler) {\n      while (!this.stopped) {\n        this._setupTokenizerCDATAMode();\n\n        var token = this.tokenizer.getNextToken();\n\n        if (token.type === Tokenizer.HIBERNATION_TOKEN) {\n          break;\n        }\n\n        if (this.skipNextNewLine) {\n          this.skipNextNewLine = false;\n\n          if (token.type === Tokenizer.WHITESPACE_CHARACTER_TOKEN && token.chars[0] === '\\n') {\n            if (token.chars.length === 1) {\n              continue;\n            }\n\n            token.chars = token.chars.substr(1);\n          }\n        }\n\n        this._processInputToken(token);\n\n        if (scriptHandler && this.pendingScript) {\n          break;\n        }\n      }\n    }\n  }, {\n    key: \"runParsingLoopForCurrentChunk\",\n    value: function runParsingLoopForCurrentChunk(writeCallback, scriptHandler) {\n      this._runParsingLoop(scriptHandler);\n\n      if (scriptHandler && this.pendingScript) {\n        var script = this.pendingScript;\n        this.pendingScript = null;\n        scriptHandler(script);\n        return;\n      }\n\n      if (writeCallback) {\n        writeCallback();\n      }\n    } //Text parsing\n\n  }, {\n    key: \"_setupTokenizerCDATAMode\",\n    value: function _setupTokenizerCDATAMode() {\n      var current = this._getAdjustedCurrentElement();\n\n      this.tokenizer.allowCDATA = current && current !== this.document && this.treeAdapter.getNamespaceURI(current) !== NS.HTML && !this._isIntegrationPoint(current);\n    }\n  }, {\n    key: \"_switchToTextParsing\",\n    value: function _switchToTextParsing(currentToken, nextTokenizerState) {\n      this._insertElement(currentToken, NS.HTML);\n\n      this.tokenizer.state = nextTokenizerState;\n      this.originalInsertionMode = this.insertionMode;\n      this.insertionMode = TEXT_MODE;\n    }\n  }, {\n    key: \"switchToPlaintextParsing\",\n    value: function switchToPlaintextParsing() {\n      this.insertionMode = TEXT_MODE;\n      this.originalInsertionMode = IN_BODY_MODE;\n      this.tokenizer.state = Tokenizer.MODE.PLAINTEXT;\n    } //Fragment parsing\n\n  }, {\n    key: \"_getAdjustedCurrentElement\",\n    value: function _getAdjustedCurrentElement() {\n      return this.openElements.stackTop === 0 && this.fragmentContext ? this.fragmentContext : this.openElements.current;\n    }\n  }, {\n    key: \"_findFormInFragmentContext\",\n    value: function _findFormInFragmentContext() {\n      var node = this.fragmentContext;\n\n      do {\n        if (this.treeAdapter.getTagName(node) === $.FORM) {\n          this.formElement = node;\n          break;\n        }\n\n        node = this.treeAdapter.getParentNode(node);\n      } while (node);\n    }\n  }, {\n    key: \"_initTokenizerForFragmentParsing\",\n    value: function _initTokenizerForFragmentParsing() {\n      if (this.treeAdapter.getNamespaceURI(this.fragmentContext) === NS.HTML) {\n        var tn = this.treeAdapter.getTagName(this.fragmentContext);\n\n        if (tn === $.TITLE || tn === $.TEXTAREA) {\n          this.tokenizer.state = Tokenizer.MODE.RCDATA;\n        } else if (tn === $.STYLE || tn === $.XMP || tn === $.IFRAME || tn === $.NOEMBED || tn === $.NOFRAMES || tn === $.NOSCRIPT) {\n          this.tokenizer.state = Tokenizer.MODE.RAWTEXT;\n        } else if (tn === $.SCRIPT) {\n          this.tokenizer.state = Tokenizer.MODE.SCRIPT_DATA;\n        } else if (tn === $.PLAINTEXT) {\n          this.tokenizer.state = Tokenizer.MODE.PLAINTEXT;\n        }\n      }\n    } //Tree mutation\n\n  }, {\n    key: \"_setDocumentType\",\n    value: function _setDocumentType(token) {\n      var name = token.name || '';\n      var publicId = token.publicId || '';\n      var systemId = token.systemId || '';\n      this.treeAdapter.setDocumentType(this.document, name, publicId, systemId);\n    }\n  }, {\n    key: \"_attachElementToTree\",\n    value: function _attachElementToTree(element) {\n      if (this._shouldFosterParentOnInsertion()) {\n        this._fosterParentElement(element);\n      } else {\n        var parent = this.openElements.currentTmplContent || this.openElements.current;\n        this.treeAdapter.appendChild(parent, element);\n      }\n    }\n  }, {\n    key: \"_appendElement\",\n    value: function _appendElement(token, namespaceURI) {\n      var element = this.treeAdapter.createElement(token.tagName, namespaceURI, token.attrs);\n\n      this._attachElementToTree(element);\n    }\n  }, {\n    key: \"_insertElement\",\n    value: function _insertElement(token, namespaceURI) {\n      var element = this.treeAdapter.createElement(token.tagName, namespaceURI, token.attrs);\n\n      this._attachElementToTree(element);\n\n      this.openElements.push(element);\n    }\n  }, {\n    key: \"_insertFakeElement\",\n    value: function _insertFakeElement(tagName) {\n      var element = this.treeAdapter.createElement(tagName, NS.HTML, []);\n\n      this._attachElementToTree(element);\n\n      this.openElements.push(element);\n    }\n  }, {\n    key: \"_insertTemplate\",\n    value: function _insertTemplate(token) {\n      var tmpl = this.treeAdapter.createElement(token.tagName, NS.HTML, token.attrs);\n      var content = this.treeAdapter.createDocumentFragment();\n      this.treeAdapter.setTemplateContent(tmpl, content);\n\n      this._attachElementToTree(tmpl);\n\n      this.openElements.push(tmpl);\n    }\n  }, {\n    key: \"_insertFakeRootElement\",\n    value: function _insertFakeRootElement() {\n      var element = this.treeAdapter.createElement($.HTML, NS.HTML, []);\n      this.treeAdapter.appendChild(this.openElements.current, element);\n      this.openElements.push(element);\n    }\n  }, {\n    key: \"_appendCommentNode\",\n    value: function _appendCommentNode(token, parent) {\n      var commentNode = this.treeAdapter.createCommentNode(token.data);\n      this.treeAdapter.appendChild(parent, commentNode);\n    }\n  }, {\n    key: \"_insertCharacters\",\n    value: function _insertCharacters(token) {\n      if (this._shouldFosterParentOnInsertion()) {\n        this._fosterParentText(token.chars);\n      } else {\n        var parent = this.openElements.currentTmplContent || this.openElements.current;\n        this.treeAdapter.insertText(parent, token.chars);\n      }\n    }\n  }, {\n    key: \"_adoptNodes\",\n    value: function _adoptNodes(donor, recipient) {\n      for (var child = this.treeAdapter.getFirstChild(donor); child; child = this.treeAdapter.getFirstChild(donor)) {\n        this.treeAdapter.detachNode(child);\n        this.treeAdapter.appendChild(recipient, child);\n      }\n    } //Token processing\n\n  }, {\n    key: \"_shouldProcessTokenInForeignContent\",\n    value: function _shouldProcessTokenInForeignContent(token) {\n      var current = this._getAdjustedCurrentElement();\n\n      if (!current || current === this.document) {\n        return false;\n      }\n\n      var ns = this.treeAdapter.getNamespaceURI(current);\n\n      if (ns === NS.HTML) {\n        return false;\n      }\n\n      if (this.treeAdapter.getTagName(current) === $.ANNOTATION_XML && ns === NS.MATHML && token.type === Tokenizer.START_TAG_TOKEN && token.tagName === $.SVG) {\n        return false;\n      }\n\n      var isCharacterToken = token.type === Tokenizer.CHARACTER_TOKEN || token.type === Tokenizer.NULL_CHARACTER_TOKEN || token.type === Tokenizer.WHITESPACE_CHARACTER_TOKEN;\n      var isMathMLTextStartTag = token.type === Tokenizer.START_TAG_TOKEN && token.tagName !== $.MGLYPH && token.tagName !== $.MALIGNMARK;\n\n      if ((isMathMLTextStartTag || isCharacterToken) && this._isIntegrationPoint(current, NS.MATHML)) {\n        return false;\n      }\n\n      if ((token.type === Tokenizer.START_TAG_TOKEN || isCharacterToken) && this._isIntegrationPoint(current, NS.HTML)) {\n        return false;\n      }\n\n      return token.type !== Tokenizer.EOF_TOKEN;\n    }\n  }, {\n    key: \"_processToken\",\n    value: function _processToken(token) {\n      TOKEN_HANDLERS[this.insertionMode][token.type](this, token);\n    }\n  }, {\n    key: \"_processTokenInBodyMode\",\n    value: function _processTokenInBodyMode(token) {\n      TOKEN_HANDLERS[IN_BODY_MODE][token.type](this, token);\n    }\n  }, {\n    key: \"_processTokenInForeignContent\",\n    value: function _processTokenInForeignContent(token) {\n      if (token.type === Tokenizer.CHARACTER_TOKEN) {\n        characterInForeignContent(this, token);\n      } else if (token.type === Tokenizer.NULL_CHARACTER_TOKEN) {\n        nullCharacterInForeignContent(this, token);\n      } else if (token.type === Tokenizer.WHITESPACE_CHARACTER_TOKEN) {\n        insertCharacters(this, token);\n      } else if (token.type === Tokenizer.COMMENT_TOKEN) {\n        appendComment(this, token);\n      } else if (token.type === Tokenizer.START_TAG_TOKEN) {\n        startTagInForeignContent(this, token);\n      } else if (token.type === Tokenizer.END_TAG_TOKEN) {\n        endTagInForeignContent(this, token);\n      }\n    }\n  }, {\n    key: \"_processInputToken\",\n    value: function _processInputToken(token) {\n      if (this._shouldProcessTokenInForeignContent(token)) {\n        this._processTokenInForeignContent(token);\n      } else {\n        this._processToken(token);\n      }\n\n      if (token.type === Tokenizer.START_TAG_TOKEN && token.selfClosing && !token.ackSelfClosing) {\n        this._err(ERR.nonVoidHtmlElementStartTagWithTrailingSolidus);\n      }\n    } //Integration points\n\n  }, {\n    key: \"_isIntegrationPoint\",\n    value: function _isIntegrationPoint(element, foreignNS) {\n      var tn = this.treeAdapter.getTagName(element);\n      var ns = this.treeAdapter.getNamespaceURI(element);\n      var attrs = this.treeAdapter.getAttrList(element);\n      return foreignContent.isIntegrationPoint(tn, ns, attrs, foreignNS);\n    } //Active formatting elements reconstruction\n\n  }, {\n    key: \"_reconstructActiveFormattingElements\",\n    value: function _reconstructActiveFormattingElements() {\n      var listLength = this.activeFormattingElements.length;\n\n      if (listLength) {\n        var unopenIdx = listLength;\n        var entry = null;\n\n        do {\n          unopenIdx--;\n          entry = this.activeFormattingElements.entries[unopenIdx];\n\n          if (entry.type === FormattingElementList.MARKER_ENTRY || this.openElements.contains(entry.element)) {\n            unopenIdx++;\n            break;\n          }\n        } while (unopenIdx > 0);\n\n        for (var i = unopenIdx; i < listLength; i++) {\n          entry = this.activeFormattingElements.entries[i];\n\n          this._insertElement(entry.token, this.treeAdapter.getNamespaceURI(entry.element));\n\n          entry.element = this.openElements.current;\n        }\n      }\n    } //Close elements\n\n  }, {\n    key: \"_closeTableCell\",\n    value: function _closeTableCell() {\n      this.openElements.generateImpliedEndTags();\n      this.openElements.popUntilTableCellPopped();\n      this.activeFormattingElements.clearToLastMarker();\n      this.insertionMode = IN_ROW_MODE;\n    }\n  }, {\n    key: \"_closePElement\",\n    value: function _closePElement() {\n      this.openElements.generateImpliedEndTagsWithExclusion($.P);\n      this.openElements.popUntilTagNamePopped($.P);\n    } //Insertion modes\n\n  }, {\n    key: \"_resetInsertionMode\",\n    value: function _resetInsertionMode() {\n      for (var i = this.openElements.stackTop, last = false; i >= 0; i--) {\n        var element = this.openElements.items[i];\n\n        if (i === 0) {\n          last = true;\n\n          if (this.fragmentContext) {\n            element = this.fragmentContext;\n          }\n        }\n\n        var tn = this.treeAdapter.getTagName(element);\n        var newInsertionMode = INSERTION_MODE_RESET_MAP[tn];\n\n        if (newInsertionMode) {\n          this.insertionMode = newInsertionMode;\n          break;\n        } else if (!last && (tn === $.TD || tn === $.TH)) {\n          this.insertionMode = IN_CELL_MODE;\n          break;\n        } else if (!last && tn === $.HEAD) {\n          this.insertionMode = IN_HEAD_MODE;\n          break;\n        } else if (tn === $.SELECT) {\n          this._resetInsertionModeForSelect(i);\n\n          break;\n        } else if (tn === $.TEMPLATE) {\n          this.insertionMode = this.currentTmplInsertionMode;\n          break;\n        } else if (tn === $.HTML) {\n          this.insertionMode = this.headElement ? AFTER_HEAD_MODE : BEFORE_HEAD_MODE;\n          break;\n        } else if (last) {\n          this.insertionMode = IN_BODY_MODE;\n          break;\n        }\n      }\n    }\n  }, {\n    key: \"_resetInsertionModeForSelect\",\n    value: function _resetInsertionModeForSelect(selectIdx) {\n      if (selectIdx > 0) {\n        for (var i = selectIdx - 1; i > 0; i--) {\n          var ancestor = this.openElements.items[i];\n          var tn = this.treeAdapter.getTagName(ancestor);\n\n          if (tn === $.TEMPLATE) {\n            break;\n          } else if (tn === $.TABLE) {\n            this.insertionMode = IN_SELECT_IN_TABLE_MODE;\n            return;\n          }\n        }\n      }\n\n      this.insertionMode = IN_SELECT_MODE;\n    }\n  }, {\n    key: \"_pushTmplInsertionMode\",\n    value: function _pushTmplInsertionMode(mode) {\n      this.tmplInsertionModeStack.push(mode);\n      this.tmplInsertionModeStackTop++;\n      this.currentTmplInsertionMode = mode;\n    }\n  }, {\n    key: \"_popTmplInsertionMode\",\n    value: function _popTmplInsertionMode() {\n      this.tmplInsertionModeStack.pop();\n      this.tmplInsertionModeStackTop--;\n      this.currentTmplInsertionMode = this.tmplInsertionModeStack[this.tmplInsertionModeStackTop];\n    } //Foster parenting\n\n  }, {\n    key: \"_isElementCausesFosterParenting\",\n    value: function _isElementCausesFosterParenting(element) {\n      var tn = this.treeAdapter.getTagName(element);\n      return tn === $.TABLE || tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD || tn === $.TR;\n    }\n  }, {\n    key: \"_shouldFosterParentOnInsertion\",\n    value: function _shouldFosterParentOnInsertion() {\n      return this.fosterParentingEnabled && this._isElementCausesFosterParenting(this.openElements.current);\n    }\n  }, {\n    key: \"_findFosterParentingLocation\",\n    value: function _findFosterParentingLocation() {\n      var location = {\n        parent: null,\n        beforeElement: null\n      };\n\n      for (var i = this.openElements.stackTop; i >= 0; i--) {\n        var openElement = this.openElements.items[i];\n        var tn = this.treeAdapter.getTagName(openElement);\n        var ns = this.treeAdapter.getNamespaceURI(openElement);\n\n        if (tn === $.TEMPLATE && ns === NS.HTML) {\n          location.parent = this.treeAdapter.getTemplateContent(openElement);\n          break;\n        } else if (tn === $.TABLE) {\n          location.parent = this.treeAdapter.getParentNode(openElement);\n\n          if (location.parent) {\n            location.beforeElement = openElement;\n          } else {\n            location.parent = this.openElements.items[i - 1];\n          }\n\n          break;\n        }\n      }\n\n      if (!location.parent) {\n        location.parent = this.openElements.items[0];\n      }\n\n      return location;\n    }\n  }, {\n    key: \"_fosterParentElement\",\n    value: function _fosterParentElement(element) {\n      var location = this._findFosterParentingLocation();\n\n      if (location.beforeElement) {\n        this.treeAdapter.insertBefore(location.parent, element, location.beforeElement);\n      } else {\n        this.treeAdapter.appendChild(location.parent, element);\n      }\n    }\n  }, {\n    key: \"_fosterParentText\",\n    value: function _fosterParentText(chars) {\n      var location = this._findFosterParentingLocation();\n\n      if (location.beforeElement) {\n        this.treeAdapter.insertTextBefore(location.parent, chars, location.beforeElement);\n      } else {\n        this.treeAdapter.insertText(location.parent, chars);\n      }\n    } //Special elements\n\n  }, {\n    key: \"_isSpecialElement\",\n    value: function _isSpecialElement(element) {\n      var tn = this.treeAdapter.getTagName(element);\n      var ns = this.treeAdapter.getNamespaceURI(element);\n      return HTML.SPECIAL_ELEMENTS[ns][tn];\n    }\n  }]);\n\n  return Parser;\n}();\n\nmodule.exports = Parser; //Adoption agency algorithm\n//(see: http://www.whatwg.org/specs/web-apps/current-work/multipage/tree-construction.html#adoptionAgency)\n//------------------------------------------------------------------\n//Steps 5-8 of the algorithm\n\nfunction aaObtainFormattingElementEntry(p, token) {\n  var formattingElementEntry = p.activeFormattingElements.getElementEntryInScopeWithTagName(token.tagName);\n\n  if (formattingElementEntry) {\n    if (!p.openElements.contains(formattingElementEntry.element)) {\n      p.activeFormattingElements.removeEntry(formattingElementEntry);\n      formattingElementEntry = null;\n    } else if (!p.openElements.hasInScope(token.tagName)) {\n      formattingElementEntry = null;\n    }\n  } else {\n    genericEndTagInBody(p, token);\n  }\n\n  return formattingElementEntry;\n} //Steps 9 and 10 of the algorithm\n\n\nfunction aaObtainFurthestBlock(p, formattingElementEntry) {\n  var furthestBlock = null;\n\n  for (var i = p.openElements.stackTop; i >= 0; i--) {\n    var element = p.openElements.items[i];\n\n    if (element === formattingElementEntry.element) {\n      break;\n    }\n\n    if (p._isSpecialElement(element)) {\n      furthestBlock = element;\n    }\n  }\n\n  if (!furthestBlock) {\n    p.openElements.popUntilElementPopped(formattingElementEntry.element);\n    p.activeFormattingElements.removeEntry(formattingElementEntry);\n  }\n\n  return furthestBlock;\n} //Step 13 of the algorithm\n\n\nfunction aaInnerLoop(p, furthestBlock, formattingElement) {\n  var lastElement = furthestBlock;\n  var nextElement = p.openElements.getCommonAncestor(furthestBlock);\n\n  for (var i = 0, element = nextElement; element !== formattingElement; i++, element = nextElement) {\n    //NOTE: store next element for the next loop iteration (it may be deleted from the stack by step 9.5)\n    nextElement = p.openElements.getCommonAncestor(element);\n    var elementEntry = p.activeFormattingElements.getElementEntry(element);\n    var counterOverflow = elementEntry && i >= AA_INNER_LOOP_ITER;\n    var shouldRemoveFromOpenElements = !elementEntry || counterOverflow;\n\n    if (shouldRemoveFromOpenElements) {\n      if (counterOverflow) {\n        p.activeFormattingElements.removeEntry(elementEntry);\n      }\n\n      p.openElements.remove(element);\n    } else {\n      element = aaRecreateElementFromEntry(p, elementEntry);\n\n      if (lastElement === furthestBlock) {\n        p.activeFormattingElements.bookmark = elementEntry;\n      }\n\n      p.treeAdapter.detachNode(lastElement);\n      p.treeAdapter.appendChild(element, lastElement);\n      lastElement = element;\n    }\n  }\n\n  return lastElement;\n} //Step 13.7 of the algorithm\n\n\nfunction aaRecreateElementFromEntry(p, elementEntry) {\n  var ns = p.treeAdapter.getNamespaceURI(elementEntry.element);\n  var newElement = p.treeAdapter.createElement(elementEntry.token.tagName, ns, elementEntry.token.attrs);\n  p.openElements.replace(elementEntry.element, newElement);\n  elementEntry.element = newElement;\n  return newElement;\n} //Step 14 of the algorithm\n\n\nfunction aaInsertLastNodeInCommonAncestor(p, commonAncestor, lastElement) {\n  if (p._isElementCausesFosterParenting(commonAncestor)) {\n    p._fosterParentElement(lastElement);\n  } else {\n    var tn = p.treeAdapter.getTagName(commonAncestor);\n    var ns = p.treeAdapter.getNamespaceURI(commonAncestor);\n\n    if (tn === $.TEMPLATE && ns === NS.HTML) {\n      commonAncestor = p.treeAdapter.getTemplateContent(commonAncestor);\n    }\n\n    p.treeAdapter.appendChild(commonAncestor, lastElement);\n  }\n} //Steps 15-19 of the algorithm\n\n\nfunction aaReplaceFormattingElement(p, furthestBlock, formattingElementEntry) {\n  var ns = p.treeAdapter.getNamespaceURI(formattingElementEntry.element);\n  var token = formattingElementEntry.token;\n  var newElement = p.treeAdapter.createElement(token.tagName, ns, token.attrs);\n\n  p._adoptNodes(furthestBlock, newElement);\n\n  p.treeAdapter.appendChild(furthestBlock, newElement);\n  p.activeFormattingElements.insertElementAfterBookmark(newElement, formattingElementEntry.token);\n  p.activeFormattingElements.removeEntry(formattingElementEntry);\n  p.openElements.remove(formattingElementEntry.element);\n  p.openElements.insertAfter(furthestBlock, newElement);\n} //Algorithm entry point\n\n\nfunction callAdoptionAgency(p, token) {\n  var formattingElementEntry;\n\n  for (var i = 0; i < AA_OUTER_LOOP_ITER; i++) {\n    formattingElementEntry = aaObtainFormattingElementEntry(p, token, formattingElementEntry);\n\n    if (!formattingElementEntry) {\n      break;\n    }\n\n    var furthestBlock = aaObtainFurthestBlock(p, formattingElementEntry);\n\n    if (!furthestBlock) {\n      break;\n    }\n\n    p.activeFormattingElements.bookmark = formattingElementEntry;\n    var lastElement = aaInnerLoop(p, furthestBlock, formattingElementEntry.element);\n    var commonAncestor = p.openElements.getCommonAncestor(formattingElementEntry.element);\n    p.treeAdapter.detachNode(lastElement);\n    aaInsertLastNodeInCommonAncestor(p, commonAncestor, lastElement);\n    aaReplaceFormattingElement(p, furthestBlock, formattingElementEntry);\n  }\n} //Generic token handlers\n//------------------------------------------------------------------\n\n\nfunction ignoreToken() {//NOTE: do nothing =)\n}\n\nfunction misplacedDoctype(p) {\n  p._err(ERR.misplacedDoctype);\n}\n\nfunction appendComment(p, token) {\n  p._appendCommentNode(token, p.openElements.currentTmplContent || p.openElements.current);\n}\n\nfunction appendCommentToRootHtmlElement(p, token) {\n  p._appendCommentNode(token, p.openElements.items[0]);\n}\n\nfunction appendCommentToDocument(p, token) {\n  p._appendCommentNode(token, p.document);\n}\n\nfunction insertCharacters(p, token) {\n  p._insertCharacters(token);\n}\n\nfunction stopParsing(p) {\n  p.stopped = true;\n} // The \"initial\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction doctypeInInitialMode(p, token) {\n  p._setDocumentType(token);\n\n  var mode = token.forceQuirks ? HTML.DOCUMENT_MODE.QUIRKS : doctype.getDocumentMode(token);\n\n  if (!doctype.isConforming(token)) {\n    p._err(ERR.nonConformingDoctype);\n  }\n\n  p.treeAdapter.setDocumentMode(p.document, mode);\n  p.insertionMode = BEFORE_HTML_MODE;\n}\n\nfunction tokenInInitialMode(p, token) {\n  p._err(ERR.missingDoctype, {\n    beforeToken: true\n  });\n\n  p.treeAdapter.setDocumentMode(p.document, HTML.DOCUMENT_MODE.QUIRKS);\n  p.insertionMode = BEFORE_HTML_MODE;\n\n  p._processToken(token);\n} // The \"before html\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagBeforeHtml(p, token) {\n  if (token.tagName === $.HTML) {\n    p._insertElement(token, NS.HTML);\n\n    p.insertionMode = BEFORE_HEAD_MODE;\n  } else {\n    tokenBeforeHtml(p, token);\n  }\n}\n\nfunction endTagBeforeHtml(p, token) {\n  var tn = token.tagName;\n\n  if (tn === $.HTML || tn === $.HEAD || tn === $.BODY || tn === $.BR) {\n    tokenBeforeHtml(p, token);\n  }\n}\n\nfunction tokenBeforeHtml(p, token) {\n  p._insertFakeRootElement();\n\n  p.insertionMode = BEFORE_HEAD_MODE;\n\n  p._processToken(token);\n} // The \"before head\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagBeforeHead(p, token) {\n  var tn = token.tagName;\n\n  if (tn === $.HTML) {\n    startTagInBody(p, token);\n  } else if (tn === $.HEAD) {\n    p._insertElement(token, NS.HTML);\n\n    p.headElement = p.openElements.current;\n    p.insertionMode = IN_HEAD_MODE;\n  } else {\n    tokenBeforeHead(p, token);\n  }\n}\n\nfunction endTagBeforeHead(p, token) {\n  var tn = token.tagName;\n\n  if (tn === $.HEAD || tn === $.BODY || tn === $.HTML || tn === $.BR) {\n    tokenBeforeHead(p, token);\n  } else {\n    p._err(ERR.endTagWithoutMatchingOpenElement);\n  }\n}\n\nfunction tokenBeforeHead(p, token) {\n  p._insertFakeElement($.HEAD);\n\n  p.headElement = p.openElements.current;\n  p.insertionMode = IN_HEAD_MODE;\n\n  p._processToken(token);\n} // The \"in head\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagInHead(p, token) {\n  var tn = token.tagName;\n\n  if (tn === $.HTML) {\n    startTagInBody(p, token);\n  } else if (tn === $.BASE || tn === $.BASEFONT || tn === $.BGSOUND || tn === $.LINK || tn === $.META) {\n    p._appendElement(token, NS.HTML);\n\n    token.ackSelfClosing = true;\n  } else if (tn === $.TITLE) {\n    p._switchToTextParsing(token, Tokenizer.MODE.RCDATA);\n  } else if (tn === $.NOSCRIPT) {\n    if (p.options.scriptingEnabled) {\n      p._switchToTextParsing(token, Tokenizer.MODE.RAWTEXT);\n    } else {\n      p._insertElement(token, NS.HTML);\n\n      p.insertionMode = IN_HEAD_NO_SCRIPT_MODE;\n    }\n  } else if (tn === $.NOFRAMES || tn === $.STYLE) {\n    p._switchToTextParsing(token, Tokenizer.MODE.RAWTEXT);\n  } else if (tn === $.SCRIPT) {\n    p._switchToTextParsing(token, Tokenizer.MODE.SCRIPT_DATA);\n  } else if (tn === $.TEMPLATE) {\n    p._insertTemplate(token, NS.HTML);\n\n    p.activeFormattingElements.insertMarker();\n    p.framesetOk = false;\n    p.insertionMode = IN_TEMPLATE_MODE;\n\n    p._pushTmplInsertionMode(IN_TEMPLATE_MODE);\n  } else if (tn === $.HEAD) {\n    p._err(ERR.misplacedStartTagForHeadElement);\n  } else {\n    tokenInHead(p, token);\n  }\n}\n\nfunction endTagInHead(p, token) {\n  var tn = token.tagName;\n\n  if (tn === $.HEAD) {\n    p.openElements.pop();\n    p.insertionMode = AFTER_HEAD_MODE;\n  } else if (tn === $.BODY || tn === $.BR || tn === $.HTML) {\n    tokenInHead(p, token);\n  } else if (tn === $.TEMPLATE) {\n    if (p.openElements.tmplCount > 0) {\n      p.openElements.generateImpliedEndTagsThoroughly();\n\n      if (p.openElements.currentTagName !== $.TEMPLATE) {\n        p._err(ERR.closingOfElementWithOpenChildElements);\n      }\n\n      p.openElements.popUntilTagNamePopped($.TEMPLATE);\n      p.activeFormattingElements.clearToLastMarker();\n\n      p._popTmplInsertionMode();\n\n      p._resetInsertionMode();\n    } else {\n      p._err(ERR.endTagWithoutMatchingOpenElement);\n    }\n  } else {\n    p._err(ERR.endTagWithoutMatchingOpenElement);\n  }\n}\n\nfunction tokenInHead(p, token) {\n  p.openElements.pop();\n  p.insertionMode = AFTER_HEAD_MODE;\n\n  p._processToken(token);\n} // The \"in head no script\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagInHeadNoScript(p, token) {\n  var tn = token.tagName;\n\n  if (tn === $.HTML) {\n    startTagInBody(p, token);\n  } else if (tn === $.BASEFONT || tn === $.BGSOUND || tn === $.HEAD || tn === $.LINK || tn === $.META || tn === $.NOFRAMES || tn === $.STYLE) {\n    startTagInHead(p, token);\n  } else if (tn === $.NOSCRIPT) {\n    p._err(ERR.nestedNoscriptInHead);\n  } else {\n    tokenInHeadNoScript(p, token);\n  }\n}\n\nfunction endTagInHeadNoScript(p, token) {\n  var tn = token.tagName;\n\n  if (tn === $.NOSCRIPT) {\n    p.openElements.pop();\n    p.insertionMode = IN_HEAD_MODE;\n  } else if (tn === $.BR) {\n    tokenInHeadNoScript(p, token);\n  } else {\n    p._err(ERR.endTagWithoutMatchingOpenElement);\n  }\n}\n\nfunction tokenInHeadNoScript(p, token) {\n  var errCode = token.type === Tokenizer.EOF_TOKEN ? ERR.openElementsLeftAfterEof : ERR.disallowedContentInNoscriptInHead;\n\n  p._err(errCode);\n\n  p.openElements.pop();\n  p.insertionMode = IN_HEAD_MODE;\n\n  p._processToken(token);\n} // The \"after head\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagAfterHead(p, token) {\n  var tn = token.tagName;\n\n  if (tn === $.HTML) {\n    startTagInBody(p, token);\n  } else if (tn === $.BODY) {\n    p._insertElement(token, NS.HTML);\n\n    p.framesetOk = false;\n    p.insertionMode = IN_BODY_MODE;\n  } else if (tn === $.FRAMESET) {\n    p._insertElement(token, NS.HTML);\n\n    p.insertionMode = IN_FRAMESET_MODE;\n  } else if (tn === $.BASE || tn === $.BASEFONT || tn === $.BGSOUND || tn === $.LINK || tn === $.META || tn === $.NOFRAMES || tn === $.SCRIPT || tn === $.STYLE || tn === $.TEMPLATE || tn === $.TITLE) {\n    p._err(ERR.abandonedHeadElementChild);\n\n    p.openElements.push(p.headElement);\n    startTagInHead(p, token);\n    p.openElements.remove(p.headElement);\n  } else if (tn === $.HEAD) {\n    p._err(ERR.misplacedStartTagForHeadElement);\n  } else {\n    tokenAfterHead(p, token);\n  }\n}\n\nfunction endTagAfterHead(p, token) {\n  var tn = token.tagName;\n\n  if (tn === $.BODY || tn === $.HTML || tn === $.BR) {\n    tokenAfterHead(p, token);\n  } else if (tn === $.TEMPLATE) {\n    endTagInHead(p, token);\n  } else {\n    p._err(ERR.endTagWithoutMatchingOpenElement);\n  }\n}\n\nfunction tokenAfterHead(p, token) {\n  p._insertFakeElement($.BODY);\n\n  p.insertionMode = IN_BODY_MODE;\n\n  p._processToken(token);\n} // The \"in body\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction whitespaceCharacterInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n\n  p._insertCharacters(token);\n}\n\nfunction characterInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n\n  p._insertCharacters(token);\n\n  p.framesetOk = false;\n}\n\nfunction htmlStartTagInBody(p, token) {\n  if (p.openElements.tmplCount === 0) {\n    p.treeAdapter.adoptAttributes(p.openElements.items[0], token.attrs);\n  }\n}\n\nfunction bodyStartTagInBody(p, token) {\n  var bodyElement = p.openElements.tryPeekProperlyNestedBodyElement();\n\n  if (bodyElement && p.openElements.tmplCount === 0) {\n    p.framesetOk = false;\n    p.treeAdapter.adoptAttributes(bodyElement, token.attrs);\n  }\n}\n\nfunction framesetStartTagInBody(p, token) {\n  var bodyElement = p.openElements.tryPeekProperlyNestedBodyElement();\n\n  if (p.framesetOk && bodyElement) {\n    p.treeAdapter.detachNode(bodyElement);\n    p.openElements.popAllUpToHtmlElement();\n\n    p._insertElement(token, NS.HTML);\n\n    p.insertionMode = IN_FRAMESET_MODE;\n  }\n}\n\nfunction addressStartTagInBody(p, token) {\n  if (p.openElements.hasInButtonScope($.P)) {\n    p._closePElement();\n  }\n\n  p._insertElement(token, NS.HTML);\n}\n\nfunction numberedHeaderStartTagInBody(p, token) {\n  if (p.openElements.hasInButtonScope($.P)) {\n    p._closePElement();\n  }\n\n  var tn = p.openElements.currentTagName;\n\n  if (tn === $.H1 || tn === $.H2 || tn === $.H3 || tn === $.H4 || tn === $.H5 || tn === $.H6) {\n    p.openElements.pop();\n  }\n\n  p._insertElement(token, NS.HTML);\n}\n\nfunction preStartTagInBody(p, token) {\n  if (p.openElements.hasInButtonScope($.P)) {\n    p._closePElement();\n  }\n\n  p._insertElement(token, NS.HTML); //NOTE: If the next token is a U+000A LINE FEED (LF) character token, then ignore that token and move\n  //on to the next one. (Newlines at the start of pre blocks are ignored as an authoring convenience.)\n\n\n  p.skipNextNewLine = true;\n  p.framesetOk = false;\n}\n\nfunction formStartTagInBody(p, token) {\n  var inTemplate = p.openElements.tmplCount > 0;\n\n  if (!p.formElement || inTemplate) {\n    if (p.openElements.hasInButtonScope($.P)) {\n      p._closePElement();\n    }\n\n    p._insertElement(token, NS.HTML);\n\n    if (!inTemplate) {\n      p.formElement = p.openElements.current;\n    }\n  }\n}\n\nfunction listItemStartTagInBody(p, token) {\n  p.framesetOk = false;\n  var tn = token.tagName;\n\n  for (var i = p.openElements.stackTop; i >= 0; i--) {\n    var element = p.openElements.items[i];\n    var elementTn = p.treeAdapter.getTagName(element);\n    var closeTn = null;\n\n    if (tn === $.LI && elementTn === $.LI) {\n      closeTn = $.LI;\n    } else if ((tn === $.DD || tn === $.DT) && (elementTn === $.DD || elementTn === $.DT)) {\n      closeTn = elementTn;\n    }\n\n    if (closeTn) {\n      p.openElements.generateImpliedEndTagsWithExclusion(closeTn);\n      p.openElements.popUntilTagNamePopped(closeTn);\n      break;\n    }\n\n    if (elementTn !== $.ADDRESS && elementTn !== $.DIV && elementTn !== $.P && p._isSpecialElement(element)) {\n      break;\n    }\n  }\n\n  if (p.openElements.hasInButtonScope($.P)) {\n    p._closePElement();\n  }\n\n  p._insertElement(token, NS.HTML);\n}\n\nfunction plaintextStartTagInBody(p, token) {\n  if (p.openElements.hasInButtonScope($.P)) {\n    p._closePElement();\n  }\n\n  p._insertElement(token, NS.HTML);\n\n  p.tokenizer.state = Tokenizer.MODE.PLAINTEXT;\n}\n\nfunction buttonStartTagInBody(p, token) {\n  if (p.openElements.hasInScope($.BUTTON)) {\n    p.openElements.generateImpliedEndTags();\n    p.openElements.popUntilTagNamePopped($.BUTTON);\n  }\n\n  p._reconstructActiveFormattingElements();\n\n  p._insertElement(token, NS.HTML);\n\n  p.framesetOk = false;\n}\n\nfunction aStartTagInBody(p, token) {\n  var activeElementEntry = p.activeFormattingElements.getElementEntryInScopeWithTagName($.A);\n\n  if (activeElementEntry) {\n    callAdoptionAgency(p, token);\n    p.openElements.remove(activeElementEntry.element);\n    p.activeFormattingElements.removeEntry(activeElementEntry);\n  }\n\n  p._reconstructActiveFormattingElements();\n\n  p._insertElement(token, NS.HTML);\n\n  p.activeFormattingElements.pushElement(p.openElements.current, token);\n}\n\nfunction bStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n\n  p._insertElement(token, NS.HTML);\n\n  p.activeFormattingElements.pushElement(p.openElements.current, token);\n}\n\nfunction nobrStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n\n  if (p.openElements.hasInScope($.NOBR)) {\n    callAdoptionAgency(p, token);\n\n    p._reconstructActiveFormattingElements();\n  }\n\n  p._insertElement(token, NS.HTML);\n\n  p.activeFormattingElements.pushElement(p.openElements.current, token);\n}\n\nfunction appletStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n\n  p._insertElement(token, NS.HTML);\n\n  p.activeFormattingElements.insertMarker();\n  p.framesetOk = false;\n}\n\nfunction tableStartTagInBody(p, token) {\n  if (p.treeAdapter.getDocumentMode(p.document) !== HTML.DOCUMENT_MODE.QUIRKS && p.openElements.hasInButtonScope($.P)) {\n    p._closePElement();\n  }\n\n  p._insertElement(token, NS.HTML);\n\n  p.framesetOk = false;\n  p.insertionMode = IN_TABLE_MODE;\n}\n\nfunction areaStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n\n  p._appendElement(token, NS.HTML);\n\n  p.framesetOk = false;\n  token.ackSelfClosing = true;\n}\n\nfunction inputStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n\n  p._appendElement(token, NS.HTML);\n\n  var inputType = Tokenizer.getTokenAttr(token, ATTRS.TYPE);\n\n  if (!inputType || inputType.toLowerCase() !== HIDDEN_INPUT_TYPE) {\n    p.framesetOk = false;\n  }\n\n  token.ackSelfClosing = true;\n}\n\nfunction paramStartTagInBody(p, token) {\n  p._appendElement(token, NS.HTML);\n\n  token.ackSelfClosing = true;\n}\n\nfunction hrStartTagInBody(p, token) {\n  if (p.openElements.hasInButtonScope($.P)) {\n    p._closePElement();\n  }\n\n  p._appendElement(token, NS.HTML);\n\n  p.framesetOk = false;\n  token.ackSelfClosing = true;\n}\n\nfunction imageStartTagInBody(p, token) {\n  token.tagName = $.IMG;\n  areaStartTagInBody(p, token);\n}\n\nfunction textareaStartTagInBody(p, token) {\n  p._insertElement(token, NS.HTML); //NOTE: If the next token is a U+000A LINE FEED (LF) character token, then ignore that token and move\n  //on to the next one. (Newlines at the start of textarea elements are ignored as an authoring convenience.)\n\n\n  p.skipNextNewLine = true;\n  p.tokenizer.state = Tokenizer.MODE.RCDATA;\n  p.originalInsertionMode = p.insertionMode;\n  p.framesetOk = false;\n  p.insertionMode = TEXT_MODE;\n}\n\nfunction xmpStartTagInBody(p, token) {\n  if (p.openElements.hasInButtonScope($.P)) {\n    p._closePElement();\n  }\n\n  p._reconstructActiveFormattingElements();\n\n  p.framesetOk = false;\n\n  p._switchToTextParsing(token, Tokenizer.MODE.RAWTEXT);\n}\n\nfunction iframeStartTagInBody(p, token) {\n  p.framesetOk = false;\n\n  p._switchToTextParsing(token, Tokenizer.MODE.RAWTEXT);\n} //NOTE: here we assume that we always act as an user agent with enabled plugins, so we parse\n//<noembed> as a rawtext.\n\n\nfunction noembedStartTagInBody(p, token) {\n  p._switchToTextParsing(token, Tokenizer.MODE.RAWTEXT);\n}\n\nfunction selectStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n\n  p._insertElement(token, NS.HTML);\n\n  p.framesetOk = false;\n\n  if (p.insertionMode === IN_TABLE_MODE || p.insertionMode === IN_CAPTION_MODE || p.insertionMode === IN_TABLE_BODY_MODE || p.insertionMode === IN_ROW_MODE || p.insertionMode === IN_CELL_MODE) {\n    p.insertionMode = IN_SELECT_IN_TABLE_MODE;\n  } else {\n    p.insertionMode = IN_SELECT_MODE;\n  }\n}\n\nfunction optgroupStartTagInBody(p, token) {\n  if (p.openElements.currentTagName === $.OPTION) {\n    p.openElements.pop();\n  }\n\n  p._reconstructActiveFormattingElements();\n\n  p._insertElement(token, NS.HTML);\n}\n\nfunction rbStartTagInBody(p, token) {\n  if (p.openElements.hasInScope($.RUBY)) {\n    p.openElements.generateImpliedEndTags();\n  }\n\n  p._insertElement(token, NS.HTML);\n}\n\nfunction rtStartTagInBody(p, token) {\n  if (p.openElements.hasInScope($.RUBY)) {\n    p.openElements.generateImpliedEndTagsWithExclusion($.RTC);\n  }\n\n  p._insertElement(token, NS.HTML);\n}\n\nfunction menuStartTagInBody(p, token) {\n  if (p.openElements.hasInButtonScope($.P)) {\n    p._closePElement();\n  }\n\n  p._insertElement(token, NS.HTML);\n}\n\nfunction mathStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n\n  foreignContent.adjustTokenMathMLAttrs(token);\n  foreignContent.adjustTokenXMLAttrs(token);\n\n  if (token.selfClosing) {\n    p._appendElement(token, NS.MATHML);\n  } else {\n    p._insertElement(token, NS.MATHML);\n  }\n\n  token.ackSelfClosing = true;\n}\n\nfunction svgStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n\n  foreignContent.adjustTokenSVGAttrs(token);\n  foreignContent.adjustTokenXMLAttrs(token);\n\n  if (token.selfClosing) {\n    p._appendElement(token, NS.SVG);\n  } else {\n    p._insertElement(token, NS.SVG);\n  }\n\n  token.ackSelfClosing = true;\n}\n\nfunction genericStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n\n  p._insertElement(token, NS.HTML);\n} //OPTIMIZATION: Integer comparisons are low-cost, so we can use very fast tag name length filters here.\n//It's faster than using dictionary.\n\n\nfunction startTagInBody(p, token) {\n  var tn = token.tagName;\n\n  switch (tn.length) {\n    case 1:\n      if (tn === $.I || tn === $.S || tn === $.B || tn === $.U) {\n        bStartTagInBody(p, token);\n      } else if (tn === $.P) {\n        addressStartTagInBody(p, token);\n      } else if (tn === $.A) {\n        aStartTagInBody(p, token);\n      } else {\n        genericStartTagInBody(p, token);\n      }\n\n      break;\n\n    case 2:\n      if (tn === $.DL || tn === $.OL || tn === $.UL) {\n        addressStartTagInBody(p, token);\n      } else if (tn === $.H1 || tn === $.H2 || tn === $.H3 || tn === $.H4 || tn === $.H5 || tn === $.H6) {\n        numberedHeaderStartTagInBody(p, token);\n      } else if (tn === $.LI || tn === $.DD || tn === $.DT) {\n        listItemStartTagInBody(p, token);\n      } else if (tn === $.EM || tn === $.TT) {\n        bStartTagInBody(p, token);\n      } else if (tn === $.BR) {\n        areaStartTagInBody(p, token);\n      } else if (tn === $.HR) {\n        hrStartTagInBody(p, token);\n      } else if (tn === $.RB) {\n        rbStartTagInBody(p, token);\n      } else if (tn === $.RT || tn === $.RP) {\n        rtStartTagInBody(p, token);\n      } else if (tn !== $.TH && tn !== $.TD && tn !== $.TR) {\n        genericStartTagInBody(p, token);\n      }\n\n      break;\n\n    case 3:\n      if (tn === $.DIV || tn === $.DIR || tn === $.NAV) {\n        addressStartTagInBody(p, token);\n      } else if (tn === $.PRE) {\n        preStartTagInBody(p, token);\n      } else if (tn === $.BIG) {\n        bStartTagInBody(p, token);\n      } else if (tn === $.IMG || tn === $.WBR) {\n        areaStartTagInBody(p, token);\n      } else if (tn === $.XMP) {\n        xmpStartTagInBody(p, token);\n      } else if (tn === $.SVG) {\n        svgStartTagInBody(p, token);\n      } else if (tn === $.RTC) {\n        rbStartTagInBody(p, token);\n      } else if (tn !== $.COL) {\n        genericStartTagInBody(p, token);\n      }\n\n      break;\n\n    case 4:\n      if (tn === $.HTML) {\n        htmlStartTagInBody(p, token);\n      } else if (tn === $.BASE || tn === $.LINK || tn === $.META) {\n        startTagInHead(p, token);\n      } else if (tn === $.BODY) {\n        bodyStartTagInBody(p, token);\n      } else if (tn === $.MAIN || tn === $.MENU) {\n        addressStartTagInBody(p, token);\n      } else if (tn === $.FORM) {\n        formStartTagInBody(p, token);\n      } else if (tn === $.CODE || tn === $.FONT) {\n        bStartTagInBody(p, token);\n      } else if (tn === $.NOBR) {\n        nobrStartTagInBody(p, token);\n      } else if (tn === $.AREA) {\n        areaStartTagInBody(p, token);\n      } else if (tn === $.MATH) {\n        mathStartTagInBody(p, token);\n      } else if (tn === $.MENU) {\n        menuStartTagInBody(p, token);\n      } else if (tn !== $.HEAD) {\n        genericStartTagInBody(p, token);\n      }\n\n      break;\n\n    case 5:\n      if (tn === $.STYLE || tn === $.TITLE) {\n        startTagInHead(p, token);\n      } else if (tn === $.ASIDE) {\n        addressStartTagInBody(p, token);\n      } else if (tn === $.SMALL) {\n        bStartTagInBody(p, token);\n      } else if (tn === $.TABLE) {\n        tableStartTagInBody(p, token);\n      } else if (tn === $.EMBED) {\n        areaStartTagInBody(p, token);\n      } else if (tn === $.INPUT) {\n        inputStartTagInBody(p, token);\n      } else if (tn === $.PARAM || tn === $.TRACK) {\n        paramStartTagInBody(p, token);\n      } else if (tn === $.IMAGE) {\n        imageStartTagInBody(p, token);\n      } else if (tn !== $.FRAME && tn !== $.TBODY && tn !== $.TFOOT && tn !== $.THEAD) {\n        genericStartTagInBody(p, token);\n      }\n\n      break;\n\n    case 6:\n      if (tn === $.SCRIPT) {\n        startTagInHead(p, token);\n      } else if (tn === $.CENTER || tn === $.FIGURE || tn === $.FOOTER || tn === $.HEADER || tn === $.HGROUP || tn === $.DIALOG) {\n        addressStartTagInBody(p, token);\n      } else if (tn === $.BUTTON) {\n        buttonStartTagInBody(p, token);\n      } else if (tn === $.STRIKE || tn === $.STRONG) {\n        bStartTagInBody(p, token);\n      } else if (tn === $.APPLET || tn === $.OBJECT) {\n        appletStartTagInBody(p, token);\n      } else if (tn === $.KEYGEN) {\n        areaStartTagInBody(p, token);\n      } else if (tn === $.SOURCE) {\n        paramStartTagInBody(p, token);\n      } else if (tn === $.IFRAME) {\n        iframeStartTagInBody(p, token);\n      } else if (tn === $.SELECT) {\n        selectStartTagInBody(p, token);\n      } else if (tn === $.OPTION) {\n        optgroupStartTagInBody(p, token);\n      } else {\n        genericStartTagInBody(p, token);\n      }\n\n      break;\n\n    case 7:\n      if (tn === $.BGSOUND) {\n        startTagInHead(p, token);\n      } else if (tn === $.DETAILS || tn === $.ADDRESS || tn === $.ARTICLE || tn === $.SECTION || tn === $.SUMMARY) {\n        addressStartTagInBody(p, token);\n      } else if (tn === $.LISTING) {\n        preStartTagInBody(p, token);\n      } else if (tn === $.MARQUEE) {\n        appletStartTagInBody(p, token);\n      } else if (tn === $.NOEMBED) {\n        noembedStartTagInBody(p, token);\n      } else if (tn !== $.CAPTION) {\n        genericStartTagInBody(p, token);\n      }\n\n      break;\n\n    case 8:\n      if (tn === $.BASEFONT) {\n        startTagInHead(p, token);\n      } else if (tn === $.FRAMESET) {\n        framesetStartTagInBody(p, token);\n      } else if (tn === $.FIELDSET) {\n        addressStartTagInBody(p, token);\n      } else if (tn === $.TEXTAREA) {\n        textareaStartTagInBody(p, token);\n      } else if (tn === $.TEMPLATE) {\n        startTagInHead(p, token);\n      } else if (tn === $.NOSCRIPT) {\n        if (p.options.scriptingEnabled) {\n          noembedStartTagInBody(p, token);\n        } else {\n          genericStartTagInBody(p, token);\n        }\n      } else if (tn === $.OPTGROUP) {\n        optgroupStartTagInBody(p, token);\n      } else if (tn !== $.COLGROUP) {\n        genericStartTagInBody(p, token);\n      }\n\n      break;\n\n    case 9:\n      if (tn === $.PLAINTEXT) {\n        plaintextStartTagInBody(p, token);\n      } else {\n        genericStartTagInBody(p, token);\n      }\n\n      break;\n\n    case 10:\n      if (tn === $.BLOCKQUOTE || tn === $.FIGCAPTION) {\n        addressStartTagInBody(p, token);\n      } else {\n        genericStartTagInBody(p, token);\n      }\n\n      break;\n\n    default:\n      genericStartTagInBody(p, token);\n  }\n}\n\nfunction bodyEndTagInBody(p) {\n  if (p.openElements.hasInScope($.BODY)) {\n    p.insertionMode = AFTER_BODY_MODE;\n  }\n}\n\nfunction htmlEndTagInBody(p, token) {\n  if (p.openElements.hasInScope($.BODY)) {\n    p.insertionMode = AFTER_BODY_MODE;\n\n    p._processToken(token);\n  }\n}\n\nfunction addressEndTagInBody(p, token) {\n  var tn = token.tagName;\n\n  if (p.openElements.hasInScope(tn)) {\n    p.openElements.generateImpliedEndTags();\n    p.openElements.popUntilTagNamePopped(tn);\n  }\n}\n\nfunction formEndTagInBody(p) {\n  var inTemplate = p.openElements.tmplCount > 0;\n  var formElement = p.formElement;\n\n  if (!inTemplate) {\n    p.formElement = null;\n  }\n\n  if ((formElement || inTemplate) && p.openElements.hasInScope($.FORM)) {\n    p.openElements.generateImpliedEndTags();\n\n    if (inTemplate) {\n      p.openElements.popUntilTagNamePopped($.FORM);\n    } else {\n      p.openElements.remove(formElement);\n    }\n  }\n}\n\nfunction pEndTagInBody(p) {\n  if (!p.openElements.hasInButtonScope($.P)) {\n    p._insertFakeElement($.P);\n  }\n\n  p._closePElement();\n}\n\nfunction liEndTagInBody(p) {\n  if (p.openElements.hasInListItemScope($.LI)) {\n    p.openElements.generateImpliedEndTagsWithExclusion($.LI);\n    p.openElements.popUntilTagNamePopped($.LI);\n  }\n}\n\nfunction ddEndTagInBody(p, token) {\n  var tn = token.tagName;\n\n  if (p.openElements.hasInScope(tn)) {\n    p.openElements.generateImpliedEndTagsWithExclusion(tn);\n    p.openElements.popUntilTagNamePopped(tn);\n  }\n}\n\nfunction numberedHeaderEndTagInBody(p) {\n  if (p.openElements.hasNumberedHeaderInScope()) {\n    p.openElements.generateImpliedEndTags();\n    p.openElements.popUntilNumberedHeaderPopped();\n  }\n}\n\nfunction appletEndTagInBody(p, token) {\n  var tn = token.tagName;\n\n  if (p.openElements.hasInScope(tn)) {\n    p.openElements.generateImpliedEndTags();\n    p.openElements.popUntilTagNamePopped(tn);\n    p.activeFormattingElements.clearToLastMarker();\n  }\n}\n\nfunction brEndTagInBody(p) {\n  p._reconstructActiveFormattingElements();\n\n  p._insertFakeElement($.BR);\n\n  p.openElements.pop();\n  p.framesetOk = false;\n}\n\nfunction genericEndTagInBody(p, token) {\n  var tn = token.tagName;\n\n  for (var i = p.openElements.stackTop; i > 0; i--) {\n    var element = p.openElements.items[i];\n\n    if (p.treeAdapter.getTagName(element) === tn) {\n      p.openElements.generateImpliedEndTagsWithExclusion(tn);\n      p.openElements.popUntilElementPopped(element);\n      break;\n    }\n\n    if (p._isSpecialElement(element)) {\n      break;\n    }\n  }\n} //OPTIMIZATION: Integer comparisons are low-cost, so we can use very fast tag name length filters here.\n//It's faster than using dictionary.\n\n\nfunction endTagInBody(p, token) {\n  var tn = token.tagName;\n\n  switch (tn.length) {\n    case 1:\n      if (tn === $.A || tn === $.B || tn === $.I || tn === $.S || tn === $.U) {\n        callAdoptionAgency(p, token);\n      } else if (tn === $.P) {\n        pEndTagInBody(p, token);\n      } else {\n        genericEndTagInBody(p, token);\n      }\n\n      break;\n\n    case 2:\n      if (tn === $.DL || tn === $.UL || tn === $.OL) {\n        addressEndTagInBody(p, token);\n      } else if (tn === $.LI) {\n        liEndTagInBody(p, token);\n      } else if (tn === $.DD || tn === $.DT) {\n        ddEndTagInBody(p, token);\n      } else if (tn === $.H1 || tn === $.H2 || tn === $.H3 || tn === $.H4 || tn === $.H5 || tn === $.H6) {\n        numberedHeaderEndTagInBody(p, token);\n      } else if (tn === $.BR) {\n        brEndTagInBody(p, token);\n      } else if (tn === $.EM || tn === $.TT) {\n        callAdoptionAgency(p, token);\n      } else {\n        genericEndTagInBody(p, token);\n      }\n\n      break;\n\n    case 3:\n      if (tn === $.BIG) {\n        callAdoptionAgency(p, token);\n      } else if (tn === $.DIR || tn === $.DIV || tn === $.NAV || tn === $.PRE) {\n        addressEndTagInBody(p, token);\n      } else {\n        genericEndTagInBody(p, token);\n      }\n\n      break;\n\n    case 4:\n      if (tn === $.BODY) {\n        bodyEndTagInBody(p, token);\n      } else if (tn === $.HTML) {\n        htmlEndTagInBody(p, token);\n      } else if (tn === $.FORM) {\n        formEndTagInBody(p, token);\n      } else if (tn === $.CODE || tn === $.FONT || tn === $.NOBR) {\n        callAdoptionAgency(p, token);\n      } else if (tn === $.MAIN || tn === $.MENU) {\n        addressEndTagInBody(p, token);\n      } else {\n        genericEndTagInBody(p, token);\n      }\n\n      break;\n\n    case 5:\n      if (tn === $.ASIDE) {\n        addressEndTagInBody(p, token);\n      } else if (tn === $.SMALL) {\n        callAdoptionAgency(p, token);\n      } else {\n        genericEndTagInBody(p, token);\n      }\n\n      break;\n\n    case 6:\n      if (tn === $.CENTER || tn === $.FIGURE || tn === $.FOOTER || tn === $.HEADER || tn === $.HGROUP || tn === $.DIALOG) {\n        addressEndTagInBody(p, token);\n      } else if (tn === $.APPLET || tn === $.OBJECT) {\n        appletEndTagInBody(p, token);\n      } else if (tn === $.STRIKE || tn === $.STRONG) {\n        callAdoptionAgency(p, token);\n      } else {\n        genericEndTagInBody(p, token);\n      }\n\n      break;\n\n    case 7:\n      if (tn === $.ADDRESS || tn === $.ARTICLE || tn === $.DETAILS || tn === $.SECTION || tn === $.SUMMARY || tn === $.LISTING) {\n        addressEndTagInBody(p, token);\n      } else if (tn === $.MARQUEE) {\n        appletEndTagInBody(p, token);\n      } else {\n        genericEndTagInBody(p, token);\n      }\n\n      break;\n\n    case 8:\n      if (tn === $.FIELDSET) {\n        addressEndTagInBody(p, token);\n      } else if (tn === $.TEMPLATE) {\n        endTagInHead(p, token);\n      } else {\n        genericEndTagInBody(p, token);\n      }\n\n      break;\n\n    case 10:\n      if (tn === $.BLOCKQUOTE || tn === $.FIGCAPTION) {\n        addressEndTagInBody(p, token);\n      } else {\n        genericEndTagInBody(p, token);\n      }\n\n      break;\n\n    default:\n      genericEndTagInBody(p, token);\n  }\n}\n\nfunction eofInBody(p, token) {\n  if (p.tmplInsertionModeStackTop > -1) {\n    eofInTemplate(p, token);\n  } else {\n    p.stopped = true;\n  }\n} // The \"text\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction endTagInText(p, token) {\n  if (token.tagName === $.SCRIPT) {\n    p.pendingScript = p.openElements.current;\n  }\n\n  p.openElements.pop();\n  p.insertionMode = p.originalInsertionMode;\n}\n\nfunction eofInText(p, token) {\n  p._err(ERR.eofInElementThatCanContainOnlyText);\n\n  p.openElements.pop();\n  p.insertionMode = p.originalInsertionMode;\n\n  p._processToken(token);\n} // The \"in table\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction characterInTable(p, token) {\n  var curTn = p.openElements.currentTagName;\n\n  if (curTn === $.TABLE || curTn === $.TBODY || curTn === $.TFOOT || curTn === $.THEAD || curTn === $.TR) {\n    p.pendingCharacterTokens = [];\n    p.hasNonWhitespacePendingCharacterToken = false;\n    p.originalInsertionMode = p.insertionMode;\n    p.insertionMode = IN_TABLE_TEXT_MODE;\n\n    p._processToken(token);\n  } else {\n    tokenInTable(p, token);\n  }\n}\n\nfunction captionStartTagInTable(p, token) {\n  p.openElements.clearBackToTableContext();\n  p.activeFormattingElements.insertMarker();\n\n  p._insertElement(token, NS.HTML);\n\n  p.insertionMode = IN_CAPTION_MODE;\n}\n\nfunction colgroupStartTagInTable(p, token) {\n  p.openElements.clearBackToTableContext();\n\n  p._insertElement(token, NS.HTML);\n\n  p.insertionMode = IN_COLUMN_GROUP_MODE;\n}\n\nfunction colStartTagInTable(p, token) {\n  p.openElements.clearBackToTableContext();\n\n  p._insertFakeElement($.COLGROUP);\n\n  p.insertionMode = IN_COLUMN_GROUP_MODE;\n\n  p._processToken(token);\n}\n\nfunction tbodyStartTagInTable(p, token) {\n  p.openElements.clearBackToTableContext();\n\n  p._insertElement(token, NS.HTML);\n\n  p.insertionMode = IN_TABLE_BODY_MODE;\n}\n\nfunction tdStartTagInTable(p, token) {\n  p.openElements.clearBackToTableContext();\n\n  p._insertFakeElement($.TBODY);\n\n  p.insertionMode = IN_TABLE_BODY_MODE;\n\n  p._processToken(token);\n}\n\nfunction tableStartTagInTable(p, token) {\n  if (p.openElements.hasInTableScope($.TABLE)) {\n    p.openElements.popUntilTagNamePopped($.TABLE);\n\n    p._resetInsertionMode();\n\n    p._processToken(token);\n  }\n}\n\nfunction inputStartTagInTable(p, token) {\n  var inputType = Tokenizer.getTokenAttr(token, ATTRS.TYPE);\n\n  if (inputType && inputType.toLowerCase() === HIDDEN_INPUT_TYPE) {\n    p._appendElement(token, NS.HTML);\n  } else {\n    tokenInTable(p, token);\n  }\n\n  token.ackSelfClosing = true;\n}\n\nfunction formStartTagInTable(p, token) {\n  if (!p.formElement && p.openElements.tmplCount === 0) {\n    p._insertElement(token, NS.HTML);\n\n    p.formElement = p.openElements.current;\n    p.openElements.pop();\n  }\n}\n\nfunction startTagInTable(p, token) {\n  var tn = token.tagName;\n\n  switch (tn.length) {\n    case 2:\n      if (tn === $.TD || tn === $.TH || tn === $.TR) {\n        tdStartTagInTable(p, token);\n      } else {\n        tokenInTable(p, token);\n      }\n\n      break;\n\n    case 3:\n      if (tn === $.COL) {\n        colStartTagInTable(p, token);\n      } else {\n        tokenInTable(p, token);\n      }\n\n      break;\n\n    case 4:\n      if (tn === $.FORM) {\n        formStartTagInTable(p, token);\n      } else {\n        tokenInTable(p, token);\n      }\n\n      break;\n\n    case 5:\n      if (tn === $.TABLE) {\n        tableStartTagInTable(p, token);\n      } else if (tn === $.STYLE) {\n        startTagInHead(p, token);\n      } else if (tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD) {\n        tbodyStartTagInTable(p, token);\n      } else if (tn === $.INPUT) {\n        inputStartTagInTable(p, token);\n      } else {\n        tokenInTable(p, token);\n      }\n\n      break;\n\n    case 6:\n      if (tn === $.SCRIPT) {\n        startTagInHead(p, token);\n      } else {\n        tokenInTable(p, token);\n      }\n\n      break;\n\n    case 7:\n      if (tn === $.CAPTION) {\n        captionStartTagInTable(p, token);\n      } else {\n        tokenInTable(p, token);\n      }\n\n      break;\n\n    case 8:\n      if (tn === $.COLGROUP) {\n        colgroupStartTagInTable(p, token);\n      } else if (tn === $.TEMPLATE) {\n        startTagInHead(p, token);\n      } else {\n        tokenInTable(p, token);\n      }\n\n      break;\n\n    default:\n      tokenInTable(p, token);\n  }\n}\n\nfunction endTagInTable(p, token) {\n  var tn = token.tagName;\n\n  if (tn === $.TABLE) {\n    if (p.openElements.hasInTableScope($.TABLE)) {\n      p.openElements.popUntilTagNamePopped($.TABLE);\n\n      p._resetInsertionMode();\n    }\n  } else if (tn === $.TEMPLATE) {\n    endTagInHead(p, token);\n  } else if (tn !== $.BODY && tn !== $.CAPTION && tn !== $.COL && tn !== $.COLGROUP && tn !== $.HTML && tn !== $.TBODY && tn !== $.TD && tn !== $.TFOOT && tn !== $.TH && tn !== $.THEAD && tn !== $.TR) {\n    tokenInTable(p, token);\n  }\n}\n\nfunction tokenInTable(p, token) {\n  var savedFosterParentingState = p.fosterParentingEnabled;\n  p.fosterParentingEnabled = true;\n\n  p._processTokenInBodyMode(token);\n\n  p.fosterParentingEnabled = savedFosterParentingState;\n} // The \"in table text\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction whitespaceCharacterInTableText(p, token) {\n  p.pendingCharacterTokens.push(token);\n}\n\nfunction characterInTableText(p, token) {\n  p.pendingCharacterTokens.push(token);\n  p.hasNonWhitespacePendingCharacterToken = true;\n}\n\nfunction tokenInTableText(p, token) {\n  var i = 0;\n\n  if (p.hasNonWhitespacePendingCharacterToken) {\n    for (; i < p.pendingCharacterTokens.length; i++) {\n      tokenInTable(p, p.pendingCharacterTokens[i]);\n    }\n  } else {\n    for (; i < p.pendingCharacterTokens.length; i++) {\n      p._insertCharacters(p.pendingCharacterTokens[i]);\n    }\n  }\n\n  p.insertionMode = p.originalInsertionMode;\n\n  p._processToken(token);\n} // The \"in caption\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagInCaption(p, token) {\n  var tn = token.tagName;\n\n  if (tn === $.CAPTION || tn === $.COL || tn === $.COLGROUP || tn === $.TBODY || tn === $.TD || tn === $.TFOOT || tn === $.TH || tn === $.THEAD || tn === $.TR) {\n    if (p.openElements.hasInTableScope($.CAPTION)) {\n      p.openElements.generateImpliedEndTags();\n      p.openElements.popUntilTagNamePopped($.CAPTION);\n      p.activeFormattingElements.clearToLastMarker();\n      p.insertionMode = IN_TABLE_MODE;\n\n      p._processToken(token);\n    }\n  } else {\n    startTagInBody(p, token);\n  }\n}\n\nfunction endTagInCaption(p, token) {\n  var tn = token.tagName;\n\n  if (tn === $.CAPTION || tn === $.TABLE) {\n    if (p.openElements.hasInTableScope($.CAPTION)) {\n      p.openElements.generateImpliedEndTags();\n      p.openElements.popUntilTagNamePopped($.CAPTION);\n      p.activeFormattingElements.clearToLastMarker();\n      p.insertionMode = IN_TABLE_MODE;\n\n      if (tn === $.TABLE) {\n        p._processToken(token);\n      }\n    }\n  } else if (tn !== $.BODY && tn !== $.COL && tn !== $.COLGROUP && tn !== $.HTML && tn !== $.TBODY && tn !== $.TD && tn !== $.TFOOT && tn !== $.TH && tn !== $.THEAD && tn !== $.TR) {\n    endTagInBody(p, token);\n  }\n} // The \"in column group\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagInColumnGroup(p, token) {\n  var tn = token.tagName;\n\n  if (tn === $.HTML) {\n    startTagInBody(p, token);\n  } else if (tn === $.COL) {\n    p._appendElement(token, NS.HTML);\n\n    token.ackSelfClosing = true;\n  } else if (tn === $.TEMPLATE) {\n    startTagInHead(p, token);\n  } else {\n    tokenInColumnGroup(p, token);\n  }\n}\n\nfunction endTagInColumnGroup(p, token) {\n  var tn = token.tagName;\n\n  if (tn === $.COLGROUP) {\n    if (p.openElements.currentTagName === $.COLGROUP) {\n      p.openElements.pop();\n      p.insertionMode = IN_TABLE_MODE;\n    }\n  } else if (tn === $.TEMPLATE) {\n    endTagInHead(p, token);\n  } else if (tn !== $.COL) {\n    tokenInColumnGroup(p, token);\n  }\n}\n\nfunction tokenInColumnGroup(p, token) {\n  if (p.openElements.currentTagName === $.COLGROUP) {\n    p.openElements.pop();\n    p.insertionMode = IN_TABLE_MODE;\n\n    p._processToken(token);\n  }\n} // The \"in table body\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagInTableBody(p, token) {\n  var tn = token.tagName;\n\n  if (tn === $.TR) {\n    p.openElements.clearBackToTableBodyContext();\n\n    p._insertElement(token, NS.HTML);\n\n    p.insertionMode = IN_ROW_MODE;\n  } else if (tn === $.TH || tn === $.TD) {\n    p.openElements.clearBackToTableBodyContext();\n\n    p._insertFakeElement($.TR);\n\n    p.insertionMode = IN_ROW_MODE;\n\n    p._processToken(token);\n  } else if (tn === $.CAPTION || tn === $.COL || tn === $.COLGROUP || tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD) {\n    if (p.openElements.hasTableBodyContextInTableScope()) {\n      p.openElements.clearBackToTableBodyContext();\n      p.openElements.pop();\n      p.insertionMode = IN_TABLE_MODE;\n\n      p._processToken(token);\n    }\n  } else {\n    startTagInTable(p, token);\n  }\n}\n\nfunction endTagInTableBody(p, token) {\n  var tn = token.tagName;\n\n  if (tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD) {\n    if (p.openElements.hasInTableScope(tn)) {\n      p.openElements.clearBackToTableBodyContext();\n      p.openElements.pop();\n      p.insertionMode = IN_TABLE_MODE;\n    }\n  } else if (tn === $.TABLE) {\n    if (p.openElements.hasTableBodyContextInTableScope()) {\n      p.openElements.clearBackToTableBodyContext();\n      p.openElements.pop();\n      p.insertionMode = IN_TABLE_MODE;\n\n      p._processToken(token);\n    }\n  } else if (tn !== $.BODY && tn !== $.CAPTION && tn !== $.COL && tn !== $.COLGROUP || tn !== $.HTML && tn !== $.TD && tn !== $.TH && tn !== $.TR) {\n    endTagInTable(p, token);\n  }\n} // The \"in row\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagInRow(p, token) {\n  var tn = token.tagName;\n\n  if (tn === $.TH || tn === $.TD) {\n    p.openElements.clearBackToTableRowContext();\n\n    p._insertElement(token, NS.HTML);\n\n    p.insertionMode = IN_CELL_MODE;\n    p.activeFormattingElements.insertMarker();\n  } else if (tn === $.CAPTION || tn === $.COL || tn === $.COLGROUP || tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD || tn === $.TR) {\n    if (p.openElements.hasInTableScope($.TR)) {\n      p.openElements.clearBackToTableRowContext();\n      p.openElements.pop();\n      p.insertionMode = IN_TABLE_BODY_MODE;\n\n      p._processToken(token);\n    }\n  } else {\n    startTagInTable(p, token);\n  }\n}\n\nfunction endTagInRow(p, token) {\n  var tn = token.tagName;\n\n  if (tn === $.TR) {\n    if (p.openElements.hasInTableScope($.TR)) {\n      p.openElements.clearBackToTableRowContext();\n      p.openElements.pop();\n      p.insertionMode = IN_TABLE_BODY_MODE;\n    }\n  } else if (tn === $.TABLE) {\n    if (p.openElements.hasInTableScope($.TR)) {\n      p.openElements.clearBackToTableRowContext();\n      p.openElements.pop();\n      p.insertionMode = IN_TABLE_BODY_MODE;\n\n      p._processToken(token);\n    }\n  } else if (tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD) {\n    if (p.openElements.hasInTableScope(tn) || p.openElements.hasInTableScope($.TR)) {\n      p.openElements.clearBackToTableRowContext();\n      p.openElements.pop();\n      p.insertionMode = IN_TABLE_BODY_MODE;\n\n      p._processToken(token);\n    }\n  } else if (tn !== $.BODY && tn !== $.CAPTION && tn !== $.COL && tn !== $.COLGROUP || tn !== $.HTML && tn !== $.TD && tn !== $.TH) {\n    endTagInTable(p, token);\n  }\n} // The \"in cell\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagInCell(p, token) {\n  var tn = token.tagName;\n\n  if (tn === $.CAPTION || tn === $.COL || tn === $.COLGROUP || tn === $.TBODY || tn === $.TD || tn === $.TFOOT || tn === $.TH || tn === $.THEAD || tn === $.TR) {\n    if (p.openElements.hasInTableScope($.TD) || p.openElements.hasInTableScope($.TH)) {\n      p._closeTableCell();\n\n      p._processToken(token);\n    }\n  } else {\n    startTagInBody(p, token);\n  }\n}\n\nfunction endTagInCell(p, token) {\n  var tn = token.tagName;\n\n  if (tn === $.TD || tn === $.TH) {\n    if (p.openElements.hasInTableScope(tn)) {\n      p.openElements.generateImpliedEndTags();\n      p.openElements.popUntilTagNamePopped(tn);\n      p.activeFormattingElements.clearToLastMarker();\n      p.insertionMode = IN_ROW_MODE;\n    }\n  } else if (tn === $.TABLE || tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD || tn === $.TR) {\n    if (p.openElements.hasInTableScope(tn)) {\n      p._closeTableCell();\n\n      p._processToken(token);\n    }\n  } else if (tn !== $.BODY && tn !== $.CAPTION && tn !== $.COL && tn !== $.COLGROUP && tn !== $.HTML) {\n    endTagInBody(p, token);\n  }\n} // The \"in select\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagInSelect(p, token) {\n  var tn = token.tagName;\n\n  if (tn === $.HTML) {\n    startTagInBody(p, token);\n  } else if (tn === $.OPTION) {\n    if (p.openElements.currentTagName === $.OPTION) {\n      p.openElements.pop();\n    }\n\n    p._insertElement(token, NS.HTML);\n  } else if (tn === $.OPTGROUP) {\n    if (p.openElements.currentTagName === $.OPTION) {\n      p.openElements.pop();\n    }\n\n    if (p.openElements.currentTagName === $.OPTGROUP) {\n      p.openElements.pop();\n    }\n\n    p._insertElement(token, NS.HTML);\n  } else if (tn === $.INPUT || tn === $.KEYGEN || tn === $.TEXTAREA || tn === $.SELECT) {\n    if (p.openElements.hasInSelectScope($.SELECT)) {\n      p.openElements.popUntilTagNamePopped($.SELECT);\n\n      p._resetInsertionMode();\n\n      if (tn !== $.SELECT) {\n        p._processToken(token);\n      }\n    }\n  } else if (tn === $.SCRIPT || tn === $.TEMPLATE) {\n    startTagInHead(p, token);\n  }\n}\n\nfunction endTagInSelect(p, token) {\n  var tn = token.tagName;\n\n  if (tn === $.OPTGROUP) {\n    var prevOpenElement = p.openElements.items[p.openElements.stackTop - 1];\n    var prevOpenElementTn = prevOpenElement && p.treeAdapter.getTagName(prevOpenElement);\n\n    if (p.openElements.currentTagName === $.OPTION && prevOpenElementTn === $.OPTGROUP) {\n      p.openElements.pop();\n    }\n\n    if (p.openElements.currentTagName === $.OPTGROUP) {\n      p.openElements.pop();\n    }\n  } else if (tn === $.OPTION) {\n    if (p.openElements.currentTagName === $.OPTION) {\n      p.openElements.pop();\n    }\n  } else if (tn === $.SELECT && p.openElements.hasInSelectScope($.SELECT)) {\n    p.openElements.popUntilTagNamePopped($.SELECT);\n\n    p._resetInsertionMode();\n  } else if (tn === $.TEMPLATE) {\n    endTagInHead(p, token);\n  }\n} //12.2.5.4.17 The \"in select in table\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagInSelectInTable(p, token) {\n  var tn = token.tagName;\n\n  if (tn === $.CAPTION || tn === $.TABLE || tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD || tn === $.TR || tn === $.TD || tn === $.TH) {\n    p.openElements.popUntilTagNamePopped($.SELECT);\n\n    p._resetInsertionMode();\n\n    p._processToken(token);\n  } else {\n    startTagInSelect(p, token);\n  }\n}\n\nfunction endTagInSelectInTable(p, token) {\n  var tn = token.tagName;\n\n  if (tn === $.CAPTION || tn === $.TABLE || tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD || tn === $.TR || tn === $.TD || tn === $.TH) {\n    if (p.openElements.hasInTableScope(tn)) {\n      p.openElements.popUntilTagNamePopped($.SELECT);\n\n      p._resetInsertionMode();\n\n      p._processToken(token);\n    }\n  } else {\n    endTagInSelect(p, token);\n  }\n} // The \"in template\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagInTemplate(p, token) {\n  var tn = token.tagName;\n\n  if (tn === $.BASE || tn === $.BASEFONT || tn === $.BGSOUND || tn === $.LINK || tn === $.META || tn === $.NOFRAMES || tn === $.SCRIPT || tn === $.STYLE || tn === $.TEMPLATE || tn === $.TITLE) {\n    startTagInHead(p, token);\n  } else {\n    var newInsertionMode = TEMPLATE_INSERTION_MODE_SWITCH_MAP[tn] || IN_BODY_MODE;\n\n    p._popTmplInsertionMode();\n\n    p._pushTmplInsertionMode(newInsertionMode);\n\n    p.insertionMode = newInsertionMode;\n\n    p._processToken(token);\n  }\n}\n\nfunction endTagInTemplate(p, token) {\n  if (token.tagName === $.TEMPLATE) {\n    endTagInHead(p, token);\n  }\n}\n\nfunction eofInTemplate(p, token) {\n  if (p.openElements.tmplCount > 0) {\n    p.openElements.popUntilTagNamePopped($.TEMPLATE);\n    p.activeFormattingElements.clearToLastMarker();\n\n    p._popTmplInsertionMode();\n\n    p._resetInsertionMode();\n\n    p._processToken(token);\n  } else {\n    p.stopped = true;\n  }\n} // The \"after body\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagAfterBody(p, token) {\n  if (token.tagName === $.HTML) {\n    startTagInBody(p, token);\n  } else {\n    tokenAfterBody(p, token);\n  }\n}\n\nfunction endTagAfterBody(p, token) {\n  if (token.tagName === $.HTML) {\n    if (!p.fragmentContext) {\n      p.insertionMode = AFTER_AFTER_BODY_MODE;\n    }\n  } else {\n    tokenAfterBody(p, token);\n  }\n}\n\nfunction tokenAfterBody(p, token) {\n  p.insertionMode = IN_BODY_MODE;\n\n  p._processToken(token);\n} // The \"in frameset\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagInFrameset(p, token) {\n  var tn = token.tagName;\n\n  if (tn === $.HTML) {\n    startTagInBody(p, token);\n  } else if (tn === $.FRAMESET) {\n    p._insertElement(token, NS.HTML);\n  } else if (tn === $.FRAME) {\n    p._appendElement(token, NS.HTML);\n\n    token.ackSelfClosing = true;\n  } else if (tn === $.NOFRAMES) {\n    startTagInHead(p, token);\n  }\n}\n\nfunction endTagInFrameset(p, token) {\n  if (token.tagName === $.FRAMESET && !p.openElements.isRootHtmlElementCurrent()) {\n    p.openElements.pop();\n\n    if (!p.fragmentContext && p.openElements.currentTagName !== $.FRAMESET) {\n      p.insertionMode = AFTER_FRAMESET_MODE;\n    }\n  }\n} // The \"after frameset\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagAfterFrameset(p, token) {\n  var tn = token.tagName;\n\n  if (tn === $.HTML) {\n    startTagInBody(p, token);\n  } else if (tn === $.NOFRAMES) {\n    startTagInHead(p, token);\n  }\n}\n\nfunction endTagAfterFrameset(p, token) {\n  if (token.tagName === $.HTML) {\n    p.insertionMode = AFTER_AFTER_FRAMESET_MODE;\n  }\n} // The \"after after body\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagAfterAfterBody(p, token) {\n  if (token.tagName === $.HTML) {\n    startTagInBody(p, token);\n  } else {\n    tokenAfterAfterBody(p, token);\n  }\n}\n\nfunction tokenAfterAfterBody(p, token) {\n  p.insertionMode = IN_BODY_MODE;\n\n  p._processToken(token);\n} // The \"after after frameset\" insertion mode\n//------------------------------------------------------------------\n\n\nfunction startTagAfterAfterFrameset(p, token) {\n  var tn = token.tagName;\n\n  if (tn === $.HTML) {\n    startTagInBody(p, token);\n  } else if (tn === $.NOFRAMES) {\n    startTagInHead(p, token);\n  }\n} // The rules for parsing tokens in foreign content\n//------------------------------------------------------------------\n\n\nfunction nullCharacterInForeignContent(p, token) {\n  token.chars = unicode.REPLACEMENT_CHARACTER;\n\n  p._insertCharacters(token);\n}\n\nfunction characterInForeignContent(p, token) {\n  p._insertCharacters(token);\n\n  p.framesetOk = false;\n}\n\nfunction startTagInForeignContent(p, token) {\n  if (foreignContent.causesExit(token) && !p.fragmentContext) {\n    while (p.treeAdapter.getNamespaceURI(p.openElements.current) !== NS.HTML && !p._isIntegrationPoint(p.openElements.current)) {\n      p.openElements.pop();\n    }\n\n    p._processToken(token);\n  } else {\n    var current = p._getAdjustedCurrentElement();\n\n    var currentNs = p.treeAdapter.getNamespaceURI(current);\n\n    if (currentNs === NS.MATHML) {\n      foreignContent.adjustTokenMathMLAttrs(token);\n    } else if (currentNs === NS.SVG) {\n      foreignContent.adjustTokenSVGTagName(token);\n      foreignContent.adjustTokenSVGAttrs(token);\n    }\n\n    foreignContent.adjustTokenXMLAttrs(token);\n\n    if (token.selfClosing) {\n      p._appendElement(token, currentNs);\n    } else {\n      p._insertElement(token, currentNs);\n    }\n\n    token.ackSelfClosing = true;\n  }\n}\n\nfunction endTagInForeignContent(p, token) {\n  for (var i = p.openElements.stackTop; i > 0; i--) {\n    var element = p.openElements.items[i];\n\n    if (p.treeAdapter.getNamespaceURI(element) === NS.HTML) {\n      p._processToken(token);\n\n      break;\n    }\n\n    if (p.treeAdapter.getTagName(element).toLowerCase() === token.tagName) {\n      p.openElements.popUntilElementPopped(element);\n      break;\n    }\n  }\n}","map":{"version":3,"names":["Tokenizer","require","OpenElementStack","FormattingElementList","LocationInfoParserMixin","ErrorReportingParserMixin","Mixin","defaultTreeAdapter","mergeOptions","doctype","foreignContent","ERR","unicode","HTML","$","TAG_NAMES","NS","NAMESPACES","ATTRS","DEFAULT_OPTIONS","scriptingEnabled","sourceCodeLocationInfo","onParseError","treeAdapter","HIDDEN_INPUT_TYPE","AA_OUTER_LOOP_ITER","AA_INNER_LOOP_ITER","INITIAL_MODE","BEFORE_HTML_MODE","BEFORE_HEAD_MODE","IN_HEAD_MODE","IN_HEAD_NO_SCRIPT_MODE","AFTER_HEAD_MODE","IN_BODY_MODE","TEXT_MODE","IN_TABLE_MODE","IN_TABLE_TEXT_MODE","IN_CAPTION_MODE","IN_COLUMN_GROUP_MODE","IN_TABLE_BODY_MODE","IN_ROW_MODE","IN_CELL_MODE","IN_SELECT_MODE","IN_SELECT_IN_TABLE_MODE","IN_TEMPLATE_MODE","AFTER_BODY_MODE","IN_FRAMESET_MODE","AFTER_FRAMESET_MODE","AFTER_AFTER_BODY_MODE","AFTER_AFTER_FRAMESET_MODE","INSERTION_MODE_RESET_MAP","TR","TBODY","THEAD","TFOOT","CAPTION","COLGROUP","TABLE","BODY","FRAMESET","TEMPLATE_INSERTION_MODE_SWITCH_MAP","COL","TD","TH","TOKEN_HANDLERS","CHARACTER_TOKEN","tokenInInitialMode","NULL_CHARACTER_TOKEN","WHITESPACE_CHARACTER_TOKEN","ignoreToken","COMMENT_TOKEN","appendComment","DOCTYPE_TOKEN","doctypeInInitialMode","START_TAG_TOKEN","END_TAG_TOKEN","EOF_TOKEN","tokenBeforeHtml","startTagBeforeHtml","endTagBeforeHtml","tokenBeforeHead","misplacedDoctype","startTagBeforeHead","endTagBeforeHead","tokenInHead","insertCharacters","startTagInHead","endTagInHead","tokenInHeadNoScript","startTagInHeadNoScript","endTagInHeadNoScript","tokenAfterHead","startTagAfterHead","endTagAfterHead","characterInBody","whitespaceCharacterInBody","startTagInBody","endTagInBody","eofInBody","endTagInText","eofInText","characterInTable","startTagInTable","endTagInTable","characterInTableText","whitespaceCharacterInTableText","tokenInTableText","startTagInCaption","endTagInCaption","tokenInColumnGroup","startTagInColumnGroup","endTagInColumnGroup","startTagInTableBody","endTagInTableBody","startTagInRow","endTagInRow","startTagInCell","endTagInCell","startTagInSelect","endTagInSelect","startTagInSelectInTable","endTagInSelectInTable","startTagInTemplate","endTagInTemplate","eofInTemplate","tokenAfterBody","appendCommentToRootHtmlElement","startTagAfterBody","endTagAfterBody","stopParsing","startTagInFrameset","endTagInFrameset","startTagAfterFrameset","endTagAfterFrameset","tokenAfterAfterBody","appendCommentToDocument","startTagAfterAfterBody","startTagAfterAfterFrameset","Parser","options","pendingScript","install","html","document","createDocument","_bootstrap","tokenizer","write","_runParsingLoop","fragmentContext","createElement","TEMPLATE","documentMock","getTagName","_pushTmplInsertionMode","_initTokenizerForFragmentParsing","_insertFakeRootElement","_resetInsertionMode","_findFormInFragmentContext","rootElement","getFirstChild","fragment","createDocumentFragment","_adoptNodes","stopped","insertionMode","originalInsertionMode","headElement","formElement","openElements","activeFormattingElements","tmplInsertionModeStack","tmplInsertionModeStackTop","currentTmplInsertionMode","pendingCharacterTokens","hasNonWhitespacePendingCharacterToken","framesetOk","skipNextNewLine","fosterParentingEnabled","scriptHandler","_setupTokenizerCDATAMode","token","getNextToken","type","HIBERNATION_TOKEN","chars","length","substr","_processInputToken","writeCallback","script","current","_getAdjustedCurrentElement","allowCDATA","getNamespaceURI","_isIntegrationPoint","currentToken","nextTokenizerState","_insertElement","state","MODE","PLAINTEXT","stackTop","node","FORM","getParentNode","tn","TITLE","TEXTAREA","RCDATA","STYLE","XMP","IFRAME","NOEMBED","NOFRAMES","NOSCRIPT","RAWTEXT","SCRIPT","SCRIPT_DATA","name","publicId","systemId","setDocumentType","element","_shouldFosterParentOnInsertion","_fosterParentElement","parent","currentTmplContent","appendChild","namespaceURI","tagName","attrs","_attachElementToTree","push","tmpl","content","setTemplateContent","commentNode","createCommentNode","data","_fosterParentText","insertText","donor","recipient","child","detachNode","ns","ANNOTATION_XML","MATHML","SVG","isCharacterToken","isMathMLTextStartTag","MGLYPH","MALIGNMARK","characterInForeignContent","nullCharacterInForeignContent","startTagInForeignContent","endTagInForeignContent","_shouldProcessTokenInForeignContent","_processTokenInForeignContent","_processToken","selfClosing","ackSelfClosing","_err","nonVoidHtmlElementStartTagWithTrailingSolidus","foreignNS","getAttrList","isIntegrationPoint","listLength","unopenIdx","entry","entries","MARKER_ENTRY","contains","i","generateImpliedEndTags","popUntilTableCellPopped","clearToLastMarker","generateImpliedEndTagsWithExclusion","P","popUntilTagNamePopped","last","items","newInsertionMode","HEAD","SELECT","_resetInsertionModeForSelect","selectIdx","ancestor","mode","pop","_isElementCausesFosterParenting","location","beforeElement","openElement","getTemplateContent","_findFosterParentingLocation","insertBefore","insertTextBefore","SPECIAL_ELEMENTS","module","exports","aaObtainFormattingElementEntry","p","formattingElementEntry","getElementEntryInScopeWithTagName","removeEntry","hasInScope","genericEndTagInBody","aaObtainFurthestBlock","furthestBlock","_isSpecialElement","popUntilElementPopped","aaInnerLoop","formattingElement","lastElement","nextElement","getCommonAncestor","elementEntry","getElementEntry","counterOverflow","shouldRemoveFromOpenElements","remove","aaRecreateElementFromEntry","bookmark","newElement","replace","aaInsertLastNodeInCommonAncestor","commonAncestor","aaReplaceFormattingElement","insertElementAfterBookmark","insertAfter","callAdoptionAgency","_appendCommentNode","_insertCharacters","_setDocumentType","forceQuirks","DOCUMENT_MODE","QUIRKS","getDocumentMode","isConforming","nonConformingDoctype","setDocumentMode","missingDoctype","beforeToken","BR","endTagWithoutMatchingOpenElement","_insertFakeElement","BASE","BASEFONT","BGSOUND","LINK","META","_appendElement","_switchToTextParsing","_insertTemplate","insertMarker","misplacedStartTagForHeadElement","tmplCount","generateImpliedEndTagsThoroughly","currentTagName","closingOfElementWithOpenChildElements","_popTmplInsertionMode","nestedNoscriptInHead","errCode","openElementsLeftAfterEof","disallowedContentInNoscriptInHead","abandonedHeadElementChild","_reconstructActiveFormattingElements","htmlStartTagInBody","adoptAttributes","bodyStartTagInBody","bodyElement","tryPeekProperlyNestedBodyElement","framesetStartTagInBody","popAllUpToHtmlElement","addressStartTagInBody","hasInButtonScope","_closePElement","numberedHeaderStartTagInBody","H1","H2","H3","H4","H5","H6","preStartTagInBody","formStartTagInBody","inTemplate","listItemStartTagInBody","elementTn","closeTn","LI","DD","DT","ADDRESS","DIV","plaintextStartTagInBody","buttonStartTagInBody","BUTTON","aStartTagInBody","activeElementEntry","A","pushElement","bStartTagInBody","nobrStartTagInBody","NOBR","appletStartTagInBody","tableStartTagInBody","areaStartTagInBody","inputStartTagInBody","inputType","getTokenAttr","TYPE","toLowerCase","paramStartTagInBody","hrStartTagInBody","imageStartTagInBody","IMG","textareaStartTagInBody","xmpStartTagInBody","iframeStartTagInBody","noembedStartTagInBody","selectStartTagInBody","optgroupStartTagInBody","OPTION","rbStartTagInBody","RUBY","rtStartTagInBody","RTC","menuStartTagInBody","mathStartTagInBody","adjustTokenMathMLAttrs","adjustTokenXMLAttrs","svgStartTagInBody","adjustTokenSVGAttrs","genericStartTagInBody","I","S","B","U","DL","OL","UL","EM","TT","HR","RB","RT","RP","DIR","NAV","PRE","BIG","WBR","MAIN","MENU","CODE","FONT","AREA","MATH","ASIDE","SMALL","EMBED","INPUT","PARAM","TRACK","IMAGE","FRAME","CENTER","FIGURE","FOOTER","HEADER","HGROUP","DIALOG","STRIKE","STRONG","APPLET","OBJECT","KEYGEN","SOURCE","DETAILS","ARTICLE","SECTION","SUMMARY","LISTING","MARQUEE","FIELDSET","OPTGROUP","BLOCKQUOTE","FIGCAPTION","bodyEndTagInBody","htmlEndTagInBody","addressEndTagInBody","formEndTagInBody","pEndTagInBody","liEndTagInBody","hasInListItemScope","ddEndTagInBody","numberedHeaderEndTagInBody","hasNumberedHeaderInScope","popUntilNumberedHeaderPopped","appletEndTagInBody","brEndTagInBody","eofInElementThatCanContainOnlyText","curTn","tokenInTable","captionStartTagInTable","clearBackToTableContext","colgroupStartTagInTable","colStartTagInTable","tbodyStartTagInTable","tdStartTagInTable","tableStartTagInTable","hasInTableScope","inputStartTagInTable","formStartTagInTable","savedFosterParentingState","_processTokenInBodyMode","clearBackToTableBodyContext","hasTableBodyContextInTableScope","clearBackToTableRowContext","_closeTableCell","hasInSelectScope","prevOpenElement","prevOpenElementTn","isRootHtmlElementCurrent","REPLACEMENT_CHARACTER","causesExit","currentNs","adjustTokenSVGTagName"],"sources":["D:/web/silly/silly/node_modules/parse5/lib/parser/index.js"],"sourcesContent":["'use strict';\n\nconst Tokenizer = require('../tokenizer');\nconst OpenElementStack = require('./open-element-stack');\nconst FormattingElementList = require('./formatting-element-list');\nconst LocationInfoParserMixin = require('../extensions/location-info/parser-mixin');\nconst ErrorReportingParserMixin = require('../extensions/error-reporting/parser-mixin');\nconst Mixin = require('../utils/mixin');\nconst defaultTreeAdapter = require('../tree-adapters/default');\nconst mergeOptions = require('../utils/merge-options');\nconst doctype = require('../common/doctype');\nconst foreignContent = require('../common/foreign-content');\nconst ERR = require('../common/error-codes');\nconst unicode = require('../common/unicode');\nconst HTML = require('../common/html');\n\n//Aliases\nconst $ = HTML.TAG_NAMES;\nconst NS = HTML.NAMESPACES;\nconst ATTRS = HTML.ATTRS;\n\nconst DEFAULT_OPTIONS = {\n    scriptingEnabled: true,\n    sourceCodeLocationInfo: false,\n    onParseError: null,\n    treeAdapter: defaultTreeAdapter\n};\n\n//Misc constants\nconst HIDDEN_INPUT_TYPE = 'hidden';\n\n//Adoption agency loops iteration count\nconst AA_OUTER_LOOP_ITER = 8;\nconst AA_INNER_LOOP_ITER = 3;\n\n//Insertion modes\nconst INITIAL_MODE = 'INITIAL_MODE';\nconst BEFORE_HTML_MODE = 'BEFORE_HTML_MODE';\nconst BEFORE_HEAD_MODE = 'BEFORE_HEAD_MODE';\nconst IN_HEAD_MODE = 'IN_HEAD_MODE';\nconst IN_HEAD_NO_SCRIPT_MODE = 'IN_HEAD_NO_SCRIPT_MODE';\nconst AFTER_HEAD_MODE = 'AFTER_HEAD_MODE';\nconst IN_BODY_MODE = 'IN_BODY_MODE';\nconst TEXT_MODE = 'TEXT_MODE';\nconst IN_TABLE_MODE = 'IN_TABLE_MODE';\nconst IN_TABLE_TEXT_MODE = 'IN_TABLE_TEXT_MODE';\nconst IN_CAPTION_MODE = 'IN_CAPTION_MODE';\nconst IN_COLUMN_GROUP_MODE = 'IN_COLUMN_GROUP_MODE';\nconst IN_TABLE_BODY_MODE = 'IN_TABLE_BODY_MODE';\nconst IN_ROW_MODE = 'IN_ROW_MODE';\nconst IN_CELL_MODE = 'IN_CELL_MODE';\nconst IN_SELECT_MODE = 'IN_SELECT_MODE';\nconst IN_SELECT_IN_TABLE_MODE = 'IN_SELECT_IN_TABLE_MODE';\nconst IN_TEMPLATE_MODE = 'IN_TEMPLATE_MODE';\nconst AFTER_BODY_MODE = 'AFTER_BODY_MODE';\nconst IN_FRAMESET_MODE = 'IN_FRAMESET_MODE';\nconst AFTER_FRAMESET_MODE = 'AFTER_FRAMESET_MODE';\nconst AFTER_AFTER_BODY_MODE = 'AFTER_AFTER_BODY_MODE';\nconst AFTER_AFTER_FRAMESET_MODE = 'AFTER_AFTER_FRAMESET_MODE';\n\n//Insertion mode reset map\nconst INSERTION_MODE_RESET_MAP = {\n    [$.TR]: IN_ROW_MODE,\n    [$.TBODY]: IN_TABLE_BODY_MODE,\n    [$.THEAD]: IN_TABLE_BODY_MODE,\n    [$.TFOOT]: IN_TABLE_BODY_MODE,\n    [$.CAPTION]: IN_CAPTION_MODE,\n    [$.COLGROUP]: IN_COLUMN_GROUP_MODE,\n    [$.TABLE]: IN_TABLE_MODE,\n    [$.BODY]: IN_BODY_MODE,\n    [$.FRAMESET]: IN_FRAMESET_MODE\n};\n\n//Template insertion mode switch map\nconst TEMPLATE_INSERTION_MODE_SWITCH_MAP = {\n    [$.CAPTION]: IN_TABLE_MODE,\n    [$.COLGROUP]: IN_TABLE_MODE,\n    [$.TBODY]: IN_TABLE_MODE,\n    [$.TFOOT]: IN_TABLE_MODE,\n    [$.THEAD]: IN_TABLE_MODE,\n    [$.COL]: IN_COLUMN_GROUP_MODE,\n    [$.TR]: IN_TABLE_BODY_MODE,\n    [$.TD]: IN_ROW_MODE,\n    [$.TH]: IN_ROW_MODE\n};\n\n//Token handlers map for insertion modes\nconst TOKEN_HANDLERS = {\n    [INITIAL_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: tokenInInitialMode,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: tokenInInitialMode,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: doctypeInInitialMode,\n        [Tokenizer.START_TAG_TOKEN]: tokenInInitialMode,\n        [Tokenizer.END_TAG_TOKEN]: tokenInInitialMode,\n        [Tokenizer.EOF_TOKEN]: tokenInInitialMode\n    },\n    [BEFORE_HTML_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: tokenBeforeHtml,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: tokenBeforeHtml,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagBeforeHtml,\n        [Tokenizer.END_TAG_TOKEN]: endTagBeforeHtml,\n        [Tokenizer.EOF_TOKEN]: tokenBeforeHtml\n    },\n    [BEFORE_HEAD_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: tokenBeforeHead,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: tokenBeforeHead,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: misplacedDoctype,\n        [Tokenizer.START_TAG_TOKEN]: startTagBeforeHead,\n        [Tokenizer.END_TAG_TOKEN]: endTagBeforeHead,\n        [Tokenizer.EOF_TOKEN]: tokenBeforeHead\n    },\n    [IN_HEAD_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: tokenInHead,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: tokenInHead,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: misplacedDoctype,\n        [Tokenizer.START_TAG_TOKEN]: startTagInHead,\n        [Tokenizer.END_TAG_TOKEN]: endTagInHead,\n        [Tokenizer.EOF_TOKEN]: tokenInHead\n    },\n    [IN_HEAD_NO_SCRIPT_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: tokenInHeadNoScript,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: tokenInHeadNoScript,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: misplacedDoctype,\n        [Tokenizer.START_TAG_TOKEN]: startTagInHeadNoScript,\n        [Tokenizer.END_TAG_TOKEN]: endTagInHeadNoScript,\n        [Tokenizer.EOF_TOKEN]: tokenInHeadNoScript\n    },\n    [AFTER_HEAD_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: tokenAfterHead,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: tokenAfterHead,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: misplacedDoctype,\n        [Tokenizer.START_TAG_TOKEN]: startTagAfterHead,\n        [Tokenizer.END_TAG_TOKEN]: endTagAfterHead,\n        [Tokenizer.EOF_TOKEN]: tokenAfterHead\n    },\n    [IN_BODY_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: characterInBody,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagInBody,\n        [Tokenizer.END_TAG_TOKEN]: endTagInBody,\n        [Tokenizer.EOF_TOKEN]: eofInBody\n    },\n    [TEXT_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.COMMENT_TOKEN]: ignoreToken,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: ignoreToken,\n        [Tokenizer.END_TAG_TOKEN]: endTagInText,\n        [Tokenizer.EOF_TOKEN]: eofInText\n    },\n    [IN_TABLE_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: characterInTable,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: characterInTable,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: characterInTable,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagInTable,\n        [Tokenizer.END_TAG_TOKEN]: endTagInTable,\n        [Tokenizer.EOF_TOKEN]: eofInBody\n    },\n    [IN_TABLE_TEXT_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: characterInTableText,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInTableText,\n        [Tokenizer.COMMENT_TOKEN]: tokenInTableText,\n        [Tokenizer.DOCTYPE_TOKEN]: tokenInTableText,\n        [Tokenizer.START_TAG_TOKEN]: tokenInTableText,\n        [Tokenizer.END_TAG_TOKEN]: tokenInTableText,\n        [Tokenizer.EOF_TOKEN]: tokenInTableText\n    },\n    [IN_CAPTION_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: characterInBody,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagInCaption,\n        [Tokenizer.END_TAG_TOKEN]: endTagInCaption,\n        [Tokenizer.EOF_TOKEN]: eofInBody\n    },\n    [IN_COLUMN_GROUP_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: tokenInColumnGroup,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: tokenInColumnGroup,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagInColumnGroup,\n        [Tokenizer.END_TAG_TOKEN]: endTagInColumnGroup,\n        [Tokenizer.EOF_TOKEN]: eofInBody\n    },\n    [IN_TABLE_BODY_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: characterInTable,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: characterInTable,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: characterInTable,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagInTableBody,\n        [Tokenizer.END_TAG_TOKEN]: endTagInTableBody,\n        [Tokenizer.EOF_TOKEN]: eofInBody\n    },\n    [IN_ROW_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: characterInTable,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: characterInTable,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: characterInTable,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagInRow,\n        [Tokenizer.END_TAG_TOKEN]: endTagInRow,\n        [Tokenizer.EOF_TOKEN]: eofInBody\n    },\n    [IN_CELL_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: characterInBody,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagInCell,\n        [Tokenizer.END_TAG_TOKEN]: endTagInCell,\n        [Tokenizer.EOF_TOKEN]: eofInBody\n    },\n    [IN_SELECT_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagInSelect,\n        [Tokenizer.END_TAG_TOKEN]: endTagInSelect,\n        [Tokenizer.EOF_TOKEN]: eofInBody\n    },\n    [IN_SELECT_IN_TABLE_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagInSelectInTable,\n        [Tokenizer.END_TAG_TOKEN]: endTagInSelectInTable,\n        [Tokenizer.EOF_TOKEN]: eofInBody\n    },\n    [IN_TEMPLATE_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: characterInBody,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagInTemplate,\n        [Tokenizer.END_TAG_TOKEN]: endTagInTemplate,\n        [Tokenizer.EOF_TOKEN]: eofInTemplate\n    },\n    [AFTER_BODY_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: tokenAfterBody,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: tokenAfterBody,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n        [Tokenizer.COMMENT_TOKEN]: appendCommentToRootHtmlElement,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagAfterBody,\n        [Tokenizer.END_TAG_TOKEN]: endTagAfterBody,\n        [Tokenizer.EOF_TOKEN]: stopParsing\n    },\n    [IN_FRAMESET_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagInFrameset,\n        [Tokenizer.END_TAG_TOKEN]: endTagInFrameset,\n        [Tokenizer.EOF_TOKEN]: stopParsing\n    },\n    [AFTER_FRAMESET_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: insertCharacters,\n        [Tokenizer.COMMENT_TOKEN]: appendComment,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagAfterFrameset,\n        [Tokenizer.END_TAG_TOKEN]: endTagAfterFrameset,\n        [Tokenizer.EOF_TOKEN]: stopParsing\n    },\n    [AFTER_AFTER_BODY_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: tokenAfterAfterBody,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: tokenAfterAfterBody,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n        [Tokenizer.COMMENT_TOKEN]: appendCommentToDocument,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagAfterAfterBody,\n        [Tokenizer.END_TAG_TOKEN]: tokenAfterAfterBody,\n        [Tokenizer.EOF_TOKEN]: stopParsing\n    },\n    [AFTER_AFTER_FRAMESET_MODE]: {\n        [Tokenizer.CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.NULL_CHARACTER_TOKEN]: ignoreToken,\n        [Tokenizer.WHITESPACE_CHARACTER_TOKEN]: whitespaceCharacterInBody,\n        [Tokenizer.COMMENT_TOKEN]: appendCommentToDocument,\n        [Tokenizer.DOCTYPE_TOKEN]: ignoreToken,\n        [Tokenizer.START_TAG_TOKEN]: startTagAfterAfterFrameset,\n        [Tokenizer.END_TAG_TOKEN]: ignoreToken,\n        [Tokenizer.EOF_TOKEN]: stopParsing\n    }\n};\n\n//Parser\nclass Parser {\n    constructor(options) {\n        this.options = mergeOptions(DEFAULT_OPTIONS, options);\n\n        this.treeAdapter = this.options.treeAdapter;\n        this.pendingScript = null;\n\n        if (this.options.sourceCodeLocationInfo) {\n            Mixin.install(this, LocationInfoParserMixin);\n        }\n\n        if (this.options.onParseError) {\n            Mixin.install(this, ErrorReportingParserMixin, { onParseError: this.options.onParseError });\n        }\n    }\n\n    // API\n    parse(html) {\n        const document = this.treeAdapter.createDocument();\n\n        this._bootstrap(document, null);\n        this.tokenizer.write(html, true);\n        this._runParsingLoop(null);\n\n        return document;\n    }\n\n    parseFragment(html, fragmentContext) {\n        //NOTE: use <template> element as a fragment context if context element was not provided,\n        //so we will parse in \"forgiving\" manner\n        if (!fragmentContext) {\n            fragmentContext = this.treeAdapter.createElement($.TEMPLATE, NS.HTML, []);\n        }\n\n        //NOTE: create fake element which will be used as 'document' for fragment parsing.\n        //This is important for jsdom there 'document' can't be recreated, therefore\n        //fragment parsing causes messing of the main `document`.\n        const documentMock = this.treeAdapter.createElement('documentmock', NS.HTML, []);\n\n        this._bootstrap(documentMock, fragmentContext);\n\n        if (this.treeAdapter.getTagName(fragmentContext) === $.TEMPLATE) {\n            this._pushTmplInsertionMode(IN_TEMPLATE_MODE);\n        }\n\n        this._initTokenizerForFragmentParsing();\n        this._insertFakeRootElement();\n        this._resetInsertionMode();\n        this._findFormInFragmentContext();\n        this.tokenizer.write(html, true);\n        this._runParsingLoop(null);\n\n        const rootElement = this.treeAdapter.getFirstChild(documentMock);\n        const fragment = this.treeAdapter.createDocumentFragment();\n\n        this._adoptNodes(rootElement, fragment);\n\n        return fragment;\n    }\n\n    //Bootstrap parser\n    _bootstrap(document, fragmentContext) {\n        this.tokenizer = new Tokenizer(this.options);\n\n        this.stopped = false;\n\n        this.insertionMode = INITIAL_MODE;\n        this.originalInsertionMode = '';\n\n        this.document = document;\n        this.fragmentContext = fragmentContext;\n\n        this.headElement = null;\n        this.formElement = null;\n\n        this.openElements = new OpenElementStack(this.document, this.treeAdapter);\n        this.activeFormattingElements = new FormattingElementList(this.treeAdapter);\n\n        this.tmplInsertionModeStack = [];\n        this.tmplInsertionModeStackTop = -1;\n        this.currentTmplInsertionMode = null;\n\n        this.pendingCharacterTokens = [];\n        this.hasNonWhitespacePendingCharacterToken = false;\n\n        this.framesetOk = true;\n        this.skipNextNewLine = false;\n        this.fosterParentingEnabled = false;\n    }\n\n    //Errors\n    _err() {\n        // NOTE: err reporting is noop by default. Enabled by mixin.\n    }\n\n    //Parsing loop\n    _runParsingLoop(scriptHandler) {\n        while (!this.stopped) {\n            this._setupTokenizerCDATAMode();\n\n            const token = this.tokenizer.getNextToken();\n\n            if (token.type === Tokenizer.HIBERNATION_TOKEN) {\n                break;\n            }\n\n            if (this.skipNextNewLine) {\n                this.skipNextNewLine = false;\n\n                if (token.type === Tokenizer.WHITESPACE_CHARACTER_TOKEN && token.chars[0] === '\\n') {\n                    if (token.chars.length === 1) {\n                        continue;\n                    }\n\n                    token.chars = token.chars.substr(1);\n                }\n            }\n\n            this._processInputToken(token);\n\n            if (scriptHandler && this.pendingScript) {\n                break;\n            }\n        }\n    }\n\n    runParsingLoopForCurrentChunk(writeCallback, scriptHandler) {\n        this._runParsingLoop(scriptHandler);\n\n        if (scriptHandler && this.pendingScript) {\n            const script = this.pendingScript;\n\n            this.pendingScript = null;\n\n            scriptHandler(script);\n\n            return;\n        }\n\n        if (writeCallback) {\n            writeCallback();\n        }\n    }\n\n    //Text parsing\n    _setupTokenizerCDATAMode() {\n        const current = this._getAdjustedCurrentElement();\n\n        this.tokenizer.allowCDATA =\n            current &&\n            current !== this.document &&\n            this.treeAdapter.getNamespaceURI(current) !== NS.HTML &&\n            !this._isIntegrationPoint(current);\n    }\n\n    _switchToTextParsing(currentToken, nextTokenizerState) {\n        this._insertElement(currentToken, NS.HTML);\n        this.tokenizer.state = nextTokenizerState;\n        this.originalInsertionMode = this.insertionMode;\n        this.insertionMode = TEXT_MODE;\n    }\n\n    switchToPlaintextParsing() {\n        this.insertionMode = TEXT_MODE;\n        this.originalInsertionMode = IN_BODY_MODE;\n        this.tokenizer.state = Tokenizer.MODE.PLAINTEXT;\n    }\n\n    //Fragment parsing\n    _getAdjustedCurrentElement() {\n        return this.openElements.stackTop === 0 && this.fragmentContext\n            ? this.fragmentContext\n            : this.openElements.current;\n    }\n\n    _findFormInFragmentContext() {\n        let node = this.fragmentContext;\n\n        do {\n            if (this.treeAdapter.getTagName(node) === $.FORM) {\n                this.formElement = node;\n                break;\n            }\n\n            node = this.treeAdapter.getParentNode(node);\n        } while (node);\n    }\n\n    _initTokenizerForFragmentParsing() {\n        if (this.treeAdapter.getNamespaceURI(this.fragmentContext) === NS.HTML) {\n            const tn = this.treeAdapter.getTagName(this.fragmentContext);\n\n            if (tn === $.TITLE || tn === $.TEXTAREA) {\n                this.tokenizer.state = Tokenizer.MODE.RCDATA;\n            } else if (\n                tn === $.STYLE ||\n                tn === $.XMP ||\n                tn === $.IFRAME ||\n                tn === $.NOEMBED ||\n                tn === $.NOFRAMES ||\n                tn === $.NOSCRIPT\n            ) {\n                this.tokenizer.state = Tokenizer.MODE.RAWTEXT;\n            } else if (tn === $.SCRIPT) {\n                this.tokenizer.state = Tokenizer.MODE.SCRIPT_DATA;\n            } else if (tn === $.PLAINTEXT) {\n                this.tokenizer.state = Tokenizer.MODE.PLAINTEXT;\n            }\n        }\n    }\n\n    //Tree mutation\n    _setDocumentType(token) {\n        const name = token.name || '';\n        const publicId = token.publicId || '';\n        const systemId = token.systemId || '';\n\n        this.treeAdapter.setDocumentType(this.document, name, publicId, systemId);\n    }\n\n    _attachElementToTree(element) {\n        if (this._shouldFosterParentOnInsertion()) {\n            this._fosterParentElement(element);\n        } else {\n            const parent = this.openElements.currentTmplContent || this.openElements.current;\n\n            this.treeAdapter.appendChild(parent, element);\n        }\n    }\n\n    _appendElement(token, namespaceURI) {\n        const element = this.treeAdapter.createElement(token.tagName, namespaceURI, token.attrs);\n\n        this._attachElementToTree(element);\n    }\n\n    _insertElement(token, namespaceURI) {\n        const element = this.treeAdapter.createElement(token.tagName, namespaceURI, token.attrs);\n\n        this._attachElementToTree(element);\n        this.openElements.push(element);\n    }\n\n    _insertFakeElement(tagName) {\n        const element = this.treeAdapter.createElement(tagName, NS.HTML, []);\n\n        this._attachElementToTree(element);\n        this.openElements.push(element);\n    }\n\n    _insertTemplate(token) {\n        const tmpl = this.treeAdapter.createElement(token.tagName, NS.HTML, token.attrs);\n        const content = this.treeAdapter.createDocumentFragment();\n\n        this.treeAdapter.setTemplateContent(tmpl, content);\n        this._attachElementToTree(tmpl);\n        this.openElements.push(tmpl);\n    }\n\n    _insertFakeRootElement() {\n        const element = this.treeAdapter.createElement($.HTML, NS.HTML, []);\n\n        this.treeAdapter.appendChild(this.openElements.current, element);\n        this.openElements.push(element);\n    }\n\n    _appendCommentNode(token, parent) {\n        const commentNode = this.treeAdapter.createCommentNode(token.data);\n\n        this.treeAdapter.appendChild(parent, commentNode);\n    }\n\n    _insertCharacters(token) {\n        if (this._shouldFosterParentOnInsertion()) {\n            this._fosterParentText(token.chars);\n        } else {\n            const parent = this.openElements.currentTmplContent || this.openElements.current;\n\n            this.treeAdapter.insertText(parent, token.chars);\n        }\n    }\n\n    _adoptNodes(donor, recipient) {\n        for (let child = this.treeAdapter.getFirstChild(donor); child; child = this.treeAdapter.getFirstChild(donor)) {\n            this.treeAdapter.detachNode(child);\n            this.treeAdapter.appendChild(recipient, child);\n        }\n    }\n\n    //Token processing\n    _shouldProcessTokenInForeignContent(token) {\n        const current = this._getAdjustedCurrentElement();\n\n        if (!current || current === this.document) {\n            return false;\n        }\n\n        const ns = this.treeAdapter.getNamespaceURI(current);\n\n        if (ns === NS.HTML) {\n            return false;\n        }\n\n        if (\n            this.treeAdapter.getTagName(current) === $.ANNOTATION_XML &&\n            ns === NS.MATHML &&\n            token.type === Tokenizer.START_TAG_TOKEN &&\n            token.tagName === $.SVG\n        ) {\n            return false;\n        }\n\n        const isCharacterToken =\n            token.type === Tokenizer.CHARACTER_TOKEN ||\n            token.type === Tokenizer.NULL_CHARACTER_TOKEN ||\n            token.type === Tokenizer.WHITESPACE_CHARACTER_TOKEN;\n\n        const isMathMLTextStartTag =\n            token.type === Tokenizer.START_TAG_TOKEN && token.tagName !== $.MGLYPH && token.tagName !== $.MALIGNMARK;\n\n        if ((isMathMLTextStartTag || isCharacterToken) && this._isIntegrationPoint(current, NS.MATHML)) {\n            return false;\n        }\n\n        if (\n            (token.type === Tokenizer.START_TAG_TOKEN || isCharacterToken) &&\n            this._isIntegrationPoint(current, NS.HTML)\n        ) {\n            return false;\n        }\n\n        return token.type !== Tokenizer.EOF_TOKEN;\n    }\n\n    _processToken(token) {\n        TOKEN_HANDLERS[this.insertionMode][token.type](this, token);\n    }\n\n    _processTokenInBodyMode(token) {\n        TOKEN_HANDLERS[IN_BODY_MODE][token.type](this, token);\n    }\n\n    _processTokenInForeignContent(token) {\n        if (token.type === Tokenizer.CHARACTER_TOKEN) {\n            characterInForeignContent(this, token);\n        } else if (token.type === Tokenizer.NULL_CHARACTER_TOKEN) {\n            nullCharacterInForeignContent(this, token);\n        } else if (token.type === Tokenizer.WHITESPACE_CHARACTER_TOKEN) {\n            insertCharacters(this, token);\n        } else if (token.type === Tokenizer.COMMENT_TOKEN) {\n            appendComment(this, token);\n        } else if (token.type === Tokenizer.START_TAG_TOKEN) {\n            startTagInForeignContent(this, token);\n        } else if (token.type === Tokenizer.END_TAG_TOKEN) {\n            endTagInForeignContent(this, token);\n        }\n    }\n\n    _processInputToken(token) {\n        if (this._shouldProcessTokenInForeignContent(token)) {\n            this._processTokenInForeignContent(token);\n        } else {\n            this._processToken(token);\n        }\n\n        if (token.type === Tokenizer.START_TAG_TOKEN && token.selfClosing && !token.ackSelfClosing) {\n            this._err(ERR.nonVoidHtmlElementStartTagWithTrailingSolidus);\n        }\n    }\n\n    //Integration points\n    _isIntegrationPoint(element, foreignNS) {\n        const tn = this.treeAdapter.getTagName(element);\n        const ns = this.treeAdapter.getNamespaceURI(element);\n        const attrs = this.treeAdapter.getAttrList(element);\n\n        return foreignContent.isIntegrationPoint(tn, ns, attrs, foreignNS);\n    }\n\n    //Active formatting elements reconstruction\n    _reconstructActiveFormattingElements() {\n        const listLength = this.activeFormattingElements.length;\n\n        if (listLength) {\n            let unopenIdx = listLength;\n            let entry = null;\n\n            do {\n                unopenIdx--;\n                entry = this.activeFormattingElements.entries[unopenIdx];\n\n                if (entry.type === FormattingElementList.MARKER_ENTRY || this.openElements.contains(entry.element)) {\n                    unopenIdx++;\n                    break;\n                }\n            } while (unopenIdx > 0);\n\n            for (let i = unopenIdx; i < listLength; i++) {\n                entry = this.activeFormattingElements.entries[i];\n                this._insertElement(entry.token, this.treeAdapter.getNamespaceURI(entry.element));\n                entry.element = this.openElements.current;\n            }\n        }\n    }\n\n    //Close elements\n    _closeTableCell() {\n        this.openElements.generateImpliedEndTags();\n        this.openElements.popUntilTableCellPopped();\n        this.activeFormattingElements.clearToLastMarker();\n        this.insertionMode = IN_ROW_MODE;\n    }\n\n    _closePElement() {\n        this.openElements.generateImpliedEndTagsWithExclusion($.P);\n        this.openElements.popUntilTagNamePopped($.P);\n    }\n\n    //Insertion modes\n    _resetInsertionMode() {\n        for (let i = this.openElements.stackTop, last = false; i >= 0; i--) {\n            let element = this.openElements.items[i];\n\n            if (i === 0) {\n                last = true;\n\n                if (this.fragmentContext) {\n                    element = this.fragmentContext;\n                }\n            }\n\n            const tn = this.treeAdapter.getTagName(element);\n            const newInsertionMode = INSERTION_MODE_RESET_MAP[tn];\n\n            if (newInsertionMode) {\n                this.insertionMode = newInsertionMode;\n                break;\n            } else if (!last && (tn === $.TD || tn === $.TH)) {\n                this.insertionMode = IN_CELL_MODE;\n                break;\n            } else if (!last && tn === $.HEAD) {\n                this.insertionMode = IN_HEAD_MODE;\n                break;\n            } else if (tn === $.SELECT) {\n                this._resetInsertionModeForSelect(i);\n                break;\n            } else if (tn === $.TEMPLATE) {\n                this.insertionMode = this.currentTmplInsertionMode;\n                break;\n            } else if (tn === $.HTML) {\n                this.insertionMode = this.headElement ? AFTER_HEAD_MODE : BEFORE_HEAD_MODE;\n                break;\n            } else if (last) {\n                this.insertionMode = IN_BODY_MODE;\n                break;\n            }\n        }\n    }\n\n    _resetInsertionModeForSelect(selectIdx) {\n        if (selectIdx > 0) {\n            for (let i = selectIdx - 1; i > 0; i--) {\n                const ancestor = this.openElements.items[i];\n                const tn = this.treeAdapter.getTagName(ancestor);\n\n                if (tn === $.TEMPLATE) {\n                    break;\n                } else if (tn === $.TABLE) {\n                    this.insertionMode = IN_SELECT_IN_TABLE_MODE;\n                    return;\n                }\n            }\n        }\n\n        this.insertionMode = IN_SELECT_MODE;\n    }\n\n    _pushTmplInsertionMode(mode) {\n        this.tmplInsertionModeStack.push(mode);\n        this.tmplInsertionModeStackTop++;\n        this.currentTmplInsertionMode = mode;\n    }\n\n    _popTmplInsertionMode() {\n        this.tmplInsertionModeStack.pop();\n        this.tmplInsertionModeStackTop--;\n        this.currentTmplInsertionMode = this.tmplInsertionModeStack[this.tmplInsertionModeStackTop];\n    }\n\n    //Foster parenting\n    _isElementCausesFosterParenting(element) {\n        const tn = this.treeAdapter.getTagName(element);\n\n        return tn === $.TABLE || tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD || tn === $.TR;\n    }\n\n    _shouldFosterParentOnInsertion() {\n        return this.fosterParentingEnabled && this._isElementCausesFosterParenting(this.openElements.current);\n    }\n\n    _findFosterParentingLocation() {\n        const location = {\n            parent: null,\n            beforeElement: null\n        };\n\n        for (let i = this.openElements.stackTop; i >= 0; i--) {\n            const openElement = this.openElements.items[i];\n            const tn = this.treeAdapter.getTagName(openElement);\n            const ns = this.treeAdapter.getNamespaceURI(openElement);\n\n            if (tn === $.TEMPLATE && ns === NS.HTML) {\n                location.parent = this.treeAdapter.getTemplateContent(openElement);\n                break;\n            } else if (tn === $.TABLE) {\n                location.parent = this.treeAdapter.getParentNode(openElement);\n\n                if (location.parent) {\n                    location.beforeElement = openElement;\n                } else {\n                    location.parent = this.openElements.items[i - 1];\n                }\n\n                break;\n            }\n        }\n\n        if (!location.parent) {\n            location.parent = this.openElements.items[0];\n        }\n\n        return location;\n    }\n\n    _fosterParentElement(element) {\n        const location = this._findFosterParentingLocation();\n\n        if (location.beforeElement) {\n            this.treeAdapter.insertBefore(location.parent, element, location.beforeElement);\n        } else {\n            this.treeAdapter.appendChild(location.parent, element);\n        }\n    }\n\n    _fosterParentText(chars) {\n        const location = this._findFosterParentingLocation();\n\n        if (location.beforeElement) {\n            this.treeAdapter.insertTextBefore(location.parent, chars, location.beforeElement);\n        } else {\n            this.treeAdapter.insertText(location.parent, chars);\n        }\n    }\n\n    //Special elements\n    _isSpecialElement(element) {\n        const tn = this.treeAdapter.getTagName(element);\n        const ns = this.treeAdapter.getNamespaceURI(element);\n\n        return HTML.SPECIAL_ELEMENTS[ns][tn];\n    }\n}\n\nmodule.exports = Parser;\n\n//Adoption agency algorithm\n//(see: http://www.whatwg.org/specs/web-apps/current-work/multipage/tree-construction.html#adoptionAgency)\n//------------------------------------------------------------------\n\n//Steps 5-8 of the algorithm\nfunction aaObtainFormattingElementEntry(p, token) {\n    let formattingElementEntry = p.activeFormattingElements.getElementEntryInScopeWithTagName(token.tagName);\n\n    if (formattingElementEntry) {\n        if (!p.openElements.contains(formattingElementEntry.element)) {\n            p.activeFormattingElements.removeEntry(formattingElementEntry);\n            formattingElementEntry = null;\n        } else if (!p.openElements.hasInScope(token.tagName)) {\n            formattingElementEntry = null;\n        }\n    } else {\n        genericEndTagInBody(p, token);\n    }\n\n    return formattingElementEntry;\n}\n\n//Steps 9 and 10 of the algorithm\nfunction aaObtainFurthestBlock(p, formattingElementEntry) {\n    let furthestBlock = null;\n\n    for (let i = p.openElements.stackTop; i >= 0; i--) {\n        const element = p.openElements.items[i];\n\n        if (element === formattingElementEntry.element) {\n            break;\n        }\n\n        if (p._isSpecialElement(element)) {\n            furthestBlock = element;\n        }\n    }\n\n    if (!furthestBlock) {\n        p.openElements.popUntilElementPopped(formattingElementEntry.element);\n        p.activeFormattingElements.removeEntry(formattingElementEntry);\n    }\n\n    return furthestBlock;\n}\n\n//Step 13 of the algorithm\nfunction aaInnerLoop(p, furthestBlock, formattingElement) {\n    let lastElement = furthestBlock;\n    let nextElement = p.openElements.getCommonAncestor(furthestBlock);\n\n    for (let i = 0, element = nextElement; element !== formattingElement; i++, element = nextElement) {\n        //NOTE: store next element for the next loop iteration (it may be deleted from the stack by step 9.5)\n        nextElement = p.openElements.getCommonAncestor(element);\n\n        const elementEntry = p.activeFormattingElements.getElementEntry(element);\n        const counterOverflow = elementEntry && i >= AA_INNER_LOOP_ITER;\n        const shouldRemoveFromOpenElements = !elementEntry || counterOverflow;\n\n        if (shouldRemoveFromOpenElements) {\n            if (counterOverflow) {\n                p.activeFormattingElements.removeEntry(elementEntry);\n            }\n\n            p.openElements.remove(element);\n        } else {\n            element = aaRecreateElementFromEntry(p, elementEntry);\n\n            if (lastElement === furthestBlock) {\n                p.activeFormattingElements.bookmark = elementEntry;\n            }\n\n            p.treeAdapter.detachNode(lastElement);\n            p.treeAdapter.appendChild(element, lastElement);\n            lastElement = element;\n        }\n    }\n\n    return lastElement;\n}\n\n//Step 13.7 of the algorithm\nfunction aaRecreateElementFromEntry(p, elementEntry) {\n    const ns = p.treeAdapter.getNamespaceURI(elementEntry.element);\n    const newElement = p.treeAdapter.createElement(elementEntry.token.tagName, ns, elementEntry.token.attrs);\n\n    p.openElements.replace(elementEntry.element, newElement);\n    elementEntry.element = newElement;\n\n    return newElement;\n}\n\n//Step 14 of the algorithm\nfunction aaInsertLastNodeInCommonAncestor(p, commonAncestor, lastElement) {\n    if (p._isElementCausesFosterParenting(commonAncestor)) {\n        p._fosterParentElement(lastElement);\n    } else {\n        const tn = p.treeAdapter.getTagName(commonAncestor);\n        const ns = p.treeAdapter.getNamespaceURI(commonAncestor);\n\n        if (tn === $.TEMPLATE && ns === NS.HTML) {\n            commonAncestor = p.treeAdapter.getTemplateContent(commonAncestor);\n        }\n\n        p.treeAdapter.appendChild(commonAncestor, lastElement);\n    }\n}\n\n//Steps 15-19 of the algorithm\nfunction aaReplaceFormattingElement(p, furthestBlock, formattingElementEntry) {\n    const ns = p.treeAdapter.getNamespaceURI(formattingElementEntry.element);\n    const token = formattingElementEntry.token;\n    const newElement = p.treeAdapter.createElement(token.tagName, ns, token.attrs);\n\n    p._adoptNodes(furthestBlock, newElement);\n    p.treeAdapter.appendChild(furthestBlock, newElement);\n\n    p.activeFormattingElements.insertElementAfterBookmark(newElement, formattingElementEntry.token);\n    p.activeFormattingElements.removeEntry(formattingElementEntry);\n\n    p.openElements.remove(formattingElementEntry.element);\n    p.openElements.insertAfter(furthestBlock, newElement);\n}\n\n//Algorithm entry point\nfunction callAdoptionAgency(p, token) {\n    let formattingElementEntry;\n\n    for (let i = 0; i < AA_OUTER_LOOP_ITER; i++) {\n        formattingElementEntry = aaObtainFormattingElementEntry(p, token, formattingElementEntry);\n\n        if (!formattingElementEntry) {\n            break;\n        }\n\n        const furthestBlock = aaObtainFurthestBlock(p, formattingElementEntry);\n\n        if (!furthestBlock) {\n            break;\n        }\n\n        p.activeFormattingElements.bookmark = formattingElementEntry;\n\n        const lastElement = aaInnerLoop(p, furthestBlock, formattingElementEntry.element);\n        const commonAncestor = p.openElements.getCommonAncestor(formattingElementEntry.element);\n\n        p.treeAdapter.detachNode(lastElement);\n        aaInsertLastNodeInCommonAncestor(p, commonAncestor, lastElement);\n        aaReplaceFormattingElement(p, furthestBlock, formattingElementEntry);\n    }\n}\n\n//Generic token handlers\n//------------------------------------------------------------------\nfunction ignoreToken() {\n    //NOTE: do nothing =)\n}\n\nfunction misplacedDoctype(p) {\n    p._err(ERR.misplacedDoctype);\n}\n\nfunction appendComment(p, token) {\n    p._appendCommentNode(token, p.openElements.currentTmplContent || p.openElements.current);\n}\n\nfunction appendCommentToRootHtmlElement(p, token) {\n    p._appendCommentNode(token, p.openElements.items[0]);\n}\n\nfunction appendCommentToDocument(p, token) {\n    p._appendCommentNode(token, p.document);\n}\n\nfunction insertCharacters(p, token) {\n    p._insertCharacters(token);\n}\n\nfunction stopParsing(p) {\n    p.stopped = true;\n}\n\n// The \"initial\" insertion mode\n//------------------------------------------------------------------\nfunction doctypeInInitialMode(p, token) {\n    p._setDocumentType(token);\n\n    const mode = token.forceQuirks ? HTML.DOCUMENT_MODE.QUIRKS : doctype.getDocumentMode(token);\n\n    if (!doctype.isConforming(token)) {\n        p._err(ERR.nonConformingDoctype);\n    }\n\n    p.treeAdapter.setDocumentMode(p.document, mode);\n\n    p.insertionMode = BEFORE_HTML_MODE;\n}\n\nfunction tokenInInitialMode(p, token) {\n    p._err(ERR.missingDoctype, { beforeToken: true });\n    p.treeAdapter.setDocumentMode(p.document, HTML.DOCUMENT_MODE.QUIRKS);\n    p.insertionMode = BEFORE_HTML_MODE;\n    p._processToken(token);\n}\n\n// The \"before html\" insertion mode\n//------------------------------------------------------------------\nfunction startTagBeforeHtml(p, token) {\n    if (token.tagName === $.HTML) {\n        p._insertElement(token, NS.HTML);\n        p.insertionMode = BEFORE_HEAD_MODE;\n    } else {\n        tokenBeforeHtml(p, token);\n    }\n}\n\nfunction endTagBeforeHtml(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HTML || tn === $.HEAD || tn === $.BODY || tn === $.BR) {\n        tokenBeforeHtml(p, token);\n    }\n}\n\nfunction tokenBeforeHtml(p, token) {\n    p._insertFakeRootElement();\n    p.insertionMode = BEFORE_HEAD_MODE;\n    p._processToken(token);\n}\n\n// The \"before head\" insertion mode\n//------------------------------------------------------------------\nfunction startTagBeforeHead(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HTML) {\n        startTagInBody(p, token);\n    } else if (tn === $.HEAD) {\n        p._insertElement(token, NS.HTML);\n        p.headElement = p.openElements.current;\n        p.insertionMode = IN_HEAD_MODE;\n    } else {\n        tokenBeforeHead(p, token);\n    }\n}\n\nfunction endTagBeforeHead(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HEAD || tn === $.BODY || tn === $.HTML || tn === $.BR) {\n        tokenBeforeHead(p, token);\n    } else {\n        p._err(ERR.endTagWithoutMatchingOpenElement);\n    }\n}\n\nfunction tokenBeforeHead(p, token) {\n    p._insertFakeElement($.HEAD);\n    p.headElement = p.openElements.current;\n    p.insertionMode = IN_HEAD_MODE;\n    p._processToken(token);\n}\n\n// The \"in head\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInHead(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HTML) {\n        startTagInBody(p, token);\n    } else if (tn === $.BASE || tn === $.BASEFONT || tn === $.BGSOUND || tn === $.LINK || tn === $.META) {\n        p._appendElement(token, NS.HTML);\n        token.ackSelfClosing = true;\n    } else if (tn === $.TITLE) {\n        p._switchToTextParsing(token, Tokenizer.MODE.RCDATA);\n    } else if (tn === $.NOSCRIPT) {\n        if (p.options.scriptingEnabled) {\n            p._switchToTextParsing(token, Tokenizer.MODE.RAWTEXT);\n        } else {\n            p._insertElement(token, NS.HTML);\n            p.insertionMode = IN_HEAD_NO_SCRIPT_MODE;\n        }\n    } else if (tn === $.NOFRAMES || tn === $.STYLE) {\n        p._switchToTextParsing(token, Tokenizer.MODE.RAWTEXT);\n    } else if (tn === $.SCRIPT) {\n        p._switchToTextParsing(token, Tokenizer.MODE.SCRIPT_DATA);\n    } else if (tn === $.TEMPLATE) {\n        p._insertTemplate(token, NS.HTML);\n        p.activeFormattingElements.insertMarker();\n        p.framesetOk = false;\n        p.insertionMode = IN_TEMPLATE_MODE;\n        p._pushTmplInsertionMode(IN_TEMPLATE_MODE);\n    } else if (tn === $.HEAD) {\n        p._err(ERR.misplacedStartTagForHeadElement);\n    } else {\n        tokenInHead(p, token);\n    }\n}\n\nfunction endTagInHead(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HEAD) {\n        p.openElements.pop();\n        p.insertionMode = AFTER_HEAD_MODE;\n    } else if (tn === $.BODY || tn === $.BR || tn === $.HTML) {\n        tokenInHead(p, token);\n    } else if (tn === $.TEMPLATE) {\n        if (p.openElements.tmplCount > 0) {\n            p.openElements.generateImpliedEndTagsThoroughly();\n\n            if (p.openElements.currentTagName !== $.TEMPLATE) {\n                p._err(ERR.closingOfElementWithOpenChildElements);\n            }\n\n            p.openElements.popUntilTagNamePopped($.TEMPLATE);\n            p.activeFormattingElements.clearToLastMarker();\n            p._popTmplInsertionMode();\n            p._resetInsertionMode();\n        } else {\n            p._err(ERR.endTagWithoutMatchingOpenElement);\n        }\n    } else {\n        p._err(ERR.endTagWithoutMatchingOpenElement);\n    }\n}\n\nfunction tokenInHead(p, token) {\n    p.openElements.pop();\n    p.insertionMode = AFTER_HEAD_MODE;\n    p._processToken(token);\n}\n\n// The \"in head no script\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInHeadNoScript(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HTML) {\n        startTagInBody(p, token);\n    } else if (\n        tn === $.BASEFONT ||\n        tn === $.BGSOUND ||\n        tn === $.HEAD ||\n        tn === $.LINK ||\n        tn === $.META ||\n        tn === $.NOFRAMES ||\n        tn === $.STYLE\n    ) {\n        startTagInHead(p, token);\n    } else if (tn === $.NOSCRIPT) {\n        p._err(ERR.nestedNoscriptInHead);\n    } else {\n        tokenInHeadNoScript(p, token);\n    }\n}\n\nfunction endTagInHeadNoScript(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.NOSCRIPT) {\n        p.openElements.pop();\n        p.insertionMode = IN_HEAD_MODE;\n    } else if (tn === $.BR) {\n        tokenInHeadNoScript(p, token);\n    } else {\n        p._err(ERR.endTagWithoutMatchingOpenElement);\n    }\n}\n\nfunction tokenInHeadNoScript(p, token) {\n    const errCode =\n        token.type === Tokenizer.EOF_TOKEN ? ERR.openElementsLeftAfterEof : ERR.disallowedContentInNoscriptInHead;\n\n    p._err(errCode);\n    p.openElements.pop();\n    p.insertionMode = IN_HEAD_MODE;\n    p._processToken(token);\n}\n\n// The \"after head\" insertion mode\n//------------------------------------------------------------------\nfunction startTagAfterHead(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HTML) {\n        startTagInBody(p, token);\n    } else if (tn === $.BODY) {\n        p._insertElement(token, NS.HTML);\n        p.framesetOk = false;\n        p.insertionMode = IN_BODY_MODE;\n    } else if (tn === $.FRAMESET) {\n        p._insertElement(token, NS.HTML);\n        p.insertionMode = IN_FRAMESET_MODE;\n    } else if (\n        tn === $.BASE ||\n        tn === $.BASEFONT ||\n        tn === $.BGSOUND ||\n        tn === $.LINK ||\n        tn === $.META ||\n        tn === $.NOFRAMES ||\n        tn === $.SCRIPT ||\n        tn === $.STYLE ||\n        tn === $.TEMPLATE ||\n        tn === $.TITLE\n    ) {\n        p._err(ERR.abandonedHeadElementChild);\n        p.openElements.push(p.headElement);\n        startTagInHead(p, token);\n        p.openElements.remove(p.headElement);\n    } else if (tn === $.HEAD) {\n        p._err(ERR.misplacedStartTagForHeadElement);\n    } else {\n        tokenAfterHead(p, token);\n    }\n}\n\nfunction endTagAfterHead(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.BODY || tn === $.HTML || tn === $.BR) {\n        tokenAfterHead(p, token);\n    } else if (tn === $.TEMPLATE) {\n        endTagInHead(p, token);\n    } else {\n        p._err(ERR.endTagWithoutMatchingOpenElement);\n    }\n}\n\nfunction tokenAfterHead(p, token) {\n    p._insertFakeElement($.BODY);\n    p.insertionMode = IN_BODY_MODE;\n    p._processToken(token);\n}\n\n// The \"in body\" insertion mode\n//------------------------------------------------------------------\nfunction whitespaceCharacterInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    p._insertCharacters(token);\n}\n\nfunction characterInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    p._insertCharacters(token);\n    p.framesetOk = false;\n}\n\nfunction htmlStartTagInBody(p, token) {\n    if (p.openElements.tmplCount === 0) {\n        p.treeAdapter.adoptAttributes(p.openElements.items[0], token.attrs);\n    }\n}\n\nfunction bodyStartTagInBody(p, token) {\n    const bodyElement = p.openElements.tryPeekProperlyNestedBodyElement();\n\n    if (bodyElement && p.openElements.tmplCount === 0) {\n        p.framesetOk = false;\n        p.treeAdapter.adoptAttributes(bodyElement, token.attrs);\n    }\n}\n\nfunction framesetStartTagInBody(p, token) {\n    const bodyElement = p.openElements.tryPeekProperlyNestedBodyElement();\n\n    if (p.framesetOk && bodyElement) {\n        p.treeAdapter.detachNode(bodyElement);\n        p.openElements.popAllUpToHtmlElement();\n        p._insertElement(token, NS.HTML);\n        p.insertionMode = IN_FRAMESET_MODE;\n    }\n}\n\nfunction addressStartTagInBody(p, token) {\n    if (p.openElements.hasInButtonScope($.P)) {\n        p._closePElement();\n    }\n\n    p._insertElement(token, NS.HTML);\n}\n\nfunction numberedHeaderStartTagInBody(p, token) {\n    if (p.openElements.hasInButtonScope($.P)) {\n        p._closePElement();\n    }\n\n    const tn = p.openElements.currentTagName;\n\n    if (tn === $.H1 || tn === $.H2 || tn === $.H3 || tn === $.H4 || tn === $.H5 || tn === $.H6) {\n        p.openElements.pop();\n    }\n\n    p._insertElement(token, NS.HTML);\n}\n\nfunction preStartTagInBody(p, token) {\n    if (p.openElements.hasInButtonScope($.P)) {\n        p._closePElement();\n    }\n\n    p._insertElement(token, NS.HTML);\n    //NOTE: If the next token is a U+000A LINE FEED (LF) character token, then ignore that token and move\n    //on to the next one. (Newlines at the start of pre blocks are ignored as an authoring convenience.)\n    p.skipNextNewLine = true;\n    p.framesetOk = false;\n}\n\nfunction formStartTagInBody(p, token) {\n    const inTemplate = p.openElements.tmplCount > 0;\n\n    if (!p.formElement || inTemplate) {\n        if (p.openElements.hasInButtonScope($.P)) {\n            p._closePElement();\n        }\n\n        p._insertElement(token, NS.HTML);\n\n        if (!inTemplate) {\n            p.formElement = p.openElements.current;\n        }\n    }\n}\n\nfunction listItemStartTagInBody(p, token) {\n    p.framesetOk = false;\n\n    const tn = token.tagName;\n\n    for (let i = p.openElements.stackTop; i >= 0; i--) {\n        const element = p.openElements.items[i];\n        const elementTn = p.treeAdapter.getTagName(element);\n        let closeTn = null;\n\n        if (tn === $.LI && elementTn === $.LI) {\n            closeTn = $.LI;\n        } else if ((tn === $.DD || tn === $.DT) && (elementTn === $.DD || elementTn === $.DT)) {\n            closeTn = elementTn;\n        }\n\n        if (closeTn) {\n            p.openElements.generateImpliedEndTagsWithExclusion(closeTn);\n            p.openElements.popUntilTagNamePopped(closeTn);\n            break;\n        }\n\n        if (elementTn !== $.ADDRESS && elementTn !== $.DIV && elementTn !== $.P && p._isSpecialElement(element)) {\n            break;\n        }\n    }\n\n    if (p.openElements.hasInButtonScope($.P)) {\n        p._closePElement();\n    }\n\n    p._insertElement(token, NS.HTML);\n}\n\nfunction plaintextStartTagInBody(p, token) {\n    if (p.openElements.hasInButtonScope($.P)) {\n        p._closePElement();\n    }\n\n    p._insertElement(token, NS.HTML);\n    p.tokenizer.state = Tokenizer.MODE.PLAINTEXT;\n}\n\nfunction buttonStartTagInBody(p, token) {\n    if (p.openElements.hasInScope($.BUTTON)) {\n        p.openElements.generateImpliedEndTags();\n        p.openElements.popUntilTagNamePopped($.BUTTON);\n    }\n\n    p._reconstructActiveFormattingElements();\n    p._insertElement(token, NS.HTML);\n    p.framesetOk = false;\n}\n\nfunction aStartTagInBody(p, token) {\n    const activeElementEntry = p.activeFormattingElements.getElementEntryInScopeWithTagName($.A);\n\n    if (activeElementEntry) {\n        callAdoptionAgency(p, token);\n        p.openElements.remove(activeElementEntry.element);\n        p.activeFormattingElements.removeEntry(activeElementEntry);\n    }\n\n    p._reconstructActiveFormattingElements();\n    p._insertElement(token, NS.HTML);\n    p.activeFormattingElements.pushElement(p.openElements.current, token);\n}\n\nfunction bStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    p._insertElement(token, NS.HTML);\n    p.activeFormattingElements.pushElement(p.openElements.current, token);\n}\n\nfunction nobrStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n\n    if (p.openElements.hasInScope($.NOBR)) {\n        callAdoptionAgency(p, token);\n        p._reconstructActiveFormattingElements();\n    }\n\n    p._insertElement(token, NS.HTML);\n    p.activeFormattingElements.pushElement(p.openElements.current, token);\n}\n\nfunction appletStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    p._insertElement(token, NS.HTML);\n    p.activeFormattingElements.insertMarker();\n    p.framesetOk = false;\n}\n\nfunction tableStartTagInBody(p, token) {\n    if (\n        p.treeAdapter.getDocumentMode(p.document) !== HTML.DOCUMENT_MODE.QUIRKS &&\n        p.openElements.hasInButtonScope($.P)\n    ) {\n        p._closePElement();\n    }\n\n    p._insertElement(token, NS.HTML);\n    p.framesetOk = false;\n    p.insertionMode = IN_TABLE_MODE;\n}\n\nfunction areaStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    p._appendElement(token, NS.HTML);\n    p.framesetOk = false;\n    token.ackSelfClosing = true;\n}\n\nfunction inputStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    p._appendElement(token, NS.HTML);\n\n    const inputType = Tokenizer.getTokenAttr(token, ATTRS.TYPE);\n\n    if (!inputType || inputType.toLowerCase() !== HIDDEN_INPUT_TYPE) {\n        p.framesetOk = false;\n    }\n\n    token.ackSelfClosing = true;\n}\n\nfunction paramStartTagInBody(p, token) {\n    p._appendElement(token, NS.HTML);\n    token.ackSelfClosing = true;\n}\n\nfunction hrStartTagInBody(p, token) {\n    if (p.openElements.hasInButtonScope($.P)) {\n        p._closePElement();\n    }\n\n    p._appendElement(token, NS.HTML);\n    p.framesetOk = false;\n    token.ackSelfClosing = true;\n}\n\nfunction imageStartTagInBody(p, token) {\n    token.tagName = $.IMG;\n    areaStartTagInBody(p, token);\n}\n\nfunction textareaStartTagInBody(p, token) {\n    p._insertElement(token, NS.HTML);\n    //NOTE: If the next token is a U+000A LINE FEED (LF) character token, then ignore that token and move\n    //on to the next one. (Newlines at the start of textarea elements are ignored as an authoring convenience.)\n    p.skipNextNewLine = true;\n    p.tokenizer.state = Tokenizer.MODE.RCDATA;\n    p.originalInsertionMode = p.insertionMode;\n    p.framesetOk = false;\n    p.insertionMode = TEXT_MODE;\n}\n\nfunction xmpStartTagInBody(p, token) {\n    if (p.openElements.hasInButtonScope($.P)) {\n        p._closePElement();\n    }\n\n    p._reconstructActiveFormattingElements();\n    p.framesetOk = false;\n    p._switchToTextParsing(token, Tokenizer.MODE.RAWTEXT);\n}\n\nfunction iframeStartTagInBody(p, token) {\n    p.framesetOk = false;\n    p._switchToTextParsing(token, Tokenizer.MODE.RAWTEXT);\n}\n\n//NOTE: here we assume that we always act as an user agent with enabled plugins, so we parse\n//<noembed> as a rawtext.\nfunction noembedStartTagInBody(p, token) {\n    p._switchToTextParsing(token, Tokenizer.MODE.RAWTEXT);\n}\n\nfunction selectStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    p._insertElement(token, NS.HTML);\n    p.framesetOk = false;\n\n    if (\n        p.insertionMode === IN_TABLE_MODE ||\n        p.insertionMode === IN_CAPTION_MODE ||\n        p.insertionMode === IN_TABLE_BODY_MODE ||\n        p.insertionMode === IN_ROW_MODE ||\n        p.insertionMode === IN_CELL_MODE\n    ) {\n        p.insertionMode = IN_SELECT_IN_TABLE_MODE;\n    } else {\n        p.insertionMode = IN_SELECT_MODE;\n    }\n}\n\nfunction optgroupStartTagInBody(p, token) {\n    if (p.openElements.currentTagName === $.OPTION) {\n        p.openElements.pop();\n    }\n\n    p._reconstructActiveFormattingElements();\n    p._insertElement(token, NS.HTML);\n}\n\nfunction rbStartTagInBody(p, token) {\n    if (p.openElements.hasInScope($.RUBY)) {\n        p.openElements.generateImpliedEndTags();\n    }\n\n    p._insertElement(token, NS.HTML);\n}\n\nfunction rtStartTagInBody(p, token) {\n    if (p.openElements.hasInScope($.RUBY)) {\n        p.openElements.generateImpliedEndTagsWithExclusion($.RTC);\n    }\n\n    p._insertElement(token, NS.HTML);\n}\n\nfunction menuStartTagInBody(p, token) {\n    if (p.openElements.hasInButtonScope($.P)) {\n        p._closePElement();\n    }\n\n    p._insertElement(token, NS.HTML);\n}\n\nfunction mathStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n\n    foreignContent.adjustTokenMathMLAttrs(token);\n    foreignContent.adjustTokenXMLAttrs(token);\n\n    if (token.selfClosing) {\n        p._appendElement(token, NS.MATHML);\n    } else {\n        p._insertElement(token, NS.MATHML);\n    }\n\n    token.ackSelfClosing = true;\n}\n\nfunction svgStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n\n    foreignContent.adjustTokenSVGAttrs(token);\n    foreignContent.adjustTokenXMLAttrs(token);\n\n    if (token.selfClosing) {\n        p._appendElement(token, NS.SVG);\n    } else {\n        p._insertElement(token, NS.SVG);\n    }\n\n    token.ackSelfClosing = true;\n}\n\nfunction genericStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    p._insertElement(token, NS.HTML);\n}\n\n//OPTIMIZATION: Integer comparisons are low-cost, so we can use very fast tag name length filters here.\n//It's faster than using dictionary.\nfunction startTagInBody(p, token) {\n    const tn = token.tagName;\n\n    switch (tn.length) {\n        case 1:\n            if (tn === $.I || tn === $.S || tn === $.B || tn === $.U) {\n                bStartTagInBody(p, token);\n            } else if (tn === $.P) {\n                addressStartTagInBody(p, token);\n            } else if (tn === $.A) {\n                aStartTagInBody(p, token);\n            } else {\n                genericStartTagInBody(p, token);\n            }\n\n            break;\n\n        case 2:\n            if (tn === $.DL || tn === $.OL || tn === $.UL) {\n                addressStartTagInBody(p, token);\n            } else if (tn === $.H1 || tn === $.H2 || tn === $.H3 || tn === $.H4 || tn === $.H5 || tn === $.H6) {\n                numberedHeaderStartTagInBody(p, token);\n            } else if (tn === $.LI || tn === $.DD || tn === $.DT) {\n                listItemStartTagInBody(p, token);\n            } else if (tn === $.EM || tn === $.TT) {\n                bStartTagInBody(p, token);\n            } else if (tn === $.BR) {\n                areaStartTagInBody(p, token);\n            } else if (tn === $.HR) {\n                hrStartTagInBody(p, token);\n            } else if (tn === $.RB) {\n                rbStartTagInBody(p, token);\n            } else if (tn === $.RT || tn === $.RP) {\n                rtStartTagInBody(p, token);\n            } else if (tn !== $.TH && tn !== $.TD && tn !== $.TR) {\n                genericStartTagInBody(p, token);\n            }\n\n            break;\n\n        case 3:\n            if (tn === $.DIV || tn === $.DIR || tn === $.NAV) {\n                addressStartTagInBody(p, token);\n            } else if (tn === $.PRE) {\n                preStartTagInBody(p, token);\n            } else if (tn === $.BIG) {\n                bStartTagInBody(p, token);\n            } else if (tn === $.IMG || tn === $.WBR) {\n                areaStartTagInBody(p, token);\n            } else if (tn === $.XMP) {\n                xmpStartTagInBody(p, token);\n            } else if (tn === $.SVG) {\n                svgStartTagInBody(p, token);\n            } else if (tn === $.RTC) {\n                rbStartTagInBody(p, token);\n            } else if (tn !== $.COL) {\n                genericStartTagInBody(p, token);\n            }\n\n            break;\n\n        case 4:\n            if (tn === $.HTML) {\n                htmlStartTagInBody(p, token);\n            } else if (tn === $.BASE || tn === $.LINK || tn === $.META) {\n                startTagInHead(p, token);\n            } else if (tn === $.BODY) {\n                bodyStartTagInBody(p, token);\n            } else if (tn === $.MAIN || tn === $.MENU) {\n                addressStartTagInBody(p, token);\n            } else if (tn === $.FORM) {\n                formStartTagInBody(p, token);\n            } else if (tn === $.CODE || tn === $.FONT) {\n                bStartTagInBody(p, token);\n            } else if (tn === $.NOBR) {\n                nobrStartTagInBody(p, token);\n            } else if (tn === $.AREA) {\n                areaStartTagInBody(p, token);\n            } else if (tn === $.MATH) {\n                mathStartTagInBody(p, token);\n            } else if (tn === $.MENU) {\n                menuStartTagInBody(p, token);\n            } else if (tn !== $.HEAD) {\n                genericStartTagInBody(p, token);\n            }\n\n            break;\n\n        case 5:\n            if (tn === $.STYLE || tn === $.TITLE) {\n                startTagInHead(p, token);\n            } else if (tn === $.ASIDE) {\n                addressStartTagInBody(p, token);\n            } else if (tn === $.SMALL) {\n                bStartTagInBody(p, token);\n            } else if (tn === $.TABLE) {\n                tableStartTagInBody(p, token);\n            } else if (tn === $.EMBED) {\n                areaStartTagInBody(p, token);\n            } else if (tn === $.INPUT) {\n                inputStartTagInBody(p, token);\n            } else if (tn === $.PARAM || tn === $.TRACK) {\n                paramStartTagInBody(p, token);\n            } else if (tn === $.IMAGE) {\n                imageStartTagInBody(p, token);\n            } else if (tn !== $.FRAME && tn !== $.TBODY && tn !== $.TFOOT && tn !== $.THEAD) {\n                genericStartTagInBody(p, token);\n            }\n\n            break;\n\n        case 6:\n            if (tn === $.SCRIPT) {\n                startTagInHead(p, token);\n            } else if (\n                tn === $.CENTER ||\n                tn === $.FIGURE ||\n                tn === $.FOOTER ||\n                tn === $.HEADER ||\n                tn === $.HGROUP ||\n                tn === $.DIALOG\n            ) {\n                addressStartTagInBody(p, token);\n            } else if (tn === $.BUTTON) {\n                buttonStartTagInBody(p, token);\n            } else if (tn === $.STRIKE || tn === $.STRONG) {\n                bStartTagInBody(p, token);\n            } else if (tn === $.APPLET || tn === $.OBJECT) {\n                appletStartTagInBody(p, token);\n            } else if (tn === $.KEYGEN) {\n                areaStartTagInBody(p, token);\n            } else if (tn === $.SOURCE) {\n                paramStartTagInBody(p, token);\n            } else if (tn === $.IFRAME) {\n                iframeStartTagInBody(p, token);\n            } else if (tn === $.SELECT) {\n                selectStartTagInBody(p, token);\n            } else if (tn === $.OPTION) {\n                optgroupStartTagInBody(p, token);\n            } else {\n                genericStartTagInBody(p, token);\n            }\n\n            break;\n\n        case 7:\n            if (tn === $.BGSOUND) {\n                startTagInHead(p, token);\n            } else if (\n                tn === $.DETAILS ||\n                tn === $.ADDRESS ||\n                tn === $.ARTICLE ||\n                tn === $.SECTION ||\n                tn === $.SUMMARY\n            ) {\n                addressStartTagInBody(p, token);\n            } else if (tn === $.LISTING) {\n                preStartTagInBody(p, token);\n            } else if (tn === $.MARQUEE) {\n                appletStartTagInBody(p, token);\n            } else if (tn === $.NOEMBED) {\n                noembedStartTagInBody(p, token);\n            } else if (tn !== $.CAPTION) {\n                genericStartTagInBody(p, token);\n            }\n\n            break;\n\n        case 8:\n            if (tn === $.BASEFONT) {\n                startTagInHead(p, token);\n            } else if (tn === $.FRAMESET) {\n                framesetStartTagInBody(p, token);\n            } else if (tn === $.FIELDSET) {\n                addressStartTagInBody(p, token);\n            } else if (tn === $.TEXTAREA) {\n                textareaStartTagInBody(p, token);\n            } else if (tn === $.TEMPLATE) {\n                startTagInHead(p, token);\n            } else if (tn === $.NOSCRIPT) {\n                if (p.options.scriptingEnabled) {\n                    noembedStartTagInBody(p, token);\n                } else {\n                    genericStartTagInBody(p, token);\n                }\n            } else if (tn === $.OPTGROUP) {\n                optgroupStartTagInBody(p, token);\n            } else if (tn !== $.COLGROUP) {\n                genericStartTagInBody(p, token);\n            }\n\n            break;\n\n        case 9:\n            if (tn === $.PLAINTEXT) {\n                plaintextStartTagInBody(p, token);\n            } else {\n                genericStartTagInBody(p, token);\n            }\n\n            break;\n\n        case 10:\n            if (tn === $.BLOCKQUOTE || tn === $.FIGCAPTION) {\n                addressStartTagInBody(p, token);\n            } else {\n                genericStartTagInBody(p, token);\n            }\n\n            break;\n\n        default:\n            genericStartTagInBody(p, token);\n    }\n}\n\nfunction bodyEndTagInBody(p) {\n    if (p.openElements.hasInScope($.BODY)) {\n        p.insertionMode = AFTER_BODY_MODE;\n    }\n}\n\nfunction htmlEndTagInBody(p, token) {\n    if (p.openElements.hasInScope($.BODY)) {\n        p.insertionMode = AFTER_BODY_MODE;\n        p._processToken(token);\n    }\n}\n\nfunction addressEndTagInBody(p, token) {\n    const tn = token.tagName;\n\n    if (p.openElements.hasInScope(tn)) {\n        p.openElements.generateImpliedEndTags();\n        p.openElements.popUntilTagNamePopped(tn);\n    }\n}\n\nfunction formEndTagInBody(p) {\n    const inTemplate = p.openElements.tmplCount > 0;\n    const formElement = p.formElement;\n\n    if (!inTemplate) {\n        p.formElement = null;\n    }\n\n    if ((formElement || inTemplate) && p.openElements.hasInScope($.FORM)) {\n        p.openElements.generateImpliedEndTags();\n\n        if (inTemplate) {\n            p.openElements.popUntilTagNamePopped($.FORM);\n        } else {\n            p.openElements.remove(formElement);\n        }\n    }\n}\n\nfunction pEndTagInBody(p) {\n    if (!p.openElements.hasInButtonScope($.P)) {\n        p._insertFakeElement($.P);\n    }\n\n    p._closePElement();\n}\n\nfunction liEndTagInBody(p) {\n    if (p.openElements.hasInListItemScope($.LI)) {\n        p.openElements.generateImpliedEndTagsWithExclusion($.LI);\n        p.openElements.popUntilTagNamePopped($.LI);\n    }\n}\n\nfunction ddEndTagInBody(p, token) {\n    const tn = token.tagName;\n\n    if (p.openElements.hasInScope(tn)) {\n        p.openElements.generateImpliedEndTagsWithExclusion(tn);\n        p.openElements.popUntilTagNamePopped(tn);\n    }\n}\n\nfunction numberedHeaderEndTagInBody(p) {\n    if (p.openElements.hasNumberedHeaderInScope()) {\n        p.openElements.generateImpliedEndTags();\n        p.openElements.popUntilNumberedHeaderPopped();\n    }\n}\n\nfunction appletEndTagInBody(p, token) {\n    const tn = token.tagName;\n\n    if (p.openElements.hasInScope(tn)) {\n        p.openElements.generateImpliedEndTags();\n        p.openElements.popUntilTagNamePopped(tn);\n        p.activeFormattingElements.clearToLastMarker();\n    }\n}\n\nfunction brEndTagInBody(p) {\n    p._reconstructActiveFormattingElements();\n    p._insertFakeElement($.BR);\n    p.openElements.pop();\n    p.framesetOk = false;\n}\n\nfunction genericEndTagInBody(p, token) {\n    const tn = token.tagName;\n\n    for (let i = p.openElements.stackTop; i > 0; i--) {\n        const element = p.openElements.items[i];\n\n        if (p.treeAdapter.getTagName(element) === tn) {\n            p.openElements.generateImpliedEndTagsWithExclusion(tn);\n            p.openElements.popUntilElementPopped(element);\n            break;\n        }\n\n        if (p._isSpecialElement(element)) {\n            break;\n        }\n    }\n}\n\n//OPTIMIZATION: Integer comparisons are low-cost, so we can use very fast tag name length filters here.\n//It's faster than using dictionary.\nfunction endTagInBody(p, token) {\n    const tn = token.tagName;\n\n    switch (tn.length) {\n        case 1:\n            if (tn === $.A || tn === $.B || tn === $.I || tn === $.S || tn === $.U) {\n                callAdoptionAgency(p, token);\n            } else if (tn === $.P) {\n                pEndTagInBody(p, token);\n            } else {\n                genericEndTagInBody(p, token);\n            }\n\n            break;\n\n        case 2:\n            if (tn === $.DL || tn === $.UL || tn === $.OL) {\n                addressEndTagInBody(p, token);\n            } else if (tn === $.LI) {\n                liEndTagInBody(p, token);\n            } else if (tn === $.DD || tn === $.DT) {\n                ddEndTagInBody(p, token);\n            } else if (tn === $.H1 || tn === $.H2 || tn === $.H3 || tn === $.H4 || tn === $.H5 || tn === $.H6) {\n                numberedHeaderEndTagInBody(p, token);\n            } else if (tn === $.BR) {\n                brEndTagInBody(p, token);\n            } else if (tn === $.EM || tn === $.TT) {\n                callAdoptionAgency(p, token);\n            } else {\n                genericEndTagInBody(p, token);\n            }\n\n            break;\n\n        case 3:\n            if (tn === $.BIG) {\n                callAdoptionAgency(p, token);\n            } else if (tn === $.DIR || tn === $.DIV || tn === $.NAV || tn === $.PRE) {\n                addressEndTagInBody(p, token);\n            } else {\n                genericEndTagInBody(p, token);\n            }\n\n            break;\n\n        case 4:\n            if (tn === $.BODY) {\n                bodyEndTagInBody(p, token);\n            } else if (tn === $.HTML) {\n                htmlEndTagInBody(p, token);\n            } else if (tn === $.FORM) {\n                formEndTagInBody(p, token);\n            } else if (tn === $.CODE || tn === $.FONT || tn === $.NOBR) {\n                callAdoptionAgency(p, token);\n            } else if (tn === $.MAIN || tn === $.MENU) {\n                addressEndTagInBody(p, token);\n            } else {\n                genericEndTagInBody(p, token);\n            }\n\n            break;\n\n        case 5:\n            if (tn === $.ASIDE) {\n                addressEndTagInBody(p, token);\n            } else if (tn === $.SMALL) {\n                callAdoptionAgency(p, token);\n            } else {\n                genericEndTagInBody(p, token);\n            }\n\n            break;\n\n        case 6:\n            if (\n                tn === $.CENTER ||\n                tn === $.FIGURE ||\n                tn === $.FOOTER ||\n                tn === $.HEADER ||\n                tn === $.HGROUP ||\n                tn === $.DIALOG\n            ) {\n                addressEndTagInBody(p, token);\n            } else if (tn === $.APPLET || tn === $.OBJECT) {\n                appletEndTagInBody(p, token);\n            } else if (tn === $.STRIKE || tn === $.STRONG) {\n                callAdoptionAgency(p, token);\n            } else {\n                genericEndTagInBody(p, token);\n            }\n\n            break;\n\n        case 7:\n            if (\n                tn === $.ADDRESS ||\n                tn === $.ARTICLE ||\n                tn === $.DETAILS ||\n                tn === $.SECTION ||\n                tn === $.SUMMARY ||\n                tn === $.LISTING\n            ) {\n                addressEndTagInBody(p, token);\n            } else if (tn === $.MARQUEE) {\n                appletEndTagInBody(p, token);\n            } else {\n                genericEndTagInBody(p, token);\n            }\n\n            break;\n\n        case 8:\n            if (tn === $.FIELDSET) {\n                addressEndTagInBody(p, token);\n            } else if (tn === $.TEMPLATE) {\n                endTagInHead(p, token);\n            } else {\n                genericEndTagInBody(p, token);\n            }\n\n            break;\n\n        case 10:\n            if (tn === $.BLOCKQUOTE || tn === $.FIGCAPTION) {\n                addressEndTagInBody(p, token);\n            } else {\n                genericEndTagInBody(p, token);\n            }\n\n            break;\n\n        default:\n            genericEndTagInBody(p, token);\n    }\n}\n\nfunction eofInBody(p, token) {\n    if (p.tmplInsertionModeStackTop > -1) {\n        eofInTemplate(p, token);\n    } else {\n        p.stopped = true;\n    }\n}\n\n// The \"text\" insertion mode\n//------------------------------------------------------------------\nfunction endTagInText(p, token) {\n    if (token.tagName === $.SCRIPT) {\n        p.pendingScript = p.openElements.current;\n    }\n\n    p.openElements.pop();\n    p.insertionMode = p.originalInsertionMode;\n}\n\nfunction eofInText(p, token) {\n    p._err(ERR.eofInElementThatCanContainOnlyText);\n    p.openElements.pop();\n    p.insertionMode = p.originalInsertionMode;\n    p._processToken(token);\n}\n\n// The \"in table\" insertion mode\n//------------------------------------------------------------------\nfunction characterInTable(p, token) {\n    const curTn = p.openElements.currentTagName;\n\n    if (curTn === $.TABLE || curTn === $.TBODY || curTn === $.TFOOT || curTn === $.THEAD || curTn === $.TR) {\n        p.pendingCharacterTokens = [];\n        p.hasNonWhitespacePendingCharacterToken = false;\n        p.originalInsertionMode = p.insertionMode;\n        p.insertionMode = IN_TABLE_TEXT_MODE;\n        p._processToken(token);\n    } else {\n        tokenInTable(p, token);\n    }\n}\n\nfunction captionStartTagInTable(p, token) {\n    p.openElements.clearBackToTableContext();\n    p.activeFormattingElements.insertMarker();\n    p._insertElement(token, NS.HTML);\n    p.insertionMode = IN_CAPTION_MODE;\n}\n\nfunction colgroupStartTagInTable(p, token) {\n    p.openElements.clearBackToTableContext();\n    p._insertElement(token, NS.HTML);\n    p.insertionMode = IN_COLUMN_GROUP_MODE;\n}\n\nfunction colStartTagInTable(p, token) {\n    p.openElements.clearBackToTableContext();\n    p._insertFakeElement($.COLGROUP);\n    p.insertionMode = IN_COLUMN_GROUP_MODE;\n    p._processToken(token);\n}\n\nfunction tbodyStartTagInTable(p, token) {\n    p.openElements.clearBackToTableContext();\n    p._insertElement(token, NS.HTML);\n    p.insertionMode = IN_TABLE_BODY_MODE;\n}\n\nfunction tdStartTagInTable(p, token) {\n    p.openElements.clearBackToTableContext();\n    p._insertFakeElement($.TBODY);\n    p.insertionMode = IN_TABLE_BODY_MODE;\n    p._processToken(token);\n}\n\nfunction tableStartTagInTable(p, token) {\n    if (p.openElements.hasInTableScope($.TABLE)) {\n        p.openElements.popUntilTagNamePopped($.TABLE);\n        p._resetInsertionMode();\n        p._processToken(token);\n    }\n}\n\nfunction inputStartTagInTable(p, token) {\n    const inputType = Tokenizer.getTokenAttr(token, ATTRS.TYPE);\n\n    if (inputType && inputType.toLowerCase() === HIDDEN_INPUT_TYPE) {\n        p._appendElement(token, NS.HTML);\n    } else {\n        tokenInTable(p, token);\n    }\n\n    token.ackSelfClosing = true;\n}\n\nfunction formStartTagInTable(p, token) {\n    if (!p.formElement && p.openElements.tmplCount === 0) {\n        p._insertElement(token, NS.HTML);\n        p.formElement = p.openElements.current;\n        p.openElements.pop();\n    }\n}\n\nfunction startTagInTable(p, token) {\n    const tn = token.tagName;\n\n    switch (tn.length) {\n        case 2:\n            if (tn === $.TD || tn === $.TH || tn === $.TR) {\n                tdStartTagInTable(p, token);\n            } else {\n                tokenInTable(p, token);\n            }\n\n            break;\n\n        case 3:\n            if (tn === $.COL) {\n                colStartTagInTable(p, token);\n            } else {\n                tokenInTable(p, token);\n            }\n\n            break;\n\n        case 4:\n            if (tn === $.FORM) {\n                formStartTagInTable(p, token);\n            } else {\n                tokenInTable(p, token);\n            }\n\n            break;\n\n        case 5:\n            if (tn === $.TABLE) {\n                tableStartTagInTable(p, token);\n            } else if (tn === $.STYLE) {\n                startTagInHead(p, token);\n            } else if (tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD) {\n                tbodyStartTagInTable(p, token);\n            } else if (tn === $.INPUT) {\n                inputStartTagInTable(p, token);\n            } else {\n                tokenInTable(p, token);\n            }\n\n            break;\n\n        case 6:\n            if (tn === $.SCRIPT) {\n                startTagInHead(p, token);\n            } else {\n                tokenInTable(p, token);\n            }\n\n            break;\n\n        case 7:\n            if (tn === $.CAPTION) {\n                captionStartTagInTable(p, token);\n            } else {\n                tokenInTable(p, token);\n            }\n\n            break;\n\n        case 8:\n            if (tn === $.COLGROUP) {\n                colgroupStartTagInTable(p, token);\n            } else if (tn === $.TEMPLATE) {\n                startTagInHead(p, token);\n            } else {\n                tokenInTable(p, token);\n            }\n\n            break;\n\n        default:\n            tokenInTable(p, token);\n    }\n}\n\nfunction endTagInTable(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.TABLE) {\n        if (p.openElements.hasInTableScope($.TABLE)) {\n            p.openElements.popUntilTagNamePopped($.TABLE);\n            p._resetInsertionMode();\n        }\n    } else if (tn === $.TEMPLATE) {\n        endTagInHead(p, token);\n    } else if (\n        tn !== $.BODY &&\n        tn !== $.CAPTION &&\n        tn !== $.COL &&\n        tn !== $.COLGROUP &&\n        tn !== $.HTML &&\n        tn !== $.TBODY &&\n        tn !== $.TD &&\n        tn !== $.TFOOT &&\n        tn !== $.TH &&\n        tn !== $.THEAD &&\n        tn !== $.TR\n    ) {\n        tokenInTable(p, token);\n    }\n}\n\nfunction tokenInTable(p, token) {\n    const savedFosterParentingState = p.fosterParentingEnabled;\n\n    p.fosterParentingEnabled = true;\n    p._processTokenInBodyMode(token);\n    p.fosterParentingEnabled = savedFosterParentingState;\n}\n\n// The \"in table text\" insertion mode\n//------------------------------------------------------------------\nfunction whitespaceCharacterInTableText(p, token) {\n    p.pendingCharacterTokens.push(token);\n}\n\nfunction characterInTableText(p, token) {\n    p.pendingCharacterTokens.push(token);\n    p.hasNonWhitespacePendingCharacterToken = true;\n}\n\nfunction tokenInTableText(p, token) {\n    let i = 0;\n\n    if (p.hasNonWhitespacePendingCharacterToken) {\n        for (; i < p.pendingCharacterTokens.length; i++) {\n            tokenInTable(p, p.pendingCharacterTokens[i]);\n        }\n    } else {\n        for (; i < p.pendingCharacterTokens.length; i++) {\n            p._insertCharacters(p.pendingCharacterTokens[i]);\n        }\n    }\n\n    p.insertionMode = p.originalInsertionMode;\n    p._processToken(token);\n}\n\n// The \"in caption\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInCaption(p, token) {\n    const tn = token.tagName;\n\n    if (\n        tn === $.CAPTION ||\n        tn === $.COL ||\n        tn === $.COLGROUP ||\n        tn === $.TBODY ||\n        tn === $.TD ||\n        tn === $.TFOOT ||\n        tn === $.TH ||\n        tn === $.THEAD ||\n        tn === $.TR\n    ) {\n        if (p.openElements.hasInTableScope($.CAPTION)) {\n            p.openElements.generateImpliedEndTags();\n            p.openElements.popUntilTagNamePopped($.CAPTION);\n            p.activeFormattingElements.clearToLastMarker();\n            p.insertionMode = IN_TABLE_MODE;\n            p._processToken(token);\n        }\n    } else {\n        startTagInBody(p, token);\n    }\n}\n\nfunction endTagInCaption(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.CAPTION || tn === $.TABLE) {\n        if (p.openElements.hasInTableScope($.CAPTION)) {\n            p.openElements.generateImpliedEndTags();\n            p.openElements.popUntilTagNamePopped($.CAPTION);\n            p.activeFormattingElements.clearToLastMarker();\n            p.insertionMode = IN_TABLE_MODE;\n\n            if (tn === $.TABLE) {\n                p._processToken(token);\n            }\n        }\n    } else if (\n        tn !== $.BODY &&\n        tn !== $.COL &&\n        tn !== $.COLGROUP &&\n        tn !== $.HTML &&\n        tn !== $.TBODY &&\n        tn !== $.TD &&\n        tn !== $.TFOOT &&\n        tn !== $.TH &&\n        tn !== $.THEAD &&\n        tn !== $.TR\n    ) {\n        endTagInBody(p, token);\n    }\n}\n\n// The \"in column group\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInColumnGroup(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HTML) {\n        startTagInBody(p, token);\n    } else if (tn === $.COL) {\n        p._appendElement(token, NS.HTML);\n        token.ackSelfClosing = true;\n    } else if (tn === $.TEMPLATE) {\n        startTagInHead(p, token);\n    } else {\n        tokenInColumnGroup(p, token);\n    }\n}\n\nfunction endTagInColumnGroup(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.COLGROUP) {\n        if (p.openElements.currentTagName === $.COLGROUP) {\n            p.openElements.pop();\n            p.insertionMode = IN_TABLE_MODE;\n        }\n    } else if (tn === $.TEMPLATE) {\n        endTagInHead(p, token);\n    } else if (tn !== $.COL) {\n        tokenInColumnGroup(p, token);\n    }\n}\n\nfunction tokenInColumnGroup(p, token) {\n    if (p.openElements.currentTagName === $.COLGROUP) {\n        p.openElements.pop();\n        p.insertionMode = IN_TABLE_MODE;\n        p._processToken(token);\n    }\n}\n\n// The \"in table body\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInTableBody(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.TR) {\n        p.openElements.clearBackToTableBodyContext();\n        p._insertElement(token, NS.HTML);\n        p.insertionMode = IN_ROW_MODE;\n    } else if (tn === $.TH || tn === $.TD) {\n        p.openElements.clearBackToTableBodyContext();\n        p._insertFakeElement($.TR);\n        p.insertionMode = IN_ROW_MODE;\n        p._processToken(token);\n    } else if (\n        tn === $.CAPTION ||\n        tn === $.COL ||\n        tn === $.COLGROUP ||\n        tn === $.TBODY ||\n        tn === $.TFOOT ||\n        tn === $.THEAD\n    ) {\n        if (p.openElements.hasTableBodyContextInTableScope()) {\n            p.openElements.clearBackToTableBodyContext();\n            p.openElements.pop();\n            p.insertionMode = IN_TABLE_MODE;\n            p._processToken(token);\n        }\n    } else {\n        startTagInTable(p, token);\n    }\n}\n\nfunction endTagInTableBody(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD) {\n        if (p.openElements.hasInTableScope(tn)) {\n            p.openElements.clearBackToTableBodyContext();\n            p.openElements.pop();\n            p.insertionMode = IN_TABLE_MODE;\n        }\n    } else if (tn === $.TABLE) {\n        if (p.openElements.hasTableBodyContextInTableScope()) {\n            p.openElements.clearBackToTableBodyContext();\n            p.openElements.pop();\n            p.insertionMode = IN_TABLE_MODE;\n            p._processToken(token);\n        }\n    } else if (\n        (tn !== $.BODY && tn !== $.CAPTION && tn !== $.COL && tn !== $.COLGROUP) ||\n        (tn !== $.HTML && tn !== $.TD && tn !== $.TH && tn !== $.TR)\n    ) {\n        endTagInTable(p, token);\n    }\n}\n\n// The \"in row\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInRow(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.TH || tn === $.TD) {\n        p.openElements.clearBackToTableRowContext();\n        p._insertElement(token, NS.HTML);\n        p.insertionMode = IN_CELL_MODE;\n        p.activeFormattingElements.insertMarker();\n    } else if (\n        tn === $.CAPTION ||\n        tn === $.COL ||\n        tn === $.COLGROUP ||\n        tn === $.TBODY ||\n        tn === $.TFOOT ||\n        tn === $.THEAD ||\n        tn === $.TR\n    ) {\n        if (p.openElements.hasInTableScope($.TR)) {\n            p.openElements.clearBackToTableRowContext();\n            p.openElements.pop();\n            p.insertionMode = IN_TABLE_BODY_MODE;\n            p._processToken(token);\n        }\n    } else {\n        startTagInTable(p, token);\n    }\n}\n\nfunction endTagInRow(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.TR) {\n        if (p.openElements.hasInTableScope($.TR)) {\n            p.openElements.clearBackToTableRowContext();\n            p.openElements.pop();\n            p.insertionMode = IN_TABLE_BODY_MODE;\n        }\n    } else if (tn === $.TABLE) {\n        if (p.openElements.hasInTableScope($.TR)) {\n            p.openElements.clearBackToTableRowContext();\n            p.openElements.pop();\n            p.insertionMode = IN_TABLE_BODY_MODE;\n            p._processToken(token);\n        }\n    } else if (tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD) {\n        if (p.openElements.hasInTableScope(tn) || p.openElements.hasInTableScope($.TR)) {\n            p.openElements.clearBackToTableRowContext();\n            p.openElements.pop();\n            p.insertionMode = IN_TABLE_BODY_MODE;\n            p._processToken(token);\n        }\n    } else if (\n        (tn !== $.BODY && tn !== $.CAPTION && tn !== $.COL && tn !== $.COLGROUP) ||\n        (tn !== $.HTML && tn !== $.TD && tn !== $.TH)\n    ) {\n        endTagInTable(p, token);\n    }\n}\n\n// The \"in cell\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInCell(p, token) {\n    const tn = token.tagName;\n\n    if (\n        tn === $.CAPTION ||\n        tn === $.COL ||\n        tn === $.COLGROUP ||\n        tn === $.TBODY ||\n        tn === $.TD ||\n        tn === $.TFOOT ||\n        tn === $.TH ||\n        tn === $.THEAD ||\n        tn === $.TR\n    ) {\n        if (p.openElements.hasInTableScope($.TD) || p.openElements.hasInTableScope($.TH)) {\n            p._closeTableCell();\n            p._processToken(token);\n        }\n    } else {\n        startTagInBody(p, token);\n    }\n}\n\nfunction endTagInCell(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.TD || tn === $.TH) {\n        if (p.openElements.hasInTableScope(tn)) {\n            p.openElements.generateImpliedEndTags();\n            p.openElements.popUntilTagNamePopped(tn);\n            p.activeFormattingElements.clearToLastMarker();\n            p.insertionMode = IN_ROW_MODE;\n        }\n    } else if (tn === $.TABLE || tn === $.TBODY || tn === $.TFOOT || tn === $.THEAD || tn === $.TR) {\n        if (p.openElements.hasInTableScope(tn)) {\n            p._closeTableCell();\n            p._processToken(token);\n        }\n    } else if (tn !== $.BODY && tn !== $.CAPTION && tn !== $.COL && tn !== $.COLGROUP && tn !== $.HTML) {\n        endTagInBody(p, token);\n    }\n}\n\n// The \"in select\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInSelect(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HTML) {\n        startTagInBody(p, token);\n    } else if (tn === $.OPTION) {\n        if (p.openElements.currentTagName === $.OPTION) {\n            p.openElements.pop();\n        }\n\n        p._insertElement(token, NS.HTML);\n    } else if (tn === $.OPTGROUP) {\n        if (p.openElements.currentTagName === $.OPTION) {\n            p.openElements.pop();\n        }\n\n        if (p.openElements.currentTagName === $.OPTGROUP) {\n            p.openElements.pop();\n        }\n\n        p._insertElement(token, NS.HTML);\n    } else if (tn === $.INPUT || tn === $.KEYGEN || tn === $.TEXTAREA || tn === $.SELECT) {\n        if (p.openElements.hasInSelectScope($.SELECT)) {\n            p.openElements.popUntilTagNamePopped($.SELECT);\n            p._resetInsertionMode();\n\n            if (tn !== $.SELECT) {\n                p._processToken(token);\n            }\n        }\n    } else if (tn === $.SCRIPT || tn === $.TEMPLATE) {\n        startTagInHead(p, token);\n    }\n}\n\nfunction endTagInSelect(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.OPTGROUP) {\n        const prevOpenElement = p.openElements.items[p.openElements.stackTop - 1];\n        const prevOpenElementTn = prevOpenElement && p.treeAdapter.getTagName(prevOpenElement);\n\n        if (p.openElements.currentTagName === $.OPTION && prevOpenElementTn === $.OPTGROUP) {\n            p.openElements.pop();\n        }\n\n        if (p.openElements.currentTagName === $.OPTGROUP) {\n            p.openElements.pop();\n        }\n    } else if (tn === $.OPTION) {\n        if (p.openElements.currentTagName === $.OPTION) {\n            p.openElements.pop();\n        }\n    } else if (tn === $.SELECT && p.openElements.hasInSelectScope($.SELECT)) {\n        p.openElements.popUntilTagNamePopped($.SELECT);\n        p._resetInsertionMode();\n    } else if (tn === $.TEMPLATE) {\n        endTagInHead(p, token);\n    }\n}\n\n//12.2.5.4.17 The \"in select in table\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInSelectInTable(p, token) {\n    const tn = token.tagName;\n\n    if (\n        tn === $.CAPTION ||\n        tn === $.TABLE ||\n        tn === $.TBODY ||\n        tn === $.TFOOT ||\n        tn === $.THEAD ||\n        tn === $.TR ||\n        tn === $.TD ||\n        tn === $.TH\n    ) {\n        p.openElements.popUntilTagNamePopped($.SELECT);\n        p._resetInsertionMode();\n        p._processToken(token);\n    } else {\n        startTagInSelect(p, token);\n    }\n}\n\nfunction endTagInSelectInTable(p, token) {\n    const tn = token.tagName;\n\n    if (\n        tn === $.CAPTION ||\n        tn === $.TABLE ||\n        tn === $.TBODY ||\n        tn === $.TFOOT ||\n        tn === $.THEAD ||\n        tn === $.TR ||\n        tn === $.TD ||\n        tn === $.TH\n    ) {\n        if (p.openElements.hasInTableScope(tn)) {\n            p.openElements.popUntilTagNamePopped($.SELECT);\n            p._resetInsertionMode();\n            p._processToken(token);\n        }\n    } else {\n        endTagInSelect(p, token);\n    }\n}\n\n// The \"in template\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInTemplate(p, token) {\n    const tn = token.tagName;\n\n    if (\n        tn === $.BASE ||\n        tn === $.BASEFONT ||\n        tn === $.BGSOUND ||\n        tn === $.LINK ||\n        tn === $.META ||\n        tn === $.NOFRAMES ||\n        tn === $.SCRIPT ||\n        tn === $.STYLE ||\n        tn === $.TEMPLATE ||\n        tn === $.TITLE\n    ) {\n        startTagInHead(p, token);\n    } else {\n        const newInsertionMode = TEMPLATE_INSERTION_MODE_SWITCH_MAP[tn] || IN_BODY_MODE;\n\n        p._popTmplInsertionMode();\n        p._pushTmplInsertionMode(newInsertionMode);\n        p.insertionMode = newInsertionMode;\n        p._processToken(token);\n    }\n}\n\nfunction endTagInTemplate(p, token) {\n    if (token.tagName === $.TEMPLATE) {\n        endTagInHead(p, token);\n    }\n}\n\nfunction eofInTemplate(p, token) {\n    if (p.openElements.tmplCount > 0) {\n        p.openElements.popUntilTagNamePopped($.TEMPLATE);\n        p.activeFormattingElements.clearToLastMarker();\n        p._popTmplInsertionMode();\n        p._resetInsertionMode();\n        p._processToken(token);\n    } else {\n        p.stopped = true;\n    }\n}\n\n// The \"after body\" insertion mode\n//------------------------------------------------------------------\nfunction startTagAfterBody(p, token) {\n    if (token.tagName === $.HTML) {\n        startTagInBody(p, token);\n    } else {\n        tokenAfterBody(p, token);\n    }\n}\n\nfunction endTagAfterBody(p, token) {\n    if (token.tagName === $.HTML) {\n        if (!p.fragmentContext) {\n            p.insertionMode = AFTER_AFTER_BODY_MODE;\n        }\n    } else {\n        tokenAfterBody(p, token);\n    }\n}\n\nfunction tokenAfterBody(p, token) {\n    p.insertionMode = IN_BODY_MODE;\n    p._processToken(token);\n}\n\n// The \"in frameset\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInFrameset(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HTML) {\n        startTagInBody(p, token);\n    } else if (tn === $.FRAMESET) {\n        p._insertElement(token, NS.HTML);\n    } else if (tn === $.FRAME) {\n        p._appendElement(token, NS.HTML);\n        token.ackSelfClosing = true;\n    } else if (tn === $.NOFRAMES) {\n        startTagInHead(p, token);\n    }\n}\n\nfunction endTagInFrameset(p, token) {\n    if (token.tagName === $.FRAMESET && !p.openElements.isRootHtmlElementCurrent()) {\n        p.openElements.pop();\n\n        if (!p.fragmentContext && p.openElements.currentTagName !== $.FRAMESET) {\n            p.insertionMode = AFTER_FRAMESET_MODE;\n        }\n    }\n}\n\n// The \"after frameset\" insertion mode\n//------------------------------------------------------------------\nfunction startTagAfterFrameset(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HTML) {\n        startTagInBody(p, token);\n    } else if (tn === $.NOFRAMES) {\n        startTagInHead(p, token);\n    }\n}\n\nfunction endTagAfterFrameset(p, token) {\n    if (token.tagName === $.HTML) {\n        p.insertionMode = AFTER_AFTER_FRAMESET_MODE;\n    }\n}\n\n// The \"after after body\" insertion mode\n//------------------------------------------------------------------\nfunction startTagAfterAfterBody(p, token) {\n    if (token.tagName === $.HTML) {\n        startTagInBody(p, token);\n    } else {\n        tokenAfterAfterBody(p, token);\n    }\n}\n\nfunction tokenAfterAfterBody(p, token) {\n    p.insertionMode = IN_BODY_MODE;\n    p._processToken(token);\n}\n\n// The \"after after frameset\" insertion mode\n//------------------------------------------------------------------\nfunction startTagAfterAfterFrameset(p, token) {\n    const tn = token.tagName;\n\n    if (tn === $.HTML) {\n        startTagInBody(p, token);\n    } else if (tn === $.NOFRAMES) {\n        startTagInHead(p, token);\n    }\n}\n\n// The rules for parsing tokens in foreign content\n//------------------------------------------------------------------\nfunction nullCharacterInForeignContent(p, token) {\n    token.chars = unicode.REPLACEMENT_CHARACTER;\n    p._insertCharacters(token);\n}\n\nfunction characterInForeignContent(p, token) {\n    p._insertCharacters(token);\n    p.framesetOk = false;\n}\n\nfunction startTagInForeignContent(p, token) {\n    if (foreignContent.causesExit(token) && !p.fragmentContext) {\n        while (\n            p.treeAdapter.getNamespaceURI(p.openElements.current) !== NS.HTML &&\n            !p._isIntegrationPoint(p.openElements.current)\n        ) {\n            p.openElements.pop();\n        }\n\n        p._processToken(token);\n    } else {\n        const current = p._getAdjustedCurrentElement();\n        const currentNs = p.treeAdapter.getNamespaceURI(current);\n\n        if (currentNs === NS.MATHML) {\n            foreignContent.adjustTokenMathMLAttrs(token);\n        } else if (currentNs === NS.SVG) {\n            foreignContent.adjustTokenSVGTagName(token);\n            foreignContent.adjustTokenSVGAttrs(token);\n        }\n\n        foreignContent.adjustTokenXMLAttrs(token);\n\n        if (token.selfClosing) {\n            p._appendElement(token, currentNs);\n        } else {\n            p._insertElement(token, currentNs);\n        }\n\n        token.ackSelfClosing = true;\n    }\n}\n\nfunction endTagInForeignContent(p, token) {\n    for (let i = p.openElements.stackTop; i > 0; i--) {\n        const element = p.openElements.items[i];\n\n        if (p.treeAdapter.getNamespaceURI(element) === NS.HTML) {\n            p._processToken(token);\n            break;\n        }\n\n        if (p.treeAdapter.getTagName(element).toLowerCase() === token.tagName) {\n            p.openElements.popUntilElementPopped(element);\n            break;\n        }\n    }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}